[0m01:13:24.893603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022369FE0EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236AA88CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236B107ED0>]}


============================== 01:13:24.903683 | 4c28dfc2-a2c9-4513-972f-30e9548e4115 ==============================
[0m01:13:24.903683 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:13:24.905851 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m01:13:24.965208 [info ] [MainThread]: dbt version: 1.11.2
[0m01:13:24.966143 [info ] [MainThread]: python version: 3.13.4
[0m01:13:24.967089 [info ] [MainThread]: python path: C:\kev\jaffle_shop\jaffle_dbt\venv\Scripts\python.exe
[0m01:13:24.968057 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m01:13:25.183978 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m01:13:25.185172 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m01:13:25.186017 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\jaffle_shop\jaffle_dbt\dbt_project.yml
[0m01:13:25.187143 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m01:13:25.189021 [debug] [MainThread]: Command `dbt debug` failed at 01:13:25.188813 after 0.52 seconds
[0m01:13:25.189687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236C3650F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236C322B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002236C193570>]}
[0m01:13:25.190814 [debug] [MainThread]: Flushing usage events
[0m01:13:26.690031 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:57.442530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD582CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD62D8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD6957ED0>]}


============================== 01:18:57.451047 | 0b19ec7c-e3b8-4f12-9092-3fb10c6925a8 ==============================
[0m01:18:57.451047 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:18:57.452394 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m01:18:57.508631 [info ] [MainThread]: dbt version: 1.11.2
[0m01:18:57.509579 [info ] [MainThread]: python version: 3.13.4
[0m01:18:57.510549 [info ] [MainThread]: python path: C:\kev\jaffle_shop\jaffle_dbt\venv\Scripts\python.exe
[0m01:18:57.511505 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m01:18:57.797801 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m01:18:57.798898 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m01:18:57.799920 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\jaffle_shop\jaffle_dbt\dbt_project.yml
[0m01:18:57.801097 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m01:18:57.803434 [debug] [MainThread]: Command `dbt debug` failed at 01:18:57.803157 after 0.61 seconds
[0m01:18:57.804134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD7B9CC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD7B72B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD79E3CE0>]}
[0m01:18:57.808070 [debug] [MainThread]: Flushing usage events
[0m01:18:59.490177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:19:29.677861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F27206D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F27239D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F2720610>]}


============================== 03:19:29.679000 | dc57eddc-c1c6-4732-a033-e284d9fec927 ==============================
[0m03:19:29.679000 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:19:29.679000 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'logs'}
[0m03:19:29.722653 [info ] [MainThread]: dbt version: 1.11.2
[0m03:19:29.722653 [info ] [MainThread]: python version: 3.11.3
[0m03:19:29.722653 [info ] [MainThread]: python path: C:\kev\jaffle_shop\jaffle_dbt\venv\Scripts\python.exe
[0m03:19:29.722653 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m03:19:30.101453 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m03:19:30.101453 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m03:19:30.101453 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\jaffle_shop\jaffle_dbt\dbt_project.yml
[0m03:19:30.101453 [error] [MainThread]: Encountered an error:
Internal Error
  Profile should not be None if loading profile completed
[0m03:19:30.101453 [debug] [MainThread]: Command `dbt debug` failed at 03:19:30.101453 after 0.55 seconds
[0m03:19:30.101453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F27EB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234F27EE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234EAA7A390>]}
[0m03:19:30.101453 [debug] [MainThread]: Flushing usage events
[0m03:19:31.059978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:22:21.923379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A4DCCD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A4DC8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A4DCA150>]}


============================== 03:22:21.929912 | b5f275ab-6791-4cdd-8b8d-801487d27062 ==============================
[0m03:22:21.929912 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:22:21.931873 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m03:22:21.959001 [info ] [MainThread]: dbt version: 1.11.2
[0m03:22:21.974623 [info ] [MainThread]: python version: 3.11.3
[0m03:22:21.976357 [info ] [MainThread]: python path: C:\kev\jaffle_shop\jaffle_dbt\venv\Scripts\python.exe
[0m03:22:21.977281 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m03:22:22.166535 [info ] [MainThread]: Using profiles dir at C:\Users\Evans Moseti\.dbt
[0m03:22:22.168494 [info ] [MainThread]: Using profiles.yml file at C:\Users\Evans Moseti\.dbt\profiles.yml
[0m03:22:22.169175 [info ] [MainThread]: Using dbt_project.yml file at C:\kev\jaffle_shop\jaffle_dbt\dbt_project.yml
[0m03:22:22.174078 [info ] [MainThread]: adapter type: duckdb
[0m03:22:22.176069 [info ] [MainThread]: adapter version: 1.10.0
[0m03:22:22.350227 [info ] [MainThread]: Configuration:
[0m03:22:22.351262 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:22:22.352633 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:22:22.354632 [info ] [MainThread]: Required dependencies:
[0m03:22:22.355637 [debug] [MainThread]: Executing "git --help"
[0m03:22:22.431503 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:22:22.432500 [debug] [MainThread]: STDERR: "b''"
[0m03:22:22.433498 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:22:22.433920 [info ] [MainThread]: Connection:
[0m03:22:22.435553 [info ] [MainThread]:   database: jaffle_dbt
[0m03:22:22.436787 [info ] [MainThread]:   schema: main
[0m03:22:22.437788 [info ] [MainThread]:   path: jaffle_dbt.duckdb
[0m03:22:22.439783 [info ] [MainThread]:   config_options: None
[0m03:22:22.441810 [info ] [MainThread]:   extensions: None
[0m03:22:22.443773 [info ] [MainThread]:   settings: {}
[0m03:22:22.446592 [info ] [MainThread]:   external_root: .
[0m03:22:22.448550 [info ] [MainThread]:   use_credential_provider: None
[0m03:22:22.449582 [info ] [MainThread]:   attach: None
[0m03:22:22.450804 [info ] [MainThread]:   filesystems: None
[0m03:22:22.451805 [info ] [MainThread]:   remote: None
[0m03:22:22.453799 [info ] [MainThread]:   plugins: None
[0m03:22:22.455065 [info ] [MainThread]:   disable_transactions: False
[0m03:22:22.456312 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:22:22.837159 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m03:22:27.584122 [debug] [MainThread]: Using duckdb connection "debug"
[0m03:22:27.584122 [debug] [MainThread]: On debug: select 1 as id
[0m03:22:27.597526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:22:27.631615 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m03:22:27.631615 [debug] [MainThread]: On debug: Close
[0m03:22:27.631615 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:22:27.631615 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:22:27.631615 [debug] [MainThread]: Command `dbt debug` succeeded at 03:22:27.631615 after 5.89 seconds
[0m03:22:27.631615 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m03:22:27.645297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6177150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6177110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489E18CB90>]}
[0m03:22:27.649127 [debug] [MainThread]: Flushing usage events
[0m03:22:28.565077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:23:39.897769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9F1F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9E3D8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9F0F7D0>]}


============================== 03:23:39.913393 | 4e854fb9-2087-45cb-bd35-94dc8098acc9 ==============================
[0m03:23:39.913393 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:23:39.913393 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'invocation_command': 'dbt seed', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m03:23:40.394487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB0E3E50>]}
[0m03:23:40.493259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D677D510>]}
[0m03:23:40.497175 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:23:40.909861 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:23:40.911856 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:23:40.912921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9FE5390>]}
[0m03:23:44.960820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_dbt.marts
[0m03:23:44.960820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB790590>]}
[0m03:23:45.081295 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:23:45.096916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:23:45.175022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB76FE10>]}
[0m03:23:45.175022 [info ] [MainThread]: Found 3 models, 3 seeds, 472 macros
[0m03:23:45.175022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB750D10>]}
[0m03:23:45.175022 [info ] [MainThread]: 
[0m03:23:45.175022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:23:45.175022 [info ] [MainThread]: 
[0m03:23:45.189492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:23:45.205338 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m03:23:45.327790 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m03:23:45.328787 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m03:23:45.329784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:45.365247 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m03:23:45.367281 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m03:23:45.368549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m03:23:45.369550 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m03:23:45.380520 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:23:45.381640 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m03:23:45.381640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:23:45.383675 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:23:45.386628 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:23:45.387625 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m03:23:45.388622 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:23:45.389620 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:23:45.389620 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m03:23:45.391626 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:45.393609 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:23:45.393609 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:23:45.394606 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:23:45.395604 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:23:45.396601 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m03:23:45.397637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m03:23:45.397637 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:23:45.397637 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m03:23:45.397637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:23:45.413260 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:23:45.413260 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:23:45.413260 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m03:23:45.441084 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m03:23:45.443081 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m03:23:45.445075 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m03:23:45.446108 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m03:23:45.447082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB7D7350>]}
[0m03:23:45.448102 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:45.449099 [debug] [MainThread]: On master: BEGIN
[0m03:23:45.450062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:23:45.451095 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:45.452095 [debug] [MainThread]: On master: COMMIT
[0m03:23:45.453088 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:45.454050 [debug] [MainThread]: On master: COMMIT
[0m03:23:45.455063 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:23:45.456076 [debug] [MainThread]: On master: Close
[0m03:23:45.490663 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m03:23:45.490663 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m03:23:45.490663 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m03:23:45.490663 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m03:23:45.506247 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m03:23:45.506247 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m03:23:45.506247 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m03:23:45.506247 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m03:23:45.506247 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m03:23:45.506247 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m03:23:45.506247 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m03:23:45.506247 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m03:23:45.506247 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m03:23:45.506247 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m03:23:45.529029 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m03:23:45.580319 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:23:45.593243 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:23:45.593243 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: BEGIN
[0m03:23:45.593243 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:23:45.593243 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: BEGIN
[0m03:23:45.602968 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:23:45.604954 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: BEGIN
[0m03:23:45.606950 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:23:45.608944 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m03:23:45.609940 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:23:45.612933 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m03:23:45.613930 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:23:45.615928 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:23:45.616922 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m03:23:45.617918 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_customers"} */

    create table "jaffle_dbt"."main"."raw_customers" ("id,first_name,last_name" text)
  
[0m03:23:45.619915 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_orders"} */

    create table "jaffle_dbt"."main"."raw_orders" ("id,user_id,order_date,status" text)
  
[0m03:23:45.620913 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:23:45.623904 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:23:45.624505 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m03:23:45.624505 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_payments"} */

    create table "jaffle_dbt"."main"."raw_payments" ("id,order_id,payment_method,amount" text)
  
[0m03:23:45.650630 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:23:45.653623 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:23:45.655619 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:23:45.656213 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m03:23:45.657248 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:23:45.659927 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:23:45.661919 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:23:45.678164 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:23:45.678164 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:23:45.678164 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:23:45.678164 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:45.678164 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:45.678164 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:23:45.678164 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: ROLLBACK
[0m03:23:45.686512 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: ROLLBACK
[0m03:23:45.686512 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: ROLLBACK
[0m03:23:45.706005 [debug] [Thread-3 (]: Failed to rollback 'seed.jaffle_dbt.raw_payments'
[0m03:23:45.706005 [debug] [Thread-1 (]: Failed to rollback 'seed.jaffle_dbt.raw_customers'
[0m03:23:45.706005 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: Close
[0m03:23:45.706005 [debug] [Thread-2 (]: Failed to rollback 'seed.jaffle_dbt.raw_orders'
[0m03:23:45.706005 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: Close
[0m03:23:45.722103 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: Close
[0m03:23:45.727800 [debug] [Thread-3 (]: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.737496 [debug] [Thread-1 (]: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.741447 [debug] [Thread-2 (]: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.742444 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DBB48D90>]}
[0m03:23:45.743443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DB840A50>]}
[0m03:23:45.744709 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4e854fb9-2087-45cb-bd35-94dc8098acc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9DBBAB010>]}
[0m03:23:45.746605 [error] [Thread-3 (]: 3 of 3 ERROR loading seed file main.raw_payments ............................... [[31mERROR[0m in 0.22s]
[0m03:23:45.747603 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file main.raw_customers .............................. [[31mERROR[0m in 0.23s]
[0m03:23:45.749597 [error] [Thread-2 (]: 2 of 3 ERROR loading seed file main.raw_orders ................................. [[31mERROR[0m in 0.24s]
[0m03:23:45.751592 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m03:23:45.753585 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m03:23:45.754294 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m03:23:45.756475 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_payments' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:23:45.759279 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_customers' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:23:45.761247 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:23:45.765233 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:45.766228 [debug] [MainThread]: On master: BEGIN
[0m03:23:45.767258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:23:45.768258 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:45.771215 [debug] [MainThread]: On master: COMMIT
[0m03:23:45.772245 [debug] [MainThread]: Using duckdb connection "master"
[0m03:23:45.773244 [debug] [MainThread]: On master: COMMIT
[0m03:23:45.774208 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:23:45.775237 [debug] [MainThread]: On master: Close
[0m03:23:45.776204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:23:45.777203 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m03:23:45.778231 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m03:23:45.779194 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_customers' was properly closed.
[0m03:23:45.780197 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_orders' was properly closed.
[0m03:23:45.780197 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_payments' was properly closed.
[0m03:23:45.781223 [info ] [MainThread]: 
[0m03:23:45.783185 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m03:23:45.786127 [debug] [MainThread]: Command end result
[0m03:23:45.822396 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:23:45.822396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:23:45.839352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m03:23:45.839352 [info ] [MainThread]: 
[0m03:23:45.839352 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m03:23:45.839352 [info ] [MainThread]: 
[0m03:23:45.853874 [error] [MainThread]: [31mFailure in seed raw_payments (seeds\raw_payments.csv)[0m
[0m03:23:45.855861 [error] [MainThread]:   Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.861844 [info ] [MainThread]: 
[0m03:23:45.865836 [error] [MainThread]: [31mFailure in seed raw_customers (seeds\raw_customers.csv)[0m
[0m03:23:45.867829 [error] [MainThread]:   Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.875809 [info ] [MainThread]: 
[0m03:23:45.877802 [error] [MainThread]: [31mFailure in seed raw_orders (seeds\raw_orders.csv)[0m
[0m03:23:45.879799 [error] [MainThread]:   Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:23:45.881918 [info ] [MainThread]: 
[0m03:23:45.881918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m03:23:45.889597 [debug] [MainThread]: Command `dbt seed` failed at 03:23:45.889597 after 6.10 seconds
[0m03:23:45.890597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D9F1B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D8FC3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9D330A390>]}
[0m03:23:45.892587 [debug] [MainThread]: Flushing usage events
[0m03:23:46.823541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:25:42.522228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FE11CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FE11E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FE11FD0>]}


============================== 03:25:42.529790 | 7b94fd2a-7165-4174-913c-9cae1f347630 ==============================
[0m03:25:42.529790 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:25:42.531752 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m03:25:42.959480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FD9F210>]}
[0m03:25:43.054218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138C60D950>]}
[0m03:25:43.054218 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:25:43.881890 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:25:44.051687 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m03:25:44.051687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138EDCF610>]}
[0m03:25:47.580537 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_dbt.marts
[0m03:25:47.605389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021391559ED0>]}
[0m03:25:47.740558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:25:47.741596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:25:47.799189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213915DB3D0>]}
[0m03:25:47.799189 [info ] [MainThread]: Found 3 models, 3 seeds, 472 macros
[0m03:25:47.799189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213914DD410>]}
[0m03:25:47.799189 [info ] [MainThread]: 
[0m03:25:47.799189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:25:47.810395 [info ] [MainThread]: 
[0m03:25:47.812390 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:25:47.823451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m03:25:47.961454 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m03:25:47.964597 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m03:25:47.966126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:47.983050 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m03:25:47.999109 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m03:25:47.999823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m03:25:47.999823 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m03:25:47.999823 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:25:48.015757 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m03:25:48.016752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:25:48.018748 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:25:48.020742 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:25:48.020742 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m03:25:48.022801 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:25:48.022801 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:25:48.022801 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m03:25:48.022801 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:25:48.022801 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:25:48.022801 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:25:48.022801 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:25:48.022801 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:25:48.031509 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m03:25:48.033576 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m03:25:48.033576 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:25:48.033576 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m03:25:48.033576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:25:48.049877 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:25:48.049917 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:25:48.049917 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m03:25:48.065899 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m03:25:48.065899 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m03:25:48.065899 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m03:25:48.082889 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m03:25:48.083150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213915AD990>]}
[0m03:25:48.083150 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:48.083150 [debug] [MainThread]: On master: BEGIN
[0m03:25:48.083150 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:25:48.083150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:25:48.083150 [debug] [MainThread]: On master: COMMIT
[0m03:25:48.083150 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:48.083150 [debug] [MainThread]: On master: COMMIT
[0m03:25:48.083150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:25:48.083150 [debug] [MainThread]: On master: Close
[0m03:25:48.100066 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m03:25:48.100066 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m03:25:48.100066 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m03:25:48.106609 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m03:25:48.108602 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m03:25:48.111597 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m03:25:48.113590 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m03:25:48.114595 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m03:25:48.117583 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m03:25:48.118999 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m03:25:48.119997 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m03:25:48.121993 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m03:25:48.123025 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m03:25:48.124985 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m03:25:48.126991 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m03:25:48.194016 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:25:48.203991 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:25:48.204986 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: BEGIN
[0m03:25:48.207981 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:25:48.208978 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: BEGIN
[0m03:25:48.209976 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:25:48.211156 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: BEGIN
[0m03:25:48.212157 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:25:48.215149 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:25:48.216146 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m03:25:48.218141 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m03:25:48.219137 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:25:48.220167 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m03:25:48.221166 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:25:48.222052 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_customers"} */

    create table "jaffle_dbt"."main"."raw_customers" ("id,first_name,last_name" text)
  
[0m03:25:48.223053 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:25:48.224081 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_orders"} */

    create table "jaffle_dbt"."main"."raw_orders" ("id,user_id,order_date,status" text)
  
[0m03:25:48.226046 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_payments"} */

    create table "jaffle_dbt"."main"."raw_payments" ("id,order_id,payment_method,amount" text)
  
[0m03:25:48.227043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m03:25:48.229038 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m03:25:48.245841 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m03:25:48.246563 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:25:48.249559 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:25:48.252551 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:25:48.253404 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:25:48.254221 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:25:48.255222 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:25:48.269333 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:25:48.270364 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:25:48.271329 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:25:48.272325 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:25:48.273654 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:25:48.274656 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:25:48.275681 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: ROLLBACK
[0m03:25:48.277647 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: ROLLBACK
[0m03:25:48.278099 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: ROLLBACK
[0m03:25:48.300263 [debug] [Thread-3 (]: Failed to rollback 'seed.jaffle_dbt.raw_payments'
[0m03:25:48.287408 [debug] [Thread-1 (]: Failed to rollback 'seed.jaffle_dbt.raw_customers'
[0m03:25:48.300263 [debug] [Thread-2 (]: Failed to rollback 'seed.jaffle_dbt.raw_orders'
[0m03:25:48.300263 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: Close
[0m03:25:48.300263 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: Close
[0m03:25:48.300263 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: Close
[0m03:25:48.316928 [debug] [Thread-3 (]: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.316928 [debug] [Thread-1 (]: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.316928 [debug] [Thread-2 (]: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.316928 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021391B00590>]}
[0m03:25:48.316928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213915DB4D0>]}
[0m03:25:48.316928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b94fd2a-7165-4174-913c-9cae1f347630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002139146A210>]}
[0m03:25:48.316928 [error] [Thread-3 (]: 3 of 3 ERROR loading seed file main.raw_payments ............................... [[31mERROR[0m in 0.20s]
[0m03:25:48.333582 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file main.raw_customers .............................. [[31mERROR[0m in 0.20s]
[0m03:25:48.336675 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m03:25:48.335675 [error] [Thread-2 (]: 2 of 3 ERROR loading seed file main.raw_orders ................................. [[31mERROR[0m in 0.20s]
[0m03:25:48.338670 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m03:25:48.340664 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_payments' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:25:48.341662 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m03:25:48.343759 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_customers' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:25:48.346394 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:25:48.349386 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:48.350383 [debug] [MainThread]: On master: BEGIN
[0m03:25:48.351872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:25:48.353870 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m03:25:48.354897 [debug] [MainThread]: On master: COMMIT
[0m03:25:48.355897 [debug] [MainThread]: Using duckdb connection "master"
[0m03:25:48.356861 [debug] [MainThread]: On master: COMMIT
[0m03:25:48.357856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:25:48.358885 [debug] [MainThread]: On master: Close
[0m03:25:48.359884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:25:48.360859 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m03:25:48.360859 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m03:25:48.361846 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_customers' was properly closed.
[0m03:25:48.362876 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_orders' was properly closed.
[0m03:25:48.363876 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_payments' was properly closed.
[0m03:25:48.364839 [info ] [MainThread]: 
[0m03:25:48.367833 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m03:25:48.371855 [debug] [MainThread]: Command end result
[0m03:25:48.424097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:25:48.428121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:25:48.438172 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m03:25:48.440166 [info ] [MainThread]: 
[0m03:25:48.442161 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m03:25:48.442691 [info ] [MainThread]: 
[0m03:25:48.444689 [error] [MainThread]: [31mFailure in seed raw_payments (seeds\raw_payments.csv)[0m
[0m03:25:48.446660 [error] [MainThread]:   Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.456633 [info ] [MainThread]: 
[0m03:25:48.458100 [error] [MainThread]: [31mFailure in seed raw_customers (seeds\raw_customers.csv)[0m
[0m03:25:48.460588 [error] [MainThread]:   Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.460588 [info ] [MainThread]: 
[0m03:25:48.468024 [error] [MainThread]: [31mFailure in seed raw_orders (seeds\raw_orders.csv)[0m
[0m03:25:48.473519 [error] [MainThread]:   Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status' : 'VARCHAR'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:25:48.478601 [info ] [MainThread]: 
[0m03:25:48.479293 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m03:25:48.484615 [debug] [MainThread]: Command `dbt seed` failed at 03:25:48.481612 after 6.10 seconds
[0m03:25:48.486609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FD9EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FD9E9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002138FD9F510>]}
[0m03:25:48.487596 [debug] [MainThread]: Flushing usage events
[0m03:25:49.421474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:37:13.870158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473D29F610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024739ACA810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473D29C410>]}


============================== 03:37:13.878110 | d6330736-fca0-4b9b-9119-388a17019c92 ==============================
[0m03:37:13.878110 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:37:13.880108 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m03:37:14.561101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473E494190>]}
[0m03:37:14.656772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473C290110>]}
[0m03:37:14.656772 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:37:15.067989 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:37:15.354262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:37:15.355262 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_customers.csv
[0m03:37:15.357226 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_payments.csv
[0m03:37:15.358256 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_orders.csv
[0m03:37:15.693971 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_dbt.marts
[0m03:37:15.693971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473E716590>]}
[0m03:37:15.825824 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:37:15.836991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:37:15.907698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473E9DF390>]}
[0m03:37:15.908696 [info ] [MainThread]: Found 3 models, 3 seeds, 472 macros
[0m03:37:15.909418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473E718D90>]}
[0m03:37:15.912445 [info ] [MainThread]: 
[0m03:37:15.913482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:37:15.916176 [info ] [MainThread]: 
[0m03:37:15.918170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:37:15.929609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m03:37:16.179508 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m03:37:16.179508 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m03:37:16.179508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:16.240665 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m03:37:16.240665 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m03:37:16.240665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m03:37:16.240665 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m03:37:16.260480 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:37:16.261476 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m03:37:16.262474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:37:16.265155 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m03:37:16.267152 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:37:16.268150 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m03:37:16.269146 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:37:16.270144 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:37:16.271140 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m03:37:16.274132 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:37:16.275130 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:37:16.276127 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:37:16.277125 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:37:16.278122 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:37:16.279119 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m03:37:16.282478 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m03:37:16.292552 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:37:16.293550 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m03:37:16.294549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:37:16.295546 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:37:16.296544 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:37:16.297542 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m03:37:16.335916 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m03:37:16.337908 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m03:37:16.340331 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m03:37:16.341334 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m03:37:16.343036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473E98B490>]}
[0m03:37:16.344038 [debug] [MainThread]: Using duckdb connection "master"
[0m03:37:16.345071 [debug] [MainThread]: On master: BEGIN
[0m03:37:16.345071 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:37:16.346031 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:37:16.347061 [debug] [MainThread]: On master: COMMIT
[0m03:37:16.348026 [debug] [MainThread]: Using duckdb connection "master"
[0m03:37:16.349056 [debug] [MainThread]: On master: COMMIT
[0m03:37:16.350128 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:37:16.351159 [debug] [MainThread]: On master: Close
[0m03:37:16.360875 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m03:37:16.361876 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m03:37:16.361876 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m03:37:16.363216 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m03:37:16.365053 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m03:37:16.366049 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m03:37:16.368193 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m03:37:16.369732 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m03:37:16.370304 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m03:37:16.371524 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m03:37:16.372677 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m03:37:16.373444 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m03:37:16.374508 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m03:37:16.375316 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m03:37:16.376413 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m03:37:16.436738 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:37:16.437738 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:37:16.438764 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: BEGIN
[0m03:37:16.441243 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:37:16.441654 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: BEGIN
[0m03:37:16.442775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:37:16.443806 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: BEGIN
[0m03:37:16.443806 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:37:16.447053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:37:16.448080 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m03:37:16.450042 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m03:37:16.450719 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:37:16.451752 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m03:37:16.452717 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:37:16.453850 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_customers"} */

    create table "jaffle_dbt"."main"."raw_customers" ("id,first_name,last_name
1,Michael,P.
2,Shawn,M.
3,Kathleen,P.
4,Jimmy,C.
5,Katherine,R.
6,Sarah,R.
7,Martin,M.
8,Frank,R.
9,Jennifer,F.
10,Henry,W.
11,Fred,S.
12,Amy,D.
13,Kathleen,M.
14,Steve,F.
15,Teresa,H.
16,Amanda,H.
17,Kimberly,R.
18,Johnny,K.
19,Virginia,F.
20,Anna,A.
21,Willie,H.
22,Sean,H.
23,Mildred,A.
24,David,G.
25,Victor,H.
26,Aaron,R.
27,Benjamin,B.
28,Lisa,W.
29,Benjamin,K.
30,Christina,W.
31,Jane,G.
32,Thomas,O.
33,Katherine,M.
34,Jennifer,S.
35,Sara,T.
36,Harold,O.
37,Shirley,J.
38,Dennis,J.
39,Louise,W.
40,Maria,A.
41,Gloria,C.
42,Diana,S.
43,Kelly,N.
44,Jane,R.
45,Scott,B.
46,Norma,C.
47,Marie,P.
48,Lillian,C.
49,Judy,N.
50,Billy,L.
51,Howard,R.
52,Laura,F.
53,Anne,B.
54,Rose,M.
55,Nicholas,R.
56,Joshua,K.
57,Paul,W.
58,Kathryn,K.
59,Adam,A.
60,Norma,W.
61,Timothy,R.
62,Elizabeth,P.
63,Edward,G.
64,David,C.
65,Brenda,W.
66,Adam,W.
67,Michael,H.
68,Jesse,E.
69,Janet,P.
70,Helen,F.
71,Gerald,C.
72,Kathryn,O.
73,Alan,B.
74,Harry,A.
75,Andrea,H.
76,Barbara,W.
77,Anne,W.
78,Harry,H.
79,Jack,R.
80,Phillip,H.
81,Shirley,H.
82,Arthur,D.
83,Virginia,R.
84,Christina,R.
85,Theresa,M.
86,Jason,C.
87,Phillip,B.
88,Adam,T.
89,Margaret,J.
90,Paul,P.
91,Todd,W.
92,Willie,O.
93,Frances,R.
94,Gregory,H.
95,Lisa,P.
96,Jacqueline,A.
97,Shirley,D.
98,Nicole,M.
99,Mary,G.
100,Jean,M.
" integer)
  
[0m03:37:16.455221 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:37:16.456188 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_orders"} */

    create table "jaffle_dbt"."main"."raw_orders" ("id,user_id,order_date,status
1,1,2018-01-01,returned
2,3,2018-01-02,completed
3,94,2018-01-04,completed
4,50,2018-01-05,completed
5,64,2018-01-05,completed
6,54,2018-01-07,completed
7,88,2018-01-09,completed
8,2,2018-01-11,returned
9,53,2018-01-12,completed
10,7,2018-01-14,completed
11,99,2018-01-14,completed
12,59,2018-01-15,completed
13,84,2018-01-17,completed
14,40,2018-01-17,returned
15,25,2018-01-17,completed
16,39,2018-01-18,completed
17,71,2018-01-18,completed
18,64,2018-01-20,returned
19,54,2018-01-22,completed
20,20,2018-01-23,completed
21,71,2018-01-23,completed
22,86,2018-01-24,completed
23,22,2018-01-26,return_pending
24,3,2018-01-27,completed
25,51,2018-01-28,completed
26,32,2018-01-28,completed
27,94,2018-01-29,completed
28,8,2018-01-29,completed
29,57,2018-01-31,completed
30,69,2018-02-02,completed
31,16,2018-02-02,completed
32,28,2018-02-04,completed
33,42,2018-02-04,completed
34,38,2018-02-06,completed
35,80,2018-02-08,completed
36,85,2018-02-10,completed
37,1,2018-02-10,completed
38,51,2018-02-10,completed
39,26,2018-02-11,completed
40,33,2018-02-13,completed
41,99,2018-02-14,completed
42,92,2018-02-16,completed
43,31,2018-02-17,completed
44,66,2018-02-17,completed
45,22,2018-02-17,completed
46,6,2018-02-19,completed
47,50,2018-02-20,completed
48,27,2018-02-21,completed
49,35,2018-02-21,completed
50,51,2018-02-23,completed
51,71,2018-02-24,completed
52,54,2018-02-25,return_pending
53,34,2018-02-26,completed
54,54,2018-02-26,completed
55,18,2018-02-27,completed
56,79,2018-02-28,completed
57,93,2018-03-01,completed
58,22,2018-03-01,completed
59,30,2018-03-02,completed
60,12,2018-03-03,completed
61,63,2018-03-03,completed
62,57,2018-03-05,completed
63,70,2018-03-06,completed
64,13,2018-03-07,completed
65,26,2018-03-08,completed
66,36,2018-03-10,completed
67,79,2018-03-11,completed
68,53,2018-03-11,completed
69,3,2018-03-11,completed
70,8,2018-03-12,completed
71,42,2018-03-12,shipped
72,30,2018-03-14,shipped
73,19,2018-03-16,completed
74,9,2018-03-17,shipped
75,69,2018-03-18,completed
76,25,2018-03-20,completed
77,35,2018-03-21,shipped
78,90,2018-03-23,shipped
79,52,2018-03-23,shipped
80,11,2018-03-23,shipped
81,76,2018-03-23,shipped
82,46,2018-03-24,shipped
83,54,2018-03-24,shipped
84,70,2018-03-26,placed
85,47,2018-03-26,shipped
86,68,2018-03-26,placed
87,46,2018-03-27,placed
88,91,2018-03-27,shipped
89,21,2018-03-28,placed
90,66,2018-03-30,shipped
91,47,2018-03-31,placed
92,84,2018-04-02,placed
93,66,2018-04-03,placed
94,63,2018-04-03,placed
95,27,2018-04-04,placed
96,90,2018-04-06,placed
97,89,2018-04-07,placed
98,41,2018-04-07,placed
99,85,2018-04-09,placed
" integer)
  
[0m03:37:16.459196 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_payments"} */

    create table "jaffle_dbt"."main"."raw_payments" ("id,order_id,payment_method,amount
1,1,credit_card,1000
2,2,credit_card,2000
3,3,coupon,100
4,4,coupon,2500
5,5,bank_transfer,1700
6,6,credit_card,600
7,7,credit_card,1600
8,8,credit_card,2300
9,9,gift_card,2300
10,9,bank_transfer,0
11,10,bank_transfer,2600
12,11,credit_card,2700
13,12,credit_card,100
14,13,credit_card,500
15,13,bank_transfer,1400
16,14,bank_transfer,300
17,15,coupon,2200
18,16,credit_card,1000
19,17,bank_transfer,200
20,18,credit_card,500
21,18,credit_card,800
22,19,gift_card,600
23,20,bank_transfer,1500
24,21,credit_card,1200
25,22,bank_transfer,800
26,23,gift_card,2300
27,24,coupon,2600
28,25,bank_transfer,2000
29,25,credit_card,2200
30,25,coupon,1600
31,26,credit_card,3000
32,27,credit_card,2300
33,28,bank_transfer,1900
34,29,bank_transfer,1200
35,30,credit_card,1300
36,31,credit_card,1200
37,32,credit_card,300
38,33,credit_card,2200
39,34,bank_transfer,1500
40,35,credit_card,2900
41,36,bank_transfer,900
42,37,credit_card,2300
43,38,credit_card,1500
44,39,bank_transfer,800
45,40,credit_card,1400
46,41,credit_card,1700
47,42,coupon,1700
48,43,gift_card,1800
49,44,gift_card,1100
50,45,bank_transfer,500
51,46,bank_transfer,800
52,47,credit_card,2200
53,48,bank_transfer,300
54,49,credit_card,600
55,49,credit_card,900
56,50,credit_card,2600
57,51,credit_card,2900
58,51,credit_card,100
59,52,bank_transfer,1500
60,53,credit_card,300
61,54,credit_card,1800
62,54,bank_transfer,1100
63,55,credit_card,2900
64,56,credit_card,400
65,57,bank_transfer,200
66,58,coupon,1800
67,58,gift_card,600
68,59,gift_card,2800
69,60,credit_card,400
70,61,bank_transfer,1600
71,62,gift_card,1400
72,63,credit_card,2900
73,64,bank_transfer,2600
74,65,credit_card,0
75,66,credit_card,2800
76,67,bank_transfer,400
77,67,credit_card,1900
78,68,credit_card,1600
79,69,credit_card,1900
80,70,credit_card,2600
81,71,credit_card,500
82,72,credit_card,2900
83,73,bank_transfer,300
84,74,credit_card,3000
85,75,credit_card,1900
86,76,coupon,200
87,77,credit_card,0
88,77,bank_transfer,1900
89,78,bank_transfer,2600
90,79,credit_card,1800
91,79,credit_card,900
92,80,gift_card,300
93,81,coupon,200
94,82,credit_card,800
95,83,credit_card,100
96,84,bank_transfer,2500
97,85,bank_transfer,1700
98,86,coupon,2300
99,87,gift_card,3000
100,87,credit_card,2600
101,88,credit_card,2900
102,89,bank_transfer,2200
103,90,bank_transfer,200
104,91,credit_card,1900
105,92,bank_transfer,1500
106,92,coupon,200
107,93,gift_card,2600
108,94,coupon,700
109,95,coupon,2400
110,96,gift_card,1700
111,97,bank_transfer,1400
112,98,bank_transfer,1000
113,99,credit_card,2400
" integer)
  
[0m03:37:16.460181 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m03:37:16.462430 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m03:37:16.463562 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m03:37:16.481518 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:37:16.483857 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:37:16.486152 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:37:16.487566 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:37:16.488365 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:37:16.489469 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:37:16.529817 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:37:16.530479 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:37:16.530479 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m03:37:16.530479 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:37:16.530479 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m03:37:16.530479 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m03:37:16.530479 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: ROLLBACK
[0m03:37:16.530479 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: ROLLBACK
[0m03:37:16.530479 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: ROLLBACK
[0m03:37:16.567293 [debug] [Thread-2 (]: Failed to rollback 'seed.jaffle_dbt.raw_orders'
[0m03:37:16.570318 [debug] [Thread-1 (]: Failed to rollback 'seed.jaffle_dbt.raw_customers'
[0m03:37:16.571285 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: Close
[0m03:37:16.573280 [debug] [Thread-3 (]: Failed to rollback 'seed.jaffle_dbt.raw_payments'
[0m03:37:16.574113 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: Close
[0m03:37:16.578289 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: Close
[0m03:37:16.588184 [debug] [Thread-2 (]: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status
  1,1,2018-01-01,returned
  2,3,2018-01-02,completed
  3,94,2018-01-04,completed
  4,50,2018-01-05,completed
  5,64,2018-01-05,completed
  6,54,2018-01-07,completed
  7,88,2018-01-09,completed
  8,2,2018-01-11,returned
  9,53,2018-01-12,completed
  10,7,2018-01-14,completed
  11,99,2018-01-14,completed
  12,59,2018-01-15,completed
  13,84,2018-01-17,completed
  14,40,2018-01-17,returned
  15,25,2018-01-17,completed
  16,39,2018-01-18,completed
  17,71,2018-01-18,completed
  18,64,2018-01-20,returned
  19,54,2018-01-22,completed
  20,20,2018-01-23,completed
  21,71,2018-01-23,completed
  22,86,2018-01-24,completed
  23,22,2018-01-26,return_pending
  24,3,2018-01-27,completed
  25,51,2018-01-28,completed
  26,32,2018-01-28,completed
  27,94,2018-01-29,completed
  28,8,2018-01-29,completed
  29,57,2018-01-31,completed
  30,69,2018-02-02,completed
  31,16,2018-02-02,completed
  32,28,2018-02-04,completed
  33,42,2018-02-04,completed
  34,38,2018-02-06,completed
  35,80,2018-02-08,completed
  36,85,2018-02-10,completed
  37,1,2018-02-10,completed
  38,51,2018-02-10,completed
  39,26,2018-02-11,completed
  40,33,2018-02-13,completed
  41,99,2018-02-14,completed
  42,92,2018-02-16,completed
  43,31,2018-02-17,completed
  44,66,2018-02-17,completed
  45,22,2018-02-17,completed
  46,6,2018-02-19,completed
  47,50,2018-02-20,completed
  48,27,2018-02-21,completed
  49,35,2018-02-21,completed
  50,51,2018-02-23,completed
  51,71,2018-02-24,completed
  52,54,2018-02-25,return_pending
  53,34,2018-02-26,completed
  54,54,2018-02-26,completed
  55,18,2018-02-27,completed
  56,79,2018-02-28,completed
  57,93,2018-03-01,completed
  58,22,2018-03-01,completed
  59,30,2018-03-02,completed
  60,12,2018-03-03,completed
  61,63,2018-03-03,completed
  62,57,2018-03-05,completed
  63,70,2018-03-06,completed
  64,13,2018-03-07,completed
  65,26,2018-03-08,completed
  66,36,2018-03-10,completed
  67,79,2018-03-11,completed
  68,53,2018-03-11,completed
  69,3,2018-03-11,completed
  70,8,2018-03-12,completed
  71,42,2018-03-12,shipped
  72,30,2018-03-14,shipped
  73,19,2018-03-16,completed
  74,9,2018-03-17,shipped
  75,69,2018-03-18,completed
  76,25,2018-03-20,completed
  77,35,2018-03-21,shipped
  78,90,2018-03-23,shipped
  79,52,2018-03-23,shipped
  80,11,2018-03-23,shipped
  81,76,2018-03-23,shipped
  82,46,2018-03-24,shipped
  83,54,2018-03-24,shipped
  84,70,2018-03-26,placed
  85,47,2018-03-26,shipped
  86,68,2018-03-26,placed
  87,46,2018-03-27,placed
  88,91,2018-03-27,shipped
  89,21,2018-03-28,placed
  90,66,2018-03-30,shipped
  91,47,2018-03-31,placed
  92,84,2018-04-02,placed
  93,66,2018-04-03,placed
  94,63,2018-04-03,placed
  95,27,2018-04-04,placed
  96,90,2018-04-06,placed
  97,89,2018-04-07,placed
  98,41,2018-04-07,placed
  99,85,2018-04-09,placed
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.593137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473EE32E90>]}
[0m03:37:16.596127 [debug] [Thread-1 (]: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name
  1,Michael,P.
  2,Shawn,M.
  3,Kathleen,P.
  4,Jimmy,C.
  5,Katherine,R.
  6,Sarah,R.
  7,Martin,M.
  8,Frank,R.
  9,Jennifer,F.
  10,Henry,W.
  11,Fred,S.
  12,Amy,D.
  13,Kathleen,M.
  14,Steve,F.
  15,Teresa,H.
  16,Amanda,H.
  17,Kimberly,R.
  18,Johnny,K.
  19,Virginia,F.
  20,Anna,A.
  21,Willie,H.
  22,Sean,H.
  23,Mildred,A.
  24,David,G.
  25,Victor,H.
  26,Aaron,R.
  27,Benjamin,B.
  28,Lisa,W.
  29,Benjamin,K.
  30,Christina,W.
  31,Jane,G.
  32,Thomas,O.
  33,Katherine,M.
  34,Jennifer,S.
  35,Sara,T.
  36,Harold,O.
  37,Shirley,J.
  38,Dennis,J.
  39,Louise,W.
  40,Maria,A.
  41,Gloria,C.
  42,Diana,S.
  43,Kelly,N.
  44,Jane,R.
  45,Scott,B.
  46,Norma,C.
  47,Marie,P.
  48,Lillian,C.
  49,Judy,N.
  50,Billy,L.
  51,Howard,R.
  52,Laura,F.
  53,Anne,B.
  54,Rose,M.
  55,Nicholas,R.
  56,Joshua,K.
  57,Paul,W.
  58,Kathryn,K.
  59,Adam,A.
  60,Norma,W.
  61,Timothy,R.
  62,Elizabeth,P.
  63,Edward,G.
  64,David,C.
  65,Brenda,W.
  66,Adam,W.
  67,Michael,H.
  68,Jesse,E.
  69,Janet,P.
  70,Helen,F.
  71,Gerald,C.
  72,Kathryn,O.
  73,Alan,B.
  74,Harry,A.
  75,Andrea,H.
  76,Barbara,W.
  77,Anne,W.
  78,Harry,H.
  79,Jack,R.
  80,Phillip,H.
  81,Shirley,H.
  82,Arthur,D.
  83,Virginia,R.
  84,Christina,R.
  85,Theresa,M.
  86,Jason,C.
  87,Phillip,B.
  88,Adam,T.
  89,Margaret,J.
  90,Paul,P.
  91,Todd,W.
  92,Willie,O.
  93,Frances,R.
  94,Gregory,H.
  95,Lisa,P.
  96,Jacqueline,A.
  97,Shirley,D.
  98,Nicole,M.
  99,Mary,G.
  100,Jean,M.
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.598188 [debug] [Thread-3 (]: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount
  1,1,credit_card,1000
  2,2,credit_card,2000
  3,3,coupon,100
  4,4,coupon,2500
  5,5,bank_transfer,1700
  6,6,credit_card,600
  7,7,credit_card,1600
  8,8,credit_card,2300
  9,9,gift_card,2300
  10,9,bank_transfer,0
  11,10,bank_transfer,2600
  12,11,credit_card,2700
  13,12,credit_card,100
  14,13,credit_card,500
  15,13,bank_transfer,1400
  16,14,bank_transfer,300
  17,15,coupon,2200
  18,16,credit_card,1000
  19,17,bank_transfer,200
  20,18,credit_card,500
  21,18,credit_card,800
  22,19,gift_card,600
  23,20,bank_transfer,1500
  24,21,credit_card,1200
  25,22,bank_transfer,800
  26,23,gift_card,2300
  27,24,coupon,2600
  28,25,bank_transfer,2000
  29,25,credit_card,2200
  30,25,coupon,1600
  31,26,credit_card,3000
  32,27,credit_card,2300
  33,28,bank_transfer,1900
  34,29,bank_transfer,1200
  35,30,credit_card,1300
  36,31,credit_card,1200
  37,32,credit_card,300
  38,33,credit_card,2200
  39,34,bank_transfer,1500
  40,35,credit_card,2900
  41,36,bank_transfer,900
  42,37,credit_card,2300
  43,38,credit_card,1500
  44,39,bank_transfer,800
  45,40,credit_card,1400
  46,41,credit_card,1700
  47,42,coupon,1700
  48,43,gift_card,1800
  49,44,gift_card,1100
  50,45,bank_transfer,500
  51,46,bank_transfer,800
  52,47,credit_card,2200
  53,48,bank_transfer,300
  54,49,credit_card,600
  55,49,credit_card,900
  56,50,credit_card,2600
  57,51,credit_card,2900
  58,51,credit_card,100
  59,52,bank_transfer,1500
  60,53,credit_card,300
  61,54,credit_card,1800
  62,54,bank_transfer,1100
  63,55,credit_card,2900
  64,56,credit_card,400
  65,57,bank_transfer,200
  66,58,coupon,1800
  67,58,gift_card,600
  68,59,gift_card,2800
  69,60,credit_card,400
  70,61,bank_transfer,1600
  71,62,gift_card,1400
  72,63,credit_card,2900
  73,64,bank_transfer,2600
  74,65,credit_card,0
  75,66,credit_card,2800
  76,67,bank_transfer,400
  77,67,credit_card,1900
  78,68,credit_card,1600
  79,69,credit_card,1900
  80,70,credit_card,2600
  81,71,credit_card,500
  82,72,credit_card,2900
  83,73,bank_transfer,300
  84,74,credit_card,3000
  85,75,credit_card,1900
  86,76,coupon,200
  87,77,credit_card,0
  88,77,bank_transfer,1900
  89,78,bank_transfer,2600
  90,79,credit_card,1800
  91,79,credit_card,900
  92,80,gift_card,300
  93,81,coupon,200
  94,82,credit_card,800
  95,83,credit_card,100
  96,84,bank_transfer,2500
  97,85,bank_transfer,1700
  98,86,coupon,2300
  99,87,gift_card,3000
  100,87,credit_card,2600
  101,88,credit_card,2900
  102,89,bank_transfer,2200
  103,90,bank_transfer,200
  104,91,credit_card,1900
  105,92,bank_transfer,1500
  106,92,coupon,200
  107,93,gift_card,2600
  108,94,coupon,700
  109,95,coupon,2400
  110,96,gift_card,1700
  111,97,bank_transfer,1400
  112,98,bank_transfer,1000
  113,99,credit_card,2400
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.598188 [error] [Thread-2 (]: 2 of 3 ERROR loading seed file main.raw_orders ................................. [[31mERROR[0m in 0.22s]
[0m03:37:16.598188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473EC61590>]}
[0m03:37:16.598188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6330736-fca0-4b9b-9119-388a17019c92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473EE27050>]}
[0m03:37:16.598188 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m03:37:16.598188 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file main.raw_customers .............................. [[31mERROR[0m in 0.23s]
[0m03:37:16.612287 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status
  1,1,2018-01-01,returned
  2,3,2018-01-02,completed
  3,94,2018-01-04,completed
  4,50,2018-01-05,completed
  5,64,2018-01-05,completed
  6,54,2018-01-07,completed
  7,88,2018-01-09,completed
  8,2,2018-01-11,returned
  9,53,2018-01-12,completed
  10,7,2018-01-14,completed
  11,99,2018-01-14,completed
  12,59,2018-01-15,completed
  13,84,2018-01-17,completed
  14,40,2018-01-17,returned
  15,25,2018-01-17,completed
  16,39,2018-01-18,completed
  17,71,2018-01-18,completed
  18,64,2018-01-20,returned
  19,54,2018-01-22,completed
  20,20,2018-01-23,completed
  21,71,2018-01-23,completed
  22,86,2018-01-24,completed
  23,22,2018-01-26,return_pending
  24,3,2018-01-27,completed
  25,51,2018-01-28,completed
  26,32,2018-01-28,completed
  27,94,2018-01-29,completed
  28,8,2018-01-29,completed
  29,57,2018-01-31,completed
  30,69,2018-02-02,completed
  31,16,2018-02-02,completed
  32,28,2018-02-04,completed
  33,42,2018-02-04,completed
  34,38,2018-02-06,completed
  35,80,2018-02-08,completed
  36,85,2018-02-10,completed
  37,1,2018-02-10,completed
  38,51,2018-02-10,completed
  39,26,2018-02-11,completed
  40,33,2018-02-13,completed
  41,99,2018-02-14,completed
  42,92,2018-02-16,completed
  43,31,2018-02-17,completed
  44,66,2018-02-17,completed
  45,22,2018-02-17,completed
  46,6,2018-02-19,completed
  47,50,2018-02-20,completed
  48,27,2018-02-21,completed
  49,35,2018-02-21,completed
  50,51,2018-02-23,completed
  51,71,2018-02-24,completed
  52,54,2018-02-25,return_pending
  53,34,2018-02-26,completed
  54,54,2018-02-26,completed
  55,18,2018-02-27,completed
  56,79,2018-02-28,completed
  57,93,2018-03-01,completed
  58,22,2018-03-01,completed
  59,30,2018-03-02,completed
  60,12,2018-03-03,completed
  61,63,2018-03-03,completed
  62,57,2018-03-05,completed
  63,70,2018-03-06,completed
  64,13,2018-03-07,completed
  65,26,2018-03-08,completed
  66,36,2018-03-10,completed
  67,79,2018-03-11,completed
  68,53,2018-03-11,completed
  69,3,2018-03-11,completed
  70,8,2018-03-12,completed
  71,42,2018-03-12,shipped
  72,30,2018-03-14,shipped
  73,19,2018-03-16,completed
  74,9,2018-03-17,shipped
  75,69,2018-03-18,completed
  76,25,2018-03-20,completed
  77,35,2018-03-21,shipped
  78,90,2018-03-23,shipped
  79,52,2018-03-23,shipped
  80,11,2018-03-23,shipped
  81,76,2018-03-23,shipped
  82,46,2018-03-24,shipped
  83,54,2018-03-24,shipped
  84,70,2018-03-26,placed
  85,47,2018-03-26,shipped
  86,68,2018-03-26,placed
  87,46,2018-03-27,placed
  88,91,2018-03-27,shipped
  89,21,2018-03-28,placed
  90,66,2018-03-30,shipped
  91,47,2018-03-31,placed
  92,84,2018-04-02,placed
  93,66,2018-04-03,placed
  94,63,2018-04-03,placed
  95,27,2018-04-04,placed
  96,90,2018-04-06,placed
  97,89,2018-04-07,placed
  98,41,2018-04-07,placed
  99,85,2018-04-09,placed
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:37:16.609738 [error] [Thread-3 (]: 3 of 3 ERROR loading seed file main.raw_payments ............................... [[31mERROR[0m in 0.23s]
[0m03:37:16.615053 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m03:37:16.615053 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m03:37:16.615053 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_customers' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name
  1,Michael,P.
  2,Shawn,M.
  3,Kathleen,P.
  4,Jimmy,C.
  5,Katherine,R.
  6,Sarah,R.
  7,Martin,M.
  8,Frank,R.
  9,Jennifer,F.
  10,Henry,W.
  11,Fred,S.
  12,Amy,D.
  13,Kathleen,M.
  14,Steve,F.
  15,Teresa,H.
  16,Amanda,H.
  17,Kimberly,R.
  18,Johnny,K.
  19,Virginia,F.
  20,Anna,A.
  21,Willie,H.
  22,Sean,H.
  23,Mildred,A.
  24,David,G.
  25,Victor,H.
  26,Aaron,R.
  27,Benjamin,B.
  28,Lisa,W.
  29,Benjamin,K.
  30,Christina,W.
  31,Jane,G.
  32,Thomas,O.
  33,Katherine,M.
  34,Jennifer,S.
  35,Sara,T.
  36,Harold,O.
  37,Shirley,J.
  38,Dennis,J.
  39,Louise,W.
  40,Maria,A.
  41,Gloria,C.
  42,Diana,S.
  43,Kelly,N.
  44,Jane,R.
  45,Scott,B.
  46,Norma,C.
  47,Marie,P.
  48,Lillian,C.
  49,Judy,N.
  50,Billy,L.
  51,Howard,R.
  52,Laura,F.
  53,Anne,B.
  54,Rose,M.
  55,Nicholas,R.
  56,Joshua,K.
  57,Paul,W.
  58,Kathryn,K.
  59,Adam,A.
  60,Norma,W.
  61,Timothy,R.
  62,Elizabeth,P.
  63,Edward,G.
  64,David,C.
  65,Brenda,W.
  66,Adam,W.
  67,Michael,H.
  68,Jesse,E.
  69,Janet,P.
  70,Helen,F.
  71,Gerald,C.
  72,Kathryn,O.
  73,Alan,B.
  74,Harry,A.
  75,Andrea,H.
  76,Barbara,W.
  77,Anne,W.
  78,Harry,H.
  79,Jack,R.
  80,Phillip,H.
  81,Shirley,H.
  82,Arthur,D.
  83,Virginia,R.
  84,Christina,R.
  85,Theresa,M.
  86,Jason,C.
  87,Phillip,B.
  88,Adam,T.
  89,Margaret,J.
  90,Paul,P.
  91,Todd,W.
  92,Willie,O.
  93,Frances,R.
  94,Gregory,H.
  95,Lisa,P.
  96,Jacqueline,A.
  97,Shirley,D.
  98,Nicole,M.
  99,Mary,G.
  100,Jean,M.
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:37:16.615053 [debug] [Thread-7 (]: Marking all children of 'seed.jaffle_dbt.raw_payments' to be skipped because of status 'error'.  Reason: Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount
  1,1,credit_card,1000
  2,2,credit_card,2000
  3,3,coupon,100
  4,4,coupon,2500
  5,5,bank_transfer,1700
  6,6,credit_card,600
  7,7,credit_card,1600
  8,8,credit_card,2300
  9,9,gift_card,2300
  10,9,bank_transfer,0
  11,10,bank_transfer,2600
  12,11,credit_card,2700
  13,12,credit_card,100
  14,13,credit_card,500
  15,13,bank_transfer,1400
  16,14,bank_transfer,300
  17,15,coupon,2200
  18,16,credit_card,1000
  19,17,bank_transfer,200
  20,18,credit_card,500
  21,18,credit_card,800
  22,19,gift_card,600
  23,20,bank_transfer,1500
  24,21,credit_card,1200
  25,22,bank_transfer,800
  26,23,gift_card,2300
  27,24,coupon,2600
  28,25,bank_transfer,2000
  29,25,credit_card,2200
  30,25,coupon,1600
  31,26,credit_card,3000
  32,27,credit_card,2300
  33,28,bank_transfer,1900
  34,29,bank_transfer,1200
  35,30,credit_card,1300
  36,31,credit_card,1200
  37,32,credit_card,300
  38,33,credit_card,2200
  39,34,bank_transfer,1500
  40,35,credit_card,2900
  41,36,bank_transfer,900
  42,37,credit_card,2300
  43,38,credit_card,1500
  44,39,bank_transfer,800
  45,40,credit_card,1400
  46,41,credit_card,1700
  47,42,coupon,1700
  48,43,gift_card,1800
  49,44,gift_card,1100
  50,45,bank_transfer,500
  51,46,bank_transfer,800
  52,47,credit_card,2200
  53,48,bank_transfer,300
  54,49,credit_card,600
  55,49,credit_card,900
  56,50,credit_card,2600
  57,51,credit_card,2900
  58,51,credit_card,100
  59,52,bank_transfer,1500
  60,53,credit_card,300
  61,54,credit_card,1800
  62,54,bank_transfer,1100
  63,55,credit_card,2900
  64,56,credit_card,400
  65,57,bank_transfer,200
  66,58,coupon,1800
  67,58,gift_card,600
  68,59,gift_card,2800
  69,60,credit_card,400
  70,61,bank_transfer,1600
  71,62,gift_card,1400
  72,63,credit_card,2900
  73,64,bank_transfer,2600
  74,65,credit_card,0
  75,66,credit_card,2800
  76,67,bank_transfer,400
  77,67,credit_card,1900
  78,68,credit_card,1600
  79,69,credit_card,1900
  80,70,credit_card,2600
  81,71,credit_card,500
  82,72,credit_card,2900
  83,73,bank_transfer,300
  84,74,credit_card,3000
  85,75,credit_card,1900
  86,76,coupon,200
  87,77,credit_card,0
  88,77,bank_transfer,1900
  89,78,bank_transfer,2600
  90,79,credit_card,1800
  91,79,credit_card,900
  92,80,gift_card,300
  93,81,coupon,200
  94,82,credit_card,800
  95,83,credit_card,100
  96,84,bank_transfer,2500
  97,85,bank_transfer,1700
  98,86,coupon,2300
  99,87,gift_card,3000
  100,87,credit_card,2600
  101,88,credit_card,2900
  102,89,bank_transfer,2200
  103,90,bank_transfer,200
  104,91,credit_card,1900
  105,92,bank_transfer,1500
  106,92,coupon,200
  107,93,gift_card,2600
  108,94,coupon,700
  109,95,coupon,2400
  110,96,gift_card,1700
  111,97,bank_transfer,1400
  112,98,bank_transfer,1000
  113,99,credit_card,2400
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  .
[0m03:37:16.615053 [debug] [MainThread]: Using duckdb connection "master"
[0m03:37:16.615053 [debug] [MainThread]: On master: BEGIN
[0m03:37:16.615053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:37:16.615053 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:37:16.615053 [debug] [MainThread]: On master: COMMIT
[0m03:37:16.631161 [debug] [MainThread]: Using duckdb connection "master"
[0m03:37:16.632160 [debug] [MainThread]: On master: COMMIT
[0m03:37:16.634155 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:37:16.635528 [debug] [MainThread]: On master: Close
[0m03:37:16.636524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:37:16.636524 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m03:37:16.638520 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m03:37:16.638520 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_customers' was properly closed.
[0m03:37:16.639517 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_orders' was properly closed.
[0m03:37:16.640514 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_payments' was properly closed.
[0m03:37:16.642194 [info ] [MainThread]: 
[0m03:37:16.642870 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m03:37:16.646863 [debug] [MainThread]: Command end result
[0m03:37:16.690294 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:37:16.694283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:37:16.699521 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m03:37:16.699521 [info ] [MainThread]: 
[0m03:37:16.699521 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m03:37:16.699521 [info ] [MainThread]: 
[0m03:37:16.699521 [error] [MainThread]: [31mFailure in seed raw_orders (seeds\raw_orders.csv)[0m
[0m03:37:16.713660 [error] [MainThread]:   Runtime Error in seed raw_orders (seeds\raw_orders.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,user_id,order_date,status
  1,1,2018-01-01,returned
  2,3,2018-01-02,completed
  3,94,2018-01-04,completed
  4,50,2018-01-05,completed
  5,64,2018-01-05,completed
  6,54,2018-01-07,completed
  7,88,2018-01-09,completed
  8,2,2018-01-11,returned
  9,53,2018-01-12,completed
  10,7,2018-01-14,completed
  11,99,2018-01-14,completed
  12,59,2018-01-15,completed
  13,84,2018-01-17,completed
  14,40,2018-01-17,returned
  15,25,2018-01-17,completed
  16,39,2018-01-18,completed
  17,71,2018-01-18,completed
  18,64,2018-01-20,returned
  19,54,2018-01-22,completed
  20,20,2018-01-23,completed
  21,71,2018-01-23,completed
  22,86,2018-01-24,completed
  23,22,2018-01-26,return_pending
  24,3,2018-01-27,completed
  25,51,2018-01-28,completed
  26,32,2018-01-28,completed
  27,94,2018-01-29,completed
  28,8,2018-01-29,completed
  29,57,2018-01-31,completed
  30,69,2018-02-02,completed
  31,16,2018-02-02,completed
  32,28,2018-02-04,completed
  33,42,2018-02-04,completed
  34,38,2018-02-06,completed
  35,80,2018-02-08,completed
  36,85,2018-02-10,completed
  37,1,2018-02-10,completed
  38,51,2018-02-10,completed
  39,26,2018-02-11,completed
  40,33,2018-02-13,completed
  41,99,2018-02-14,completed
  42,92,2018-02-16,completed
  43,31,2018-02-17,completed
  44,66,2018-02-17,completed
  45,22,2018-02-17,completed
  46,6,2018-02-19,completed
  47,50,2018-02-20,completed
  48,27,2018-02-21,completed
  49,35,2018-02-21,completed
  50,51,2018-02-23,completed
  51,71,2018-02-24,completed
  52,54,2018-02-25,return_pending
  53,34,2018-02-26,completed
  54,54,2018-02-26,completed
  55,18,2018-02-27,completed
  56,79,2018-02-28,completed
  57,93,2018-03-01,completed
  58,22,2018-03-01,completed
  59,30,2018-03-02,completed
  60,12,2018-03-03,completed
  61,63,2018-03-03,completed
  62,57,2018-03-05,completed
  63,70,2018-03-06,completed
  64,13,2018-03-07,completed
  65,26,2018-03-08,completed
  66,36,2018-03-10,completed
  67,79,2018-03-11,completed
  68,53,2018-03-11,completed
  69,3,2018-03-11,completed
  70,8,2018-03-12,completed
  71,42,2018-03-12,shipped
  72,30,2018-03-14,shipped
  73,19,2018-03-16,completed
  74,9,2018-03-17,shipped
  75,69,2018-03-18,completed
  76,25,2018-03-20,completed
  77,35,2018-03-21,shipped
  78,90,2018-03-23,shipped
  79,52,2018-03-23,shipped
  80,11,2018-03-23,shipped
  81,76,2018-03-23,shipped
  82,46,2018-03-24,shipped
  83,54,2018-03-24,shipped
  84,70,2018-03-26,placed
  85,47,2018-03-26,shipped
  86,68,2018-03-26,placed
  87,46,2018-03-27,placed
  88,91,2018-03-27,shipped
  89,21,2018-03-28,placed
  90,66,2018-03-30,shipped
  91,47,2018-03-31,placed
  92,84,2018-04-02,placed
  93,66,2018-04-03,placed
  94,63,2018-04-03,placed
  95,27,2018-04-04,placed
  96,90,2018-04-06,placed
  97,89,2018-04-07,placed
  98,41,2018-04-07,placed
  99,85,2018-04-09,placed
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.738169 [info ] [MainThread]: 
[0m03:37:16.739012 [error] [MainThread]: [31mFailure in seed raw_customers (seeds\raw_customers.csv)[0m
[0m03:37:16.741393 [error] [MainThread]:   Runtime Error in seed raw_customers (seeds\raw_customers.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,first_name,last_name
  1,Michael,P.
  2,Shawn,M.
  3,Kathleen,P.
  4,Jimmy,C.
  5,Katherine,R.
  6,Sarah,R.
  7,Martin,M.
  8,Frank,R.
  9,Jennifer,F.
  10,Henry,W.
  11,Fred,S.
  12,Amy,D.
  13,Kathleen,M.
  14,Steve,F.
  15,Teresa,H.
  16,Amanda,H.
  17,Kimberly,R.
  18,Johnny,K.
  19,Virginia,F.
  20,Anna,A.
  21,Willie,H.
  22,Sean,H.
  23,Mildred,A.
  24,David,G.
  25,Victor,H.
  26,Aaron,R.
  27,Benjamin,B.
  28,Lisa,W.
  29,Benjamin,K.
  30,Christina,W.
  31,Jane,G.
  32,Thomas,O.
  33,Katherine,M.
  34,Jennifer,S.
  35,Sara,T.
  36,Harold,O.
  37,Shirley,J.
  38,Dennis,J.
  39,Louise,W.
  40,Maria,A.
  41,Gloria,C.
  42,Diana,S.
  43,Kelly,N.
  44,Jane,R.
  45,Scott,B.
  46,Norma,C.
  47,Marie,P.
  48,Lillian,C.
  49,Judy,N.
  50,Billy,L.
  51,Howard,R.
  52,Laura,F.
  53,Anne,B.
  54,Rose,M.
  55,Nicholas,R.
  56,Joshua,K.
  57,Paul,W.
  58,Kathryn,K.
  59,Adam,A.
  60,Norma,W.
  61,Timothy,R.
  62,Elizabeth,P.
  63,Edward,G.
  64,David,C.
  65,Brenda,W.
  66,Adam,W.
  67,Michael,H.
  68,Jesse,E.
  69,Janet,P.
  70,Helen,F.
  71,Gerald,C.
  72,Kathryn,O.
  73,Alan,B.
  74,Harry,A.
  75,Andrea,H.
  76,Barbara,W.
  77,Anne,W.
  78,Harry,H.
  79,Jack,R.
  80,Phillip,H.
  81,Shirley,H.
  82,Arthur,D.
  83,Virginia,R.
  84,Christina,R.
  85,Theresa,M.
  86,Jason,C.
  87,Phillip,B.
  88,Adam,T.
  89,Margaret,J.
  90,Paul,P.
  91,Todd,W.
  92,Willie,O.
  93,Frances,R.
  94,Gregory,H.
  95,Lisa,P.
  96,Jacqueline,A.
  97,Shirley,D.
  98,Nicole,M.
  99,Mary,G.
  100,Jean,M.
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 3. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.762338 [info ] [MainThread]: 
[0m03:37:16.764084 [error] [MainThread]: [31mFailure in seed raw_payments (seeds\raw_payments.csv)[0m
[0m03:37:16.767078 [error] [MainThread]:   Runtime Error in seed raw_payments (seeds\raw_payments.csv)
  Invalid Input Error: Error when sniffing file "C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv".
  It was not possible to automatically detect the CSV parsing dialect
  The search space used was:
  Delimiter Candidates: ','
  Quote/Escape Candidates: ['(no quote)','(no escape)'],['"','(no escape)'],['"','"'],['"','''],['"','\'],[''','(no escape)'],[''','''],[''','"'],[''','\']
  Comment Candidates: '\0', '#'
  Encoding: utf-8
  Possible fixes:
  * Disable the parser's strict mode (strict_mode=false) to allow reading rows that do not comply with the CSV standard.
  * Columns are set as: "columns = { 'id,order_id,payment_method,amount
  1,1,credit_card,1000
  2,2,credit_card,2000
  3,3,coupon,100
  4,4,coupon,2500
  5,5,bank_transfer,1700
  6,6,credit_card,600
  7,7,credit_card,1600
  8,8,credit_card,2300
  9,9,gift_card,2300
  10,9,bank_transfer,0
  11,10,bank_transfer,2600
  12,11,credit_card,2700
  13,12,credit_card,100
  14,13,credit_card,500
  15,13,bank_transfer,1400
  16,14,bank_transfer,300
  17,15,coupon,2200
  18,16,credit_card,1000
  19,17,bank_transfer,200
  20,18,credit_card,500
  21,18,credit_card,800
  22,19,gift_card,600
  23,20,bank_transfer,1500
  24,21,credit_card,1200
  25,22,bank_transfer,800
  26,23,gift_card,2300
  27,24,coupon,2600
  28,25,bank_transfer,2000
  29,25,credit_card,2200
  30,25,coupon,1600
  31,26,credit_card,3000
  32,27,credit_card,2300
  33,28,bank_transfer,1900
  34,29,bank_transfer,1200
  35,30,credit_card,1300
  36,31,credit_card,1200
  37,32,credit_card,300
  38,33,credit_card,2200
  39,34,bank_transfer,1500
  40,35,credit_card,2900
  41,36,bank_transfer,900
  42,37,credit_card,2300
  43,38,credit_card,1500
  44,39,bank_transfer,800
  45,40,credit_card,1400
  46,41,credit_card,1700
  47,42,coupon,1700
  48,43,gift_card,1800
  49,44,gift_card,1100
  50,45,bank_transfer,500
  51,46,bank_transfer,800
  52,47,credit_card,2200
  53,48,bank_transfer,300
  54,49,credit_card,600
  55,49,credit_card,900
  56,50,credit_card,2600
  57,51,credit_card,2900
  58,51,credit_card,100
  59,52,bank_transfer,1500
  60,53,credit_card,300
  61,54,credit_card,1800
  62,54,bank_transfer,1100
  63,55,credit_card,2900
  64,56,credit_card,400
  65,57,bank_transfer,200
  66,58,coupon,1800
  67,58,gift_card,600
  68,59,gift_card,2800
  69,60,credit_card,400
  70,61,bank_transfer,1600
  71,62,gift_card,1400
  72,63,credit_card,2900
  73,64,bank_transfer,2600
  74,65,credit_card,0
  75,66,credit_card,2800
  76,67,bank_transfer,400
  77,67,credit_card,1900
  78,68,credit_card,1600
  79,69,credit_card,1900
  80,70,credit_card,2600
  81,71,credit_card,500
  82,72,credit_card,2900
  83,73,bank_transfer,300
  84,74,credit_card,3000
  85,75,credit_card,1900
  86,76,coupon,200
  87,77,credit_card,0
  88,77,bank_transfer,1900
  89,78,bank_transfer,2600
  90,79,credit_card,1800
  91,79,credit_card,900
  92,80,gift_card,300
  93,81,coupon,200
  94,82,credit_card,800
  95,83,credit_card,100
  96,84,bank_transfer,2500
  97,85,bank_transfer,1700
  98,86,coupon,2300
  99,87,gift_card,3000
  100,87,credit_card,2600
  101,88,credit_card,2900
  102,89,bank_transfer,2200
  103,90,bank_transfer,200
  104,91,credit_card,1900
  105,92,bank_transfer,1500
  106,92,coupon,200
  107,93,gift_card,2600
  108,94,coupon,700
  109,95,coupon,2400
  110,96,gift_card,1700
  111,97,bank_transfer,1400
  112,98,bank_transfer,1000
  113,99,credit_card,2400
  ' : 'INTEGER'}", and they contain: 1 columns. It does not match the number of columns found by the sniffer: 4. Verify the columns parameter is correctly set.
  * Make sure you are using the correct file encoding. If not, set it (e.g., encoding = 'utf-16').
  * Delimiter is set to ','. Consider unsetting it.
  * Set quote (e.g., quote='"')
  * Set escape (e.g., escape='"')
  * Set comment (e.g., comment='#')
  * Set skip (skip=${n}) to skip ${n} lines at the top of the file
  * Enable ignore errors (ignore_errors=true) to ignore potential errors
  * Enable null padding (null_padding=true) to pad missing columns with NULL values
  * Check you are using the correct file compression, otherwise set it (e.g., compression = 'zstd')
  * Be sure that the maximum line size is set to an appropriate value, otherwise set it (e.g., max_line_size=10000000)
  
[0m03:37:16.791153 [info ] [MainThread]: 
[0m03:37:16.793150 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m03:37:16.795143 [debug] [MainThread]: Command `dbt seed` failed at 03:37:16.795143 after 3.04 seconds
[0m03:37:16.796144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024739ACAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473D03CED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002473C3DD0D0>]}
[0m03:37:16.798137 [debug] [MainThread]: Flushing usage events
[0m03:37:17.805704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:39:55.163718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B20E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B20CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B20E450>]}


============================== 03:39:55.181627 | 36471117-7123-402c-b8b6-37bcd4ae5780 ==============================
[0m03:39:55.181627 [info ] [MainThread]: Running with dbt=1.11.2
[0m03:39:55.183590 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt seed', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m03:39:55.521968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0B2B3D10>]}
[0m03:39:55.623506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE07A6D710>]}
[0m03:39:55.627906 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m03:39:55.991352 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m03:39:56.204336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m03:39:56.206331 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_payments.csv
[0m03:39:56.207331 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_customers.csv
[0m03:39:56.208326 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://seeds\raw_orders.csv
[0m03:39:56.506827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.jaffle_dbt.marts
[0m03:39:56.516800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C866C10>]}
[0m03:39:56.637047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:39:56.640039 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:39:56.679869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C8D8350>]}
[0m03:39:56.679869 [info ] [MainThread]: Found 3 models, 3 seeds, 472 macros
[0m03:39:56.679869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C9B7510>]}
[0m03:39:56.679869 [info ] [MainThread]: 
[0m03:39:56.679869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:39:56.696034 [info ] [MainThread]: 
[0m03:39:56.697033 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:39:56.708002 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m03:39:56.902683 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m03:39:56.903682 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m03:39:56.904679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:56.928624 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m03:39:56.929708 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m03:39:56.929708 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m03:39:56.929708 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m03:39:56.945453 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:39:56.946453 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m03:39:56.947450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:39:56.948449 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m03:39:56.951439 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:39:56.951439 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m03:39:56.953433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:39:56.953433 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:39:56.954467 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m03:39:56.956425 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:39:56.957422 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:39:56.958461 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m03:39:56.959453 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m03:39:56.960580 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:39:56.961618 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m03:39:56.964766 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m03:39:56.974742 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:39:56.975932 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m03:39:56.976970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:39:56.977965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m03:39:56.978957 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m03:39:56.979955 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m03:39:56.991959 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m03:39:56.991959 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m03:39:56.991959 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m03:39:56.991959 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m03:39:57.007619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C8B6C10>]}
[0m03:39:57.007619 [debug] [MainThread]: Using duckdb connection "master"
[0m03:39:57.007619 [debug] [MainThread]: On master: BEGIN
[0m03:39:57.007619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:39:57.007619 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:39:57.007619 [debug] [MainThread]: On master: COMMIT
[0m03:39:57.007619 [debug] [MainThread]: Using duckdb connection "master"
[0m03:39:57.007619 [debug] [MainThread]: On master: COMMIT
[0m03:39:57.007619 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:39:57.007619 [debug] [MainThread]: On master: Close
[0m03:39:57.024030 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m03:39:57.025031 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m03:39:57.025031 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m03:39:57.026190 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m03:39:57.028190 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m03:39:57.029188 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m03:39:57.030182 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m03:39:57.031580 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m03:39:57.032859 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m03:39:57.033987 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m03:39:57.035084 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m03:39:57.035830 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m03:39:57.036831 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m03:39:57.037872 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m03:39:57.037872 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m03:39:57.158394 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:39:57.158394 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:39:57.164481 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:39:57.165445 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: BEGIN
[0m03:39:57.165920 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: BEGIN
[0m03:39:57.167072 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: BEGIN
[0m03:39:57.167839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:39:57.168868 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m03:39:57.169628 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m03:39:57.172625 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m03:39:57.173621 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m03:39:57.174620 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m03:39:57.175616 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:39:57.176613 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:39:57.179236 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:39:57.179236 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_customers"} */

    create table "jaffle_dbt"."main"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m03:39:57.179236 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_orders"} */

    create table "jaffle_dbt"."main"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m03:39:57.179236 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_payments"} */

    create table "jaffle_dbt"."main"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m03:39:57.179236 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m03:39:57.179236 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m03:39:57.194194 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m03:39:57.194194 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:39:57.194194 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:39:57.194194 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:39:57.194194 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:39:57.210161 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:39:57.211372 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m03:39:57.240409 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m03:39:57.240409 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m03:39:57.249421 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_payments"
[0m03:39:57.250383 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m03:39:57.251410 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_customers"
[0m03:39:57.253364 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_orders"
[0m03:39:57.281513 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: COMMIT
[0m03:39:57.284470 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: COMMIT
[0m03:39:57.286029 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: COMMIT
[0m03:39:57.287044 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m03:39:57.288023 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m03:39:57.289102 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m03:39:57.289914 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: COMMIT
[0m03:39:57.291044 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: COMMIT
[0m03:39:57.291812 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: COMMIT
[0m03:39:57.297884 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m03:39:57.301877 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: Close
[0m03:39:57.302872 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m03:39:57.306315 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m03:39:57.308342 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: Close
[0m03:39:57.309314 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C4BC090>]}
[0m03:39:57.310305 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: Close
[0m03:39:57.311223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0CC98D10>]}
[0m03:39:57.314510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36471117-7123-402c-b8b6-37bcd4ae5780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0C909CD0>]}
[0m03:39:57.312631 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 113[0m in 0.27s]
[0m03:39:57.315072 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 99[0m in 0.28s]
[0m03:39:57.318718 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m03:39:57.317278 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.28s]
[0m03:39:57.319833 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m03:39:57.322196 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m03:39:57.324977 [debug] [MainThread]: Using duckdb connection "master"
[0m03:39:57.324977 [debug] [MainThread]: On master: BEGIN
[0m03:39:57.325976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:39:57.326974 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m03:39:57.327967 [debug] [MainThread]: On master: COMMIT
[0m03:39:57.328934 [debug] [MainThread]: Using duckdb connection "master"
[0m03:39:57.329930 [debug] [MainThread]: On master: COMMIT
[0m03:39:57.330962 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:39:57.331937 [debug] [MainThread]: On master: Close
[0m03:39:57.332954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:39:57.333920 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m03:39:57.333920 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m03:39:57.334949 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_customers' was properly closed.
[0m03:39:57.336912 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_orders' was properly closed.
[0m03:39:57.336912 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_payments' was properly closed.
[0m03:39:57.338907 [info ] [MainThread]: 
[0m03:39:57.340904 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m03:39:57.344893 [debug] [MainThread]: Command end result
[0m03:39:57.393117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m03:39:57.398252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m03:39:57.408191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m03:39:57.409191 [info ] [MainThread]: 
[0m03:39:57.411184 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:39:57.413179 [info ] [MainThread]: 
[0m03:39:57.414175 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m03:39:57.416363 [debug] [MainThread]: Command `dbt seed` succeeded at 03:39:57.416363 after 2.35 seconds
[0m03:39:57.417363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0AFAD250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0A35D090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE0AEBB490>]}
[0m03:39:57.418356 [debug] [MainThread]: Flushing usage events
[0m03:39:58.363902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:04.338243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289660FF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289660EEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289660EFE10>]}


============================== 23:36:04.348756 | d576b1c6-e5ec-4252-97a7-d53b908e83e8 ==============================
[0m23:36:04.348756 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:36:04.351075 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select staging', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m23:36:04.982289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002896725D750>]}
[0m23:36:05.200830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289650F0290>]}
[0m23:36:05.214048 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:36:06.242950 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:36:09.520853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 9 files added, 0 files changed.
[0m23:36:09.524302 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\growth\repeat_purchase_rate.sql
[0m23:36:09.526296 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\finance\payments_summary.sql
[0m23:36:09.529693 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\finance\refunds_discounts.sql
[0m23:36:09.531688 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\growth\new_customers.sql
[0m23:36:09.534598 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\customer\top_customers.sql
[0m23:36:09.535593 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\customer\customer_segment.sql
[0m23:36:09.538931 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\growth\monthly_order_growth.sql
[0m23:36:09.541668 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\customer\customer_ltv.sql
[0m23:36:09.543671 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\marts\finance\monthly_revenue.sql
[0m23:36:10.162028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002896782F610>]}
[0m23:36:10.381761 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:36:10.386779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:36:10.497007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289678B5D50>]}
[0m23:36:10.499417 [info ] [MainThread]: Found 12 models, 3 seeds, 472 macros
[0m23:36:10.501480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289679245D0>]}
[0m23:36:10.505612 [info ] [MainThread]: 
[0m23:36:10.510809 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:10.515137 [info ] [MainThread]: 
[0m23:36:10.519665 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:10.536976 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m23:36:16.841258 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m23:36:16.841258 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m23:36:16.845102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:16.995154 [debug] [ThreadPool]: SQL status: OK in 0.150 seconds
[0m23:36:17.003067 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m23:36:17.005060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m23:36:17.007164 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m23:36:17.022721 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:17.022721 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m23:36:17.022721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:17.029166 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:17.031597 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:17.031597 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m23:36:17.036925 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:17.037918 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:17.038943 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m23:36:17.044243 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m23:36:17.046972 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:36:17.048006 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:17.049025 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:36:17.050776 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:17.052056 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m23:36:17.057322 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m23:36:17.071735 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:36:17.071735 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m23:36:17.071735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:17.077643 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:17.078838 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:36:17.080008 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m23:36:17.154110 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m23:36:17.157096 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m23:36:17.178993 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m23:36:17.179558 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m23:36:17.183129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967C05D10>]}
[0m23:36:17.184126 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:17.184686 [debug] [MainThread]: On master: BEGIN
[0m23:36:17.185862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:17.188001 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:36:17.189021 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.191066 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:17.191066 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.192513 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:17.193510 [debug] [MainThread]: On master: Close
[0m23:36:17.205796 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.stg_customers
[0m23:36:17.206794 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.stg_orders
[0m23:36:17.207792 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.stg_payments
[0m23:36:17.208790 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_customers ................................. [RUN]
[0m23:36:17.210732 [info ] [Thread-2 (]: 2 of 3 START sql view model main.stg_orders .................................... [RUN]
[0m23:36:17.213856 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_customers'
[0m23:36:17.211854 [info ] [Thread-3 (]: 3 of 3 START sql view model main.stg_payments .................................. [RUN]
[0m23:36:17.214846 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_orders'
[0m23:36:17.215844 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.stg_customers
[0m23:36:17.216841 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_payments'
[0m23:36:17.220478 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.stg_orders
[0m23:36:17.241807 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.stg_customers"
[0m23:36:17.242827 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.stg_payments
[0m23:36:17.253141 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.stg_orders"
[0m23:36:17.261757 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.stg_payments"
[0m23:36:17.265389 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.stg_customers
[0m23:36:17.266836 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.stg_orders
[0m23:36:17.267974 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.stg_payments
[0m23:36:17.361338 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.stg_orders"
[0m23:36:17.362334 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.stg_customers"
[0m23:36:17.376340 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.stg_payments"
[0m23:36:17.380044 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m23:36:17.381800 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m23:36:17.382429 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m23:36:17.383444 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: BEGIN
[0m23:36:17.384483 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: BEGIN
[0m23:36:17.388911 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: BEGIN
[0m23:36:17.390902 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:17.392207 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:17.393384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:17.395380 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m23:36:17.397394 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m23:36:17.399390 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:36:17.400622 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m23:36:17.401705 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m23:36:17.403977 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m23:36:17.407222 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

  
  create view "jaffle_dbt"."main"."stg_orders__dbt_tmp" as (
    with source as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from "jaffle_dbt"."main"."raw_orders"

)

select * from source
  );

[0m23:36:17.409120 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

  
  create view "jaffle_dbt"."main"."stg_payments__dbt_tmp" as (
    with source as (

    select
        id as payment_id,
        order_id,
        payment_method,
        amount
    from "jaffle_dbt"."main"."raw_payments"

)

select * from source
  );

[0m23:36:17.409849 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

  
  create view "jaffle_dbt"."main"."stg_customers__dbt_tmp" as (
    with source as (

    select
        id as customer_id,
        first_name,
        last_name
    from "jaffle_dbt"."main"."raw_customers"

)

select * from source
  );

[0m23:36:17.414009 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:36:17.415038 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m23:36:17.415038 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:17.440388 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m23:36:17.453835 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m23:36:17.464650 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m23:36:17.468755 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */
alter view "jaffle_dbt"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m23:36:17.470993 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */
alter view "jaffle_dbt"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m23:36:17.473638 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */
alter view "jaffle_dbt"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m23:36:17.478978 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m23:36:17.479798 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:17.481519 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m23:36:17.573511 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m23:36:17.573511 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m23:36:17.579065 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m23:36:17.560841 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m23:36:17.582061 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m23:36:17.582061 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m23:36:17.571207 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m23:36:17.593563 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m23:36:17.595400 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m23:36:17.596239 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m23:36:17.610817 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m23:36:17.618924 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m23:36:17.621066 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m23:36:17.622245 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

      drop view if exists "jaffle_dbt"."main"."stg_orders__dbt_backup" cascade
    
[0m23:36:17.629639 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m23:36:17.640787 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m23:36:17.643329 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

      drop view if exists "jaffle_dbt"."main"."stg_payments__dbt_backup" cascade
    
[0m23:36:17.645374 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:36:17.646983 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

      drop view if exists "jaffle_dbt"."main"."stg_customers__dbt_backup" cascade
    
[0m23:36:17.661383 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:17.653739 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: Close
[0m23:36:17.663294 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m23:36:17.663294 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: Close
[0m23:36:17.678884 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: Close
[0m23:36:17.681958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967CA9E50>]}
[0m23:36:17.683157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967C92B10>]}
[0m23:36:17.683157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd576b1c6-e5ec-4252-97a7-d53b908e83e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028967C93650>]}
[0m23:36:17.684764 [info ] [Thread-2 (]: 2 of 3 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.45s]
[0m23:36:17.692261 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.stg_orders
[0m23:36:17.686804 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.47s]
[0m23:36:17.695299 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.stg_customers
[0m23:36:17.688829 [info ] [Thread-3 (]: 3 of 3 OK created sql view model main.stg_payments ............................. [[32mOK[0m in 0.47s]
[0m23:36:17.697617 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.stg_payments
[0m23:36:17.701676 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:17.704357 [debug] [MainThread]: On master: BEGIN
[0m23:36:17.707145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:17.713247 [debug] [MainThread]: SQL status: OK in 0.007 seconds
[0m23:36:17.714244 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.715241 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:17.716239 [debug] [MainThread]: On master: COMMIT
[0m23:36:17.717454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:17.718452 [debug] [MainThread]: On master: Close
[0m23:36:17.719449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:17.722623 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m23:36:17.724692 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m23:36:17.726687 [debug] [MainThread]: Connection 'model.jaffle_dbt.stg_customers' was properly closed.
[0m23:36:17.727684 [debug] [MainThread]: Connection 'model.jaffle_dbt.stg_orders' was properly closed.
[0m23:36:17.729206 [debug] [MainThread]: Connection 'model.jaffle_dbt.stg_payments' was properly closed.
[0m23:36:17.731749 [info ] [MainThread]: 
[0m23:36:17.732996 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m23:36:17.735035 [debug] [MainThread]: Command end result
[0m23:36:17.806209 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:36:17.811515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:36:17.825318 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m23:36:17.826474 [info ] [MainThread]: 
[0m23:36:17.828622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:17.829780 [info ] [MainThread]: 
[0m23:36:17.830779 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m23:36:17.833567 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:17.833567 after 13.70 seconds
[0m23:36:17.834464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002896523D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895F4ECDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895F4DB690>]}
[0m23:36:17.835462 [debug] [MainThread]: Flushing usage events
[0m23:36:18.837416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:36:23.562731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23B6FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23B72A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23B72690>]}


============================== 23:36:23.570804 | 0684dc49-efa7-4da9-87c9-b2e040cae761 ==============================
[0m23:36:23.570804 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:36:23.573606 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select marts', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m23:36:24.071921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23BAFB50>]}
[0m23:36:24.213847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA203AD650>]}
[0m23:36:24.221100 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:36:24.715701 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:36:25.008947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:25.010947 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:36:25.011446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:25.128828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA250D4190>]}
[0m23:36:25.322151 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:36:25.326014 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:36:25.373834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA24D10E10>]}
[0m23:36:25.374833 [info ] [MainThread]: Found 12 models, 3 seeds, 472 macros
[0m23:36:25.376827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23BD0210>]}
[0m23:36:25.383808 [info ] [MainThread]: 
[0m23:36:25.384741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:25.387734 [info ] [MainThread]: 
[0m23:36:25.389077 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:25.406544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m23:36:25.629827 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m23:36:25.630819 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m23:36:25.633813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:25.689006 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m23:36:25.691509 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m23:36:25.692596 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m23:36:25.693626 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m23:36:25.701857 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:25.701857 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m23:36:25.709073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:25.711127 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:36:25.712955 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:25.714604 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m23:36:25.717600 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:25.718827 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:25.718827 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m23:36:25.721044 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:25.723103 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:36:25.725216 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:36:25.726247 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:36:25.727323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:25.728351 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m23:36:25.734273 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m23:36:25.740712 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:36:25.740712 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m23:36:25.745828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:25.748172 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:25.749915 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:36:25.751226 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m23:36:25.783372 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m23:36:25.786388 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m23:36:25.787961 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m23:36:25.788980 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m23:36:25.792233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25567150>]}
[0m23:36:25.793290 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:25.793290 [debug] [MainThread]: On master: BEGIN
[0m23:36:25.795034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:25.796275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:36:25.797273 [debug] [MainThread]: On master: COMMIT
[0m23:36:25.797438 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:25.798726 [debug] [MainThread]: On master: COMMIT
[0m23:36:25.800826 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:25.801855 [debug] [MainThread]: On master: Close
[0m23:36:25.810004 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.customer_ltv
[0m23:36:25.811002 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.customer_segment
[0m23:36:25.812000 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.monthly_order_growth
[0m23:36:25.813027 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.monthly_revenue
[0m23:36:25.814004 [info ] [Thread-1 (]: 1 of 9 START sql table model main.customer_ltv ................................. [RUN]
[0m23:36:25.815647 [info ] [Thread-2 (]: 2 of 9 START sql table model main.customer_segment ............................. [RUN]
[0m23:36:25.822503 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_dbt.customer_ltv'
[0m23:36:25.818597 [info ] [Thread-3 (]: 3 of 9 START sql table model main.monthly_order_growth ......................... [RUN]
[0m23:36:25.824861 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_dbt.customer_segment'
[0m23:36:25.827050 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.customer_ltv
[0m23:36:25.820599 [info ] [Thread-4 (]: 4 of 9 START sql table model main.monthly_revenue .............................. [RUN]
[0m23:36:25.829098 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_order_growth'
[0m23:36:25.830759 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.customer_segment
[0m23:36:25.855403 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.customer_ltv"
[0m23:36:25.857915 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_revenue'
[0m23:36:25.859908 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.monthly_order_growth
[0m23:36:25.871591 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.customer_segment"
[0m23:36:25.873718 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.monthly_revenue
[0m23:36:25.878907 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_order_growth"
[0m23:36:25.880965 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.customer_ltv
[0m23:36:25.890537 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_revenue"
[0m23:36:25.890537 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.customer_segment
[0m23:36:25.967213 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.monthly_order_growth
[0m23:36:25.961743 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.customer_ltv"
[0m23:36:25.978800 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.customer_segment"
[0m23:36:25.986565 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_order_growth"
[0m23:36:25.989274 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.monthly_revenue
[0m23:36:25.999147 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.002308 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:36:26.004835 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: BEGIN
[0m23:36:26.005833 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:36:26.006622 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:36:26.007652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:36:26.008618 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: BEGIN
[0m23:36:26.010613 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: BEGIN
[0m23:36:26.011611 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.014700 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:26.016273 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m23:36:26.017835 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:26.018874 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: BEGIN
[0m23:36:26.021250 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:36:26.022247 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m23:36:26.023047 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:36:26.024043 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m23:36:26.025769 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_ltv__dbt_tmp"
  
    as (
      --Lifetime value per customer



select
    o.customer_id,
    sum(p.amount) as lifetime_value
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by lifetime_value desc
    );
  
  
[0m23:36:26.026766 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:36:26.028910 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:36:26.029992 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m23:36:26.031866 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_segment__dbt_tmp"
  
    as (
      --Segmentation (e.g., high/medium/low)



with customer_spend as (
    select
        o.customer_id,
        sum(p.amount) as total_spent
    from "jaffle_dbt"."main"."stg_orders" o
    join "jaffle_dbt"."main"."stg_payments" p
        on o.order_id = p.order_id
    group by 1
)

select
    customer_id,
    total_spent,
    case
        when total_spent >= 5000 then 'high_value'
        when total_spent >= 2000 then 'medium_value'
        else 'low_value'
    end as customer_segment
from customer_spend
    );
  
  
[0m23:36:26.035137 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp"
  
    as (
      --Orders per month



select
    date_trunc('month', order_date) as month,
    count(*) as total_orders
from "jaffle_dbt"."main"."stg_orders"
group by 1
order by 1
    );
  
  
[0m23:36:26.036133 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.040832 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_revenue__dbt_tmp"
  
    as (
      --Total revenue per month



select
    date_trunc('month', o.order_date) as month,
    sum(p.amount) as revenue
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by 1
    );
  
  
[0m23:36:26.065163 [debug] [Thread-3 (]: SQL status: OK in 0.026 seconds
[0m23:36:26.079637 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:36:26.080508 [debug] [Thread-4 (]: SQL status: OK in 0.038 seconds
[0m23:36:26.081481 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m23:36:26.082821 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m23:36:26.084566 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp" rename to "monthly_order_growth"
[0m23:36:26.093734 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.100054 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:36:26.109215 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:36:26.110722 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue__dbt_tmp" rename to "monthly_revenue"
[0m23:36:26.112549 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:36:26.113590 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment__dbt_tmp" rename to "customer_segment"
[0m23:36:26.114588 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m23:36:26.135810 [debug] [Thread-4 (]: SQL status: OK in 0.020 seconds
[0m23:36:26.141461 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m23:36:26.148951 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:36:26.151291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:26.156127 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m23:36:26.157125 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:36:26.162156 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m23:36:26.165571 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m23:36:26.166998 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.169733 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m23:36:26.171389 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:36:26.173111 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:36:26.174605 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m23:36:26.176599 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m23:36:26.177906 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m23:36:26.180707 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m23:36:26.182709 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m23:36:26.198811 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m23:36:26.206054 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:36:26.206054 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m23:36:26.192256 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:36:26.219032 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

      drop table if exists "jaffle_dbt"."main"."monthly_revenue__dbt_backup" cascade
    
[0m23:36:26.222712 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:36:26.224945 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:36:26.224945 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

      drop table if exists "jaffle_dbt"."main"."monthly_order_growth__dbt_backup" cascade
    
[0m23:36:26.230984 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

      drop table if exists "jaffle_dbt"."main"."customer_segment__dbt_backup" cascade
    
[0m23:36:26.231026 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:36:26.233151 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

      drop table if exists "jaffle_dbt"."main"."customer_ltv__dbt_backup" cascade
    
[0m23:36:26.236011 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:36:26.242024 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: Close
[0m23:36:26.243941 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m23:36:26.246909 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: Close
[0m23:36:26.248295 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:36:26.255963 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: Close
[0m23:36:26.257401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25670DD0>]}
[0m23:36:26.258939 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25639E10>]}
[0m23:36:26.261090 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: Close
[0m23:36:26.262652 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA255A7D50>]}
[0m23:36:26.270858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA255AD9D0>]}
[0m23:36:26.264770 [info ] [Thread-4 (]: 4 of 9 OK created sql table model main.monthly_revenue ......................... [[32mOK[0m in 0.39s]
[0m23:36:26.279680 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.monthly_revenue
[0m23:36:26.280976 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.new_customers
[0m23:36:26.266982 [info ] [Thread-3 (]: 3 of 9 OK created sql table model main.monthly_order_growth .................... [[32mOK[0m in 0.43s]
[0m23:36:26.296729 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.monthly_order_growth
[0m23:36:26.299537 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.payments_summary
[0m23:36:26.273906 [info ] [Thread-2 (]: 2 of 9 OK created sql table model main.customer_segment ........................ [[32mOK[0m in 0.44s]
[0m23:36:26.310222 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.customer_segment
[0m23:36:26.313997 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.refunds_discounts
[0m23:36:26.276034 [info ] [Thread-1 (]: 1 of 9 OK created sql table model main.customer_ltv ............................ [[32mOK[0m in 0.45s]
[0m23:36:26.320177 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.customer_ltv
[0m23:36:26.323855 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.repeat_purchase_rate
[0m23:36:26.283382 [info ] [Thread-4 (]: 5 of 9 START sql table model main.new_customers ................................ [RUN]
[0m23:36:26.329887 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_revenue, now model.jaffle_dbt.new_customers)
[0m23:36:26.303786 [info ] [Thread-3 (]: 6 of 9 START sql table model main.payments_summary ............................. [RUN]
[0m23:36:26.331929 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.new_customers
[0m23:36:26.334311 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_order_growth, now model.jaffle_dbt.payments_summary)
[0m23:36:26.344751 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.new_customers"
[0m23:36:26.316002 [info ] [Thread-2 (]: 7 of 9 START sql table model main.refunds_discounts ............................ [RUN]
[0m23:36:26.348788 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.payments_summary
[0m23:36:26.327350 [info ] [Thread-1 (]: 8 of 9 START sql table model main.repeat_purchase_rate ......................... [RUN]
[0m23:36:26.358493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_segment, now model.jaffle_dbt.refunds_discounts)
[0m23:36:26.385403 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.refunds_discounts
[0m23:36:26.372864 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.new_customers
[0m23:36:26.382829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_ltv, now model.jaffle_dbt.repeat_purchase_rate)
[0m23:36:26.375188 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.payments_summary"
[0m23:36:26.397904 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.406103 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.repeat_purchase_rate
[0m23:36:26.410914 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.new_customers"
[0m23:36:26.413650 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.payments_summary
[0m23:36:26.424957 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.424957 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.refunds_discounts
[0m23:36:26.437629 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.payments_summary"
[0m23:36:26.439906 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:36:26.492181 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: BEGIN
[0m23:36:26.493179 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.repeat_purchase_rate
[0m23:36:26.494919 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:26.523921 [debug] [Thread-4 (]: SQL status: OK in 0.031 seconds
[0m23:36:26.523921 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:36:26.496928 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:36:26.491101 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.523921 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.530593 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."new_customers__dbt_tmp"
  
    as (
      --New customer acquisition



with first_orders as (
    select
        customer_id,
        min(order_date) as first_order_date
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    date_trunc('month', first_order_date) as month,
    count(customer_id) as new_customers
from first_orders
group by 1
order by 1
    );
  
  
[0m23:36:26.530593 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: BEGIN
[0m23:36:26.539793 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.542084 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.543630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:26.546087 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: BEGIN
[0m23:36:26.547694 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m23:36:26.548690 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: BEGIN
[0m23:36:26.551023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:26.555014 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m23:36:26.561489 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:36:26.563541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:26.565307 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:36:26.566300 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m23:36:26.566901 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers__dbt_tmp" rename to "new_customers"
[0m23:36:26.571173 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."payments_summary__dbt_tmp"
  
    as (
      --Summary by payment method
│


select
    payment_method,
    count(*) as payment_count,
    sum(amount) as total_amount
from "jaffle_dbt"."main"."stg_payments"
group by 1
order by total_amount desc
    );
  
  
[0m23:36:26.572471 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:36:26.573468 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.591001 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."payments_summary__dbt_tmp"
  
    as (
      --Summary by payment method
│


select
    payment_method,
    count(*) as payment_count,
    sum(amount) as total_amount
from "jaffle_dbt"."main"."stg_payments"
group by 1
order by total_amount desc
    );
  
  
[0m23:36:26.592012 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m23:36:26.592012 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.593679 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."refunds_discounts__dbt_tmp"
  
    as (
      --Refunds, discounts per month


select
    payment_method,
    sum(case when amount = 0 then 1 else 0 end) as zero_amount_payments
from "jaffle_dbt"."main"."stg_payments"
group by 1
    );
  
  
[0m23:36:26.594929 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m23:36:26.596920 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m23:36:26.598938 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp"
  
    as (
      --% of returning customers



with customer_orders as (
    select
        customer_id,
        count(*) as order_count
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    count(case when order_count > 1 then 1 end) * 1.0
        / count(*) as repeat_purchase_rate
from customer_orders
    );
  
  
[0m23:36:26.601070 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: ROLLBACK
[0m23:36:26.605983 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:36:26.610226 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m23:36:26.612720 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m23:36:26.621970 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.621970 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m23:36:26.624613 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts__dbt_tmp" rename to "refunds_discounts"
[0m23:36:26.631555 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.632895 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m23:36:26.634008 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp" rename to "repeat_purchase_rate"
[0m23:36:26.638903 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m23:36:26.643870 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:36:26.649643 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m23:36:26.650634 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:36:26.654625 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

      drop table if exists "jaffle_dbt"."main"."new_customers__dbt_backup" cascade
    
[0m23:36:26.656555 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.659609 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m23:36:26.662448 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m23:36:26.663634 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:36:26.664614 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.672524 [debug] [Thread-4 (]: On model.jaffle_dbt.new_customers: Close
[0m23:36:26.673915 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m23:36:26.674943 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m23:36:26.677047 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25568510>]}
[0m23:36:26.682027 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:36:26.692679 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

      drop table if exists "jaffle_dbt"."main"."refunds_discounts__dbt_backup" cascade
    
[0m23:36:26.690095 [info ] [Thread-4 (]: 5 of 9 OK created sql table model main.new_customers ........................... [[32mOK[0m in 0.35s]
[0m23:36:26.694201 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m23:36:26.696367 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.new_customers
[0m23:36:26.697742 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:36:26.710664 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:36:26.712291 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.top_customers
[0m23:36:26.715744 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: Close
[0m23:36:26.718481 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

      drop table if exists "jaffle_dbt"."main"."repeat_purchase_rate__dbt_backup" cascade
    
[0m23:36:26.726096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA210E7C50>]}
[0m23:36:26.724239 [info ] [Thread-4 (]: 9 of 9 START sql table model main.top_customers ................................ [RUN]
[0m23:36:26.728823 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:36:26.728291 [info ] [Thread-2 (]: 7 of 9 OK created sql table model main.refunds_discounts ....................... [[32mOK[0m in 0.37s]
[0m23:36:26.730871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.new_customers, now model.jaffle_dbt.top_customers)
[0m23:36:26.733863 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: Close
[0m23:36:26.739836 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.refunds_discounts
[0m23:36:26.740601 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.top_customers
[0m23:36:26.744308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25520750>]}
[0m23:36:26.759759 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.top_customers"
[0m23:36:26.763551 [info ] [Thread-1 (]: 8 of 9 OK created sql table model main.repeat_purchase_rate .................... [[32mOK[0m in 0.36s]
[0m23:36:26.766377 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.repeat_purchase_rate
[0m23:36:26.768440 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.top_customers
[0m23:36:26.781115 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.top_customers"
[0m23:36:26.785330 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:36:26.790596 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: BEGIN
[0m23:36:26.793457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:26.798884 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m23:36:26.800946 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:36:26.809377 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."top_customers__dbt_tmp"
  
    as (
      --Top spenders



select
    customer_id,
    sum(amount) as total_spent
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by total_spent desc
limit 10
    );
  
  
[0m23:36:26.825005 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m23:36:26.830489 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:36:26.840798 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers__dbt_tmp" rename to "top_customers"
[0m23:36:26.843164 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:36:26.844162 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m23:36:26.850649 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:36:26.851647 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m23:36:26.860012 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m23:36:26.873840 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:36:26.874840 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

      drop table if exists "jaffle_dbt"."main"."top_customers__dbt_backup" cascade
    
[0m23:36:26.877939 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:36:26.881240 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: Close
[0m23:36:26.883263 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2552FE10>]}
[0m23:36:26.889873 [info ] [Thread-4 (]: 9 of 9 OK created sql table model main.top_customers ........................... [[32mOK[0m in 0.15s]
[0m23:36:26.893244 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.top_customers
[0m23:36:26.983074 [debug] [Thread-3 (]: Failed to rollback 'model.jaffle_dbt.payments_summary'
[0m23:36:26.983074 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: Close
[0m23:36:26.996104 [debug] [Thread-3 (]: Runtime Error in model payments_summary (models\marts\finance\payments_summary.sql)
  Parser Error: syntax error at or near "│"
  
  LINE 12: │
           ^
[0m23:36:26.997136 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0684dc49-efa7-4da9-87c9-b2e040cae761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA256CC990>]}
[0m23:36:27.000129 [error] [Thread-3 (]: 6 of 9 ERROR creating sql table model main.payments_summary .................... [[31mERROR[0m in 0.66s]
[0m23:36:27.002167 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.payments_summary
[0m23:36:27.006754 [debug] [Thread-7 (]: Marking all children of 'model.jaffle_dbt.payments_summary' to be skipped because of status 'error'.  Reason: Runtime Error in model payments_summary (models\marts\finance\payments_summary.sql)
  Parser Error: syntax error at or near "│"
  
  LINE 12: │
           ^.
[0m23:36:27.010638 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:27.012634 [debug] [MainThread]: On master: BEGIN
[0m23:36:27.013144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:27.014612 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:36:27.015612 [debug] [MainThread]: On master: COMMIT
[0m23:36:27.017155 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:27.018153 [debug] [MainThread]: On master: COMMIT
[0m23:36:27.019712 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:27.023700 [debug] [MainThread]: On master: Close
[0m23:36:27.026285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:27.027263 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m23:36:27.028871 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m23:36:27.029790 [debug] [MainThread]: Connection 'model.jaffle_dbt.repeat_purchase_rate' was properly closed.
[0m23:36:27.030803 [debug] [MainThread]: Connection 'model.jaffle_dbt.refunds_discounts' was properly closed.
[0m23:36:27.031265 [debug] [MainThread]: Connection 'model.jaffle_dbt.payments_summary' was properly closed.
[0m23:36:27.032851 [debug] [MainThread]: Connection 'model.jaffle_dbt.top_customers' was properly closed.
[0m23:36:27.033881 [info ] [MainThread]: 
[0m23:36:27.034694 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m23:36:27.047369 [debug] [MainThread]: Command end result
[0m23:36:27.133532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:36:27.140005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:36:27.155132 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m23:36:27.156129 [info ] [MainThread]: 
[0m23:36:27.157636 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:36:27.158915 [info ] [MainThread]: 
[0m23:36:27.160906 [error] [MainThread]: [31mFailure in model payments_summary (models\marts\finance\payments_summary.sql)[0m
[0m23:36:27.162903 [error] [MainThread]:   Runtime Error in model payments_summary (models\marts\finance\payments_summary.sql)
  Parser Error: syntax error at or near "│"
  
  LINE 12: │
           ^
[0m23:36:27.165398 [info ] [MainThread]: 
[0m23:36:27.167803 [info ] [MainThread]:   compiled code at target\compiled\jaffle_dbt\models\marts\finance\payments_summary.sql
[0m23:36:27.172049 [info ] [MainThread]: 
[0m23:36:27.173047 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=9
[0m23:36:27.177795 [debug] [MainThread]: Command `dbt run` failed at 23:36:27.177795 after 3.77 seconds
[0m23:36:27.182156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23B0C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA23B0C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA22BB3590>]}
[0m23:36:27.183154 [debug] [MainThread]: Flushing usage events
[0m23:36:28.405439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:38:26.668254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C9A52990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C99DFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C99DFE10>]}


============================== 23:38:26.676919 | 323497a8-1fc2-4c8f-961f-fa3cebb8b574 ==============================
[0m23:38:26.676919 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:38:26.679791 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select marts', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m23:38:27.161511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CAC75650>]}
[0m23:38:27.261534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C624DA50>]}
[0m23:38:27.271743 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m23:38:27.720553 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:38:27.931627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:38:27.937168 [debug] [MainThread]: Partial parsing: updated file: jaffle_dbt://models\marts\finance\payments_summary.sql
[0m23:38:28.331681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CAC15F10>]}
[0m23:38:28.521444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:38:28.525257 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:38:28.572993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB1A8250>]}
[0m23:38:28.574020 [info ] [MainThread]: Found 12 models, 3 seeds, 472 macros
[0m23:38:28.576340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB098750>]}
[0m23:38:28.579278 [info ] [MainThread]: 
[0m23:38:28.580778 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:38:28.583124 [info ] [MainThread]: 
[0m23:38:28.585044 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:38:28.601723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m23:38:28.738700 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m23:38:28.739251 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m23:38:28.739831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:28.787688 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m23:38:28.789729 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m23:38:28.791522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m23:38:28.792520 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m23:38:28.801483 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:38:28.802964 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m23:38:28.803961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:38:28.805949 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:38:28.807727 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:38:28.809268 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m23:38:28.810633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:28.811631 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:38:28.811784 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m23:38:28.813781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:28.814780 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:38:28.816418 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m23:38:28.816418 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m23:38:28.818001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:38:28.818999 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m23:38:28.822634 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m23:38:28.830872 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:38:28.832389 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m23:38:28.832389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:38:28.833992 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:38:28.835020 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m23:38:28.836115 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m23:38:28.861142 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m23:38:28.863170 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m23:38:28.863170 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m23:38:28.863170 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m23:38:28.871692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CAEFDD50>]}
[0m23:38:28.872865 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:28.872865 [debug] [MainThread]: On master: BEGIN
[0m23:38:28.873863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:38:28.875592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:38:28.876527 [debug] [MainThread]: On master: COMMIT
[0m23:38:28.876527 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:28.878015 [debug] [MainThread]: On master: COMMIT
[0m23:38:28.879171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:38:28.879688 [debug] [MainThread]: On master: Close
[0m23:38:28.887471 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.customer_ltv
[0m23:38:28.888447 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.customer_segment
[0m23:38:28.889477 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.monthly_order_growth
[0m23:38:28.889477 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.monthly_revenue
[0m23:38:28.891014 [info ] [Thread-1 (]: 1 of 9 START sql table model main.customer_ltv ................................. [RUN]
[0m23:38:28.892855 [info ] [Thread-2 (]: 2 of 9 START sql table model main.customer_segment ............................. [RUN]
[0m23:38:28.893960 [info ] [Thread-3 (]: 3 of 9 START sql table model main.monthly_order_growth ......................... [RUN]
[0m23:38:28.896984 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_dbt.customer_ltv'
[0m23:38:28.895011 [info ] [Thread-4 (]: 4 of 9 START sql table model main.monthly_revenue .............................. [RUN]
[0m23:38:28.899977 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_dbt.customer_segment'
[0m23:38:28.901006 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_order_growth'
[0m23:38:28.902561 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.customer_ltv
[0m23:38:28.904208 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_revenue'
[0m23:38:28.905475 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.customer_segment
[0m23:38:28.906541 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.monthly_order_growth
[0m23:38:28.915742 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.monthly_revenue
[0m23:38:28.929422 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.customer_ltv"
[0m23:38:28.939847 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.customer_segment"
[0m23:38:28.941876 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_order_growth"
[0m23:38:28.950969 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_revenue"
[0m23:38:28.954442 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.customer_ltv
[0m23:38:28.955789 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.customer_segment
[0m23:38:28.956787 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.monthly_order_growth
[0m23:38:29.001626 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.customer_ltv"
[0m23:38:29.014091 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.customer_segment"
[0m23:38:29.014091 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.monthly_revenue
[0m23:38:29.021908 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.030769 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.030769 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.034712 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.036706 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.037495 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: BEGIN
[0m23:38:29.039041 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: BEGIN
[0m23:38:29.039553 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.040546 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: BEGIN
[0m23:38:29.041544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:38:29.043204 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:38:29.044416 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: BEGIN
[0m23:38:29.045414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:38:29.046468 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.048463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:38:29.049462 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.051385 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.052126 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m23:38:29.053467 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.054497 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.055463 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_ltv__dbt_tmp"
  
    as (
      --Lifetime value per customer



select
    o.customer_id,
    sum(p.amount) as lifetime_value
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by lifetime_value desc
    );
  
  
[0m23:38:29.056391 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.057643 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.058641 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_segment__dbt_tmp"
  
    as (
      --Segmentation (e.g., high/medium/low)



with customer_spend as (
    select
        o.customer_id,
        sum(p.amount) as total_spent
    from "jaffle_dbt"."main"."stg_orders" o
    join "jaffle_dbt"."main"."stg_payments" p
        on o.order_id = p.order_id
    group by 1
)

select
    customer_id,
    total_spent,
    case
        when total_spent >= 5000 then 'high_value'
        when total_spent >= 2000 then 'medium_value'
        else 'low_value'
    end as customer_segment
from customer_spend
    );
  
  
[0m23:38:29.060636 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp"
  
    as (
      --Orders per month



select
    date_trunc('month', order_date) as month,
    count(*) as total_orders
from "jaffle_dbt"."main"."stg_orders"
group by 1
order by 1
    );
  
  
[0m23:38:29.061634 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_revenue__dbt_tmp"
  
    as (
      --Total revenue per month



select
    date_trunc('month', o.order_date) as month,
    sum(p.amount) as revenue
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by 1
    );
  
  
[0m23:38:29.067200 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m23:38:29.068328 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m23:38:29.072601 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.079226 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m23:38:29.080735 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m23:38:29.083797 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.085020 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_order_growth'
  
[0m23:38:29.088567 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.090589 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.092237 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_ltv'
  
[0m23:38:29.093235 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_segment'
  
[0m23:38:29.094385 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.095456 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_revenue'
  
[0m23:38:29.099657 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.100722 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.101718 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.103851 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_order_growth'
  
[0m23:38:29.104710 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.106706 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.108642 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.112154 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.113116 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m23:38:29.113116 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_ltv'
  
[0m23:38:29.114614 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_segment'
  
[0m23:38:29.116609 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_revenue'
  
[0m23:38:29.130613 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.133727 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth" rename to "monthly_order_growth__dbt_backup"
[0m23:38:29.134724 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.135998 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.137027 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.141221 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.141221 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.151066 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.154088 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.157813 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue" rename to "monthly_revenue__dbt_backup"
[0m23:38:29.161857 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.165218 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m23:38:29.166332 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment" rename to "customer_segment__dbt_backup"
[0m23:38:29.169282 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp" rename to "monthly_order_growth"
[0m23:38:29.169798 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.172057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.173055 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.174052 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.174052 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.185768 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.191887 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.191887 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue__dbt_tmp" rename to "monthly_revenue"
[0m23:38:29.223061 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m23:38:29.225206 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m23:38:29.226557 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment__dbt_tmp" rename to "customer_segment"
[0m23:38:29.228554 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.230924 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.234284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.235282 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.240705 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m23:38:29.242560 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m23:38:29.247257 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m23:38:29.253238 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m23:38:29.254236 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.256229 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.263418 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.264436 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m23:38:29.265598 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m23:38:29.267921 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m23:38:29.268919 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m23:38:29.283758 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m23:38:29.285831 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m23:38:29.286921 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m23:38:29.287786 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m23:38:29.287786 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

      drop table if exists "jaffle_dbt"."main"."monthly_order_growth__dbt_backup" cascade
    
[0m23:38:29.291718 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m23:38:29.291718 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m23:38:29.303693 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m23:38:29.304922 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

      drop table if exists "jaffle_dbt"."main"."customer_ltv__dbt_backup" cascade
    
[0m23:38:29.305917 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.307149 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

      drop table if exists "jaffle_dbt"."main"."monthly_revenue__dbt_backup" cascade
    
[0m23:38:29.307911 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

      drop table if exists "jaffle_dbt"."main"."customer_segment__dbt_backup" cascade
    
[0m23:38:29.311902 [debug] [Thread-3 (]: On model.jaffle_dbt.monthly_order_growth: Close
[0m23:38:29.314104 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.319969 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.321072 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.323179 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: Close
[0m23:38:29.324807 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB4ADC50>]}
[0m23:38:29.325667 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: Close
[0m23:38:29.329445 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_segment: Close
[0m23:38:29.330950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB5A09D0>]}
[0m23:38:29.334158 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB48BC90>]}
[0m23:38:29.332162 [info ] [Thread-3 (]: 3 of 9 OK created sql table model main.monthly_order_growth .................... [[32mOK[0m in 0.42s]
[0m23:38:29.337538 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB59E650>]}
[0m23:38:29.338537 [info ] [Thread-1 (]: 1 of 9 OK created sql table model main.customer_ltv ............................ [[32mOK[0m in 0.43s]
[0m23:38:29.342073 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.monthly_order_growth
[0m23:38:29.351394 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.new_customers
[0m23:38:29.345227 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.customer_ltv
[0m23:38:29.340095 [info ] [Thread-4 (]: 4 of 9 OK created sql table model main.monthly_revenue ......................... [[32mOK[0m in 0.43s]
[0m23:38:29.344226 [info ] [Thread-2 (]: 2 of 9 OK created sql table model main.customer_segment ........................ [[32mOK[0m in 0.44s]
[0m23:38:29.357103 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.payments_summary
[0m23:38:29.355110 [info ] [Thread-3 (]: 5 of 9 START sql table model main.new_customers ................................ [RUN]
[0m23:38:29.367714 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_order_growth, now model.jaffle_dbt.new_customers)
[0m23:38:29.359962 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.monthly_revenue
[0m23:38:29.369764 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.new_customers
[0m23:38:29.361855 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.customer_segment
[0m23:38:29.372615 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.refunds_discounts
[0m23:38:29.383450 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.new_customers"
[0m23:38:29.363850 [info ] [Thread-1 (]: 6 of 9 START sql table model main.payments_summary ............................. [RUN]
[0m23:38:29.386827 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.repeat_purchase_rate
[0m23:38:29.391349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_ltv, now model.jaffle_dbt.payments_summary)
[0m23:38:29.394102 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.new_customers
[0m23:38:29.388821 [info ] [Thread-4 (]: 7 of 9 START sql table model main.refunds_discounts ............................ [RUN]
[0m23:38:29.396479 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.payments_summary
[0m23:38:29.394102 [info ] [Thread-2 (]: 8 of 9 START sql table model main.repeat_purchase_rate ......................... [RUN]
[0m23:38:29.406725 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.new_customers"
[0m23:38:29.408682 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_revenue, now model.jaffle_dbt.refunds_discounts)
[0m23:38:29.412925 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.payments_summary"
[0m23:38:29.416760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_segment, now model.jaffle_dbt.repeat_purchase_rate)
[0m23:38:29.421107 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.423093 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.refunds_discounts
[0m23:38:29.425525 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.repeat_purchase_rate
[0m23:38:29.427729 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.payments_summary
[0m23:38:29.428760 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: BEGIN
[0m23:38:29.437981 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.441741 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.454683 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.payments_summary"
[0m23:38:29.457828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:38:29.458825 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.refunds_discounts
[0m23:38:29.461078 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.repeat_purchase_rate
[0m23:38:29.463073 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:38:29.464686 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m23:38:29.471809 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.480779 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.482207 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: BEGIN
[0m23:38:29.484528 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.488518 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.489391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:29.490896 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.491925 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."new_customers__dbt_tmp"
  
    as (
      --New customer acquisition



with first_orders as (
    select
        customer_id,
        min(order_date) as first_order_date
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    date_trunc('month', first_order_date) as month,
    count(customer_id) as new_customers
from first_orders
group by 1
order by 1
    );
  
  
[0m23:38:29.492891 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: BEGIN
[0m23:38:29.494886 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: BEGIN
[0m23:38:29.494886 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.496524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:38:29.498518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:38:29.500776 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:38:29.501833 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.504007 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m23:38:29.505320 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m23:38:29.506738 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."payments_summary__dbt_tmp"
  
    as (
      

select
    payment_method,
    count(*) as payment_count,
    sum(amount) as total_amount
from "jaffle_dbt"."main"."stg_payments"
group by payment_method
order by total_amount desc
    );
  
  
[0m23:38:29.507767 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.509034 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.510540 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.511560 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'new_customers'
  
[0m23:38:29.513258 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."refunds_discounts__dbt_tmp"
  
    as (
      --Refunds, discounts per month


select
    payment_method,
    sum(case when amount = 0 then 1 else 0 end) as zero_amount_payments
from "jaffle_dbt"."main"."stg_payments"
group by 1
    );
  
  
[0m23:38:29.515251 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp"
  
    as (
      --% of returning customers



with customer_orders as (
    select
        customer_id,
        count(*) as order_count
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    count(case when order_count > 1 then 1 end) * 1.0
        / count(*) as repeat_purchase_rate
from customer_orders
    );
  
  
[0m23:38:29.517375 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.524474 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:38:29.527130 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m23:38:29.528041 [debug] [Thread-4 (]: SQL status: OK in 0.010 seconds
[0m23:38:29.529035 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m23:38:29.529054 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */
alter table "jaffle_dbt"."main"."payments_summary__dbt_tmp" rename to "payments_summary"
[0m23:38:29.531332 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.534801 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.536828 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.539080 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'new_customers'
  
[0m23:38:29.539614 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.540613 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'refunds_discounts'
  
[0m23:38:29.541768 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'repeat_purchase_rate'
  
[0m23:38:29.546250 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m23:38:29.546741 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.548976 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:38:29.550484 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m23:38:29.551480 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m23:38:29.555554 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.558531 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m23:38:29.561059 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.563073 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.564144 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers" rename to "new_customers__dbt_backup"
[0m23:38:29.565142 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'refunds_discounts'
  
[0m23:38:29.567203 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'repeat_purchase_rate'
  
[0m23:38:29.569209 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.571195 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.573189 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.574187 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.579795 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m23:38:29.587199 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.591606 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.599667 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.600664 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

      drop table if exists "jaffle_dbt"."main"."payments_summary__dbt_backup" cascade
    
[0m23:38:29.602708 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers__dbt_tmp" rename to "new_customers"
[0m23:38:29.603501 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts" rename to "refunds_discounts__dbt_backup"
[0m23:38:29.604498 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate" rename to "repeat_purchase_rate__dbt_backup"
[0m23:38:29.606668 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.607743 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.609841 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.610699 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.612727 [debug] [Thread-1 (]: On model.jaffle_dbt.payments_summary: Close
[0m23:38:29.614772 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m23:38:29.624815 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.629770 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.631222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CC616050>]}
[0m23:38:29.631797 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.633763 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts__dbt_tmp" rename to "refunds_discounts"
[0m23:38:29.635013 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp" rename to "repeat_purchase_rate"
[0m23:38:29.637960 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m23:38:29.636962 [info ] [Thread-1 (]: 6 of 9 OK created sql table model main.payments_summary ........................ [[32mOK[0m in 0.24s]
[0m23:38:29.640880 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.641854 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.643664 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.payments_summary
[0m23:38:29.645676 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m23:38:29.650836 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m23:38:29.651991 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m23:38:29.653987 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.top_customers
[0m23:38:29.655197 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.656196 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.661038 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m23:38:29.664396 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m23:38:29.663399 [info ] [Thread-1 (]: 9 of 9 START sql table model main.top_customers ................................ [RUN]
[0m23:38:29.666274 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m23:38:29.668853 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

      drop table if exists "jaffle_dbt"."main"."new_customers__dbt_backup" cascade
    
[0m23:38:29.671912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.payments_summary, now model.jaffle_dbt.top_customers)
[0m23:38:29.674319 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.top_customers
[0m23:38:29.675381 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.682672 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.top_customers"
[0m23:38:29.684359 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m23:38:29.691624 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m23:38:29.691624 [debug] [Thread-3 (]: SQL status: OK in 0.019 seconds
[0m23:38:29.699981 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m23:38:29.702380 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

      drop table if exists "jaffle_dbt"."main"."refunds_discounts__dbt_backup" cascade
    
[0m23:38:29.704498 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.top_customers
[0m23:38:29.707607 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: Close
[0m23:38:29.708864 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

      drop table if exists "jaffle_dbt"."main"."repeat_purchase_rate__dbt_backup" cascade
    
[0m23:38:29.711194 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.top_customers"
[0m23:38:29.717271 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB5137D0>]}
[0m23:38:29.718375 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m23:38:29.720895 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.723660 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m23:38:29.723040 [info ] [Thread-3 (]: 5 of 9 OK created sql table model main.new_customers ........................... [[32mOK[0m in 0.35s]
[0m23:38:29.726853 [debug] [Thread-4 (]: On model.jaffle_dbt.refunds_discounts: Close
[0m23:38:29.728171 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: BEGIN
[0m23:38:29.730875 [debug] [Thread-2 (]: On model.jaffle_dbt.repeat_purchase_rate: Close
[0m23:38:29.731718 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.new_customers
[0m23:38:29.734461 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB194450>]}
[0m23:38:29.735642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:38:29.737741 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB0E89D0>]}
[0m23:38:29.739782 [info ] [Thread-4 (]: 7 of 9 OK created sql table model main.refunds_discounts ....................... [[32mOK[0m in 0.33s]
[0m23:38:29.741818 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.745565 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.refunds_discounts
[0m23:38:29.743560 [info ] [Thread-2 (]: 8 of 9 OK created sql table model main.repeat_purchase_rate .................... [[32mOK[0m in 0.32s]
[0m23:38:29.747699 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.749949 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.repeat_purchase_rate
[0m23:38:29.751948 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."top_customers__dbt_tmp"
  
    as (
      --Top spenders



select
    customer_id,
    sum(amount) as total_spent
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by total_spent desc
limit 10
    );
  
  
[0m23:38:29.759689 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m23:38:29.764764 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.766249 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'top_customers'
  
[0m23:38:29.773717 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m23:38:29.773717 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.781376 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'top_customers'
  
[0m23:38:29.785425 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.791157 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.794314 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers" rename to "top_customers__dbt_backup"
[0m23:38:29.795500 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.804131 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.805261 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers__dbt_tmp" rename to "top_customers"
[0m23:38:29.807260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:38:29.811180 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m23:38:29.811946 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.812982 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m23:38:29.821989 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m23:38:29.822986 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m23:38:29.828907 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

      drop table if exists "jaffle_dbt"."main"."top_customers__dbt_backup" cascade
    
[0m23:38:29.831968 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m23:38:29.835023 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: Close
[0m23:38:29.836887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323497a8-1fc2-4c8f-961f-fa3cebb8b574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3CB4977D0>]}
[0m23:38:29.838881 [info ] [Thread-1 (]: 9 of 9 OK created sql table model main.top_customers ........................... [[32mOK[0m in 0.17s]
[0m23:38:29.840944 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.top_customers
[0m23:38:29.843047 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:29.844073 [debug] [MainThread]: On master: BEGIN
[0m23:38:29.844073 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:38:29.846536 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:38:29.847530 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.847530 [debug] [MainThread]: Using duckdb connection "master"
[0m23:38:29.848867 [debug] [MainThread]: On master: COMMIT
[0m23:38:29.850099 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:38:29.850856 [debug] [MainThread]: On master: Close
[0m23:38:29.851856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:38:29.855606 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m23:38:29.856632 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m23:38:29.858124 [debug] [MainThread]: Connection 'model.jaffle_dbt.top_customers' was properly closed.
[0m23:38:29.859045 [debug] [MainThread]: Connection 'model.jaffle_dbt.repeat_purchase_rate' was properly closed.
[0m23:38:29.860084 [debug] [MainThread]: Connection 'model.jaffle_dbt.new_customers' was properly closed.
[0m23:38:29.860084 [debug] [MainThread]: Connection 'model.jaffle_dbt.refunds_discounts' was properly closed.
[0m23:38:29.862076 [info ] [MainThread]: 
[0m23:38:29.863072 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m23:38:29.868319 [debug] [MainThread]: Command end result
[0m23:38:29.923274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m23:38:29.930781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m23:38:29.940931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m23:38:29.944896 [info ] [MainThread]: 
[0m23:38:29.945861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:38:29.946888 [info ] [MainThread]: 
[0m23:38:29.948850 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m23:38:29.951187 [debug] [MainThread]: Command `dbt run` succeeded at 23:38:29.950195 after 3.44 seconds
[0m23:38:29.952251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C9A50F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C9A52550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C2D1CDD0>]}
[0m23:38:29.953313 [debug] [MainThread]: Flushing usage events
[0m23:38:31.093392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:28.016619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D4562310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D4562890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D4562190>]}


============================== 14:00:28.026542 | a246a836-6605-480f-b768-44aa02ef6c59 ==============================
[0m14:00:28.026542 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:00:28.029572 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m14:00:29.158624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D56FCF10>]}
[0m14:00:29.387528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D0D5DE90>]}
[0m14:00:29.457917 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:00:30.244863 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:00:32.229662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:00:32.230659 [debug] [MainThread]: Partial parsing: added file: jaffle_dbt://models\staging\schema.yml
[0m14:00:32.561103 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'jaffle_dbt' (models\staging\schema.yml). Arguments to generic tests
should be nested under the `arguments` property.
[0m14:00:32.563268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5AB7010>]}
[0m14:00:32.856939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5D90050>]}
[0m14:00:33.024590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m14:00:33.049215 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m14:00:33.164288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5C5B110>]}
[0m14:00:33.166314 [info ] [MainThread]: Found 12 models, 3 seeds, 11 data tests, 472 macros
[0m14:00:33.167937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5C73790>]}
[0m14:00:33.171954 [info ] [MainThread]: 
[0m14:00:33.173331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:00:33.175330 [info ] [MainThread]: 
[0m14:00:33.177327 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:00:33.193353 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m14:00:37.286548 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m14:00:37.287545 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m14:00:37.288543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:37.368519 [debug] [ThreadPool]: SQL status: OK in 0.089 seconds
[0m14:00:37.378770 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m14:00:37.379776 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m14:00:37.490751 [debug] [ThreadPool]: SQL status: OK in 0.110 seconds
[0m14:00:37.495628 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m14:00:37.520866 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m14:00:37.521868 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m14:00:37.528265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a246a836-6605-480f-b768-44aa02ef6c59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5C557D0>]}
[0m14:00:37.529555 [debug] [MainThread]: Using duckdb connection "master"
[0m14:00:37.530510 [debug] [MainThread]: On master: BEGIN
[0m14:00:37.531507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:37.533502 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:00:37.533502 [debug] [MainThread]: On master: COMMIT
[0m14:00:37.534499 [debug] [MainThread]: Using duckdb connection "master"
[0m14:00:37.535498 [debug] [MainThread]: On master: COMMIT
[0m14:00:37.536494 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:00:37.537492 [debug] [MainThread]: On master: Close
[0m14:00:37.556503 [debug] [Thread-1 (]: Began running node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:00:37.556503 [debug] [Thread-2 (]: Began running node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:00:37.557505 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:00:37.558502 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:00:37.559552 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending  [RUN]
[0m14:00:37.560316 [info ] [Thread-2 (]: 2 of 11 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:00:37.562474 [info ] [Thread-3 (]: 3 of 11 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m14:00:37.565648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820'
[0m14:00:37.563469 [info ] [Thread-4 (]: 4 of 11 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:00:37.567645 [debug] [Thread-2 (]: Acquiring new duckdb connection 'test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:00:37.570332 [debug] [Thread-3 (]: Acquiring new duckdb connection 'test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5'
[0m14:00:37.571332 [debug] [Thread-1 (]: Began compiling node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:00:37.573361 [debug] [Thread-4 (]: Acquiring new duckdb connection 'test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m14:00:37.576591 [debug] [Thread-2 (]: Began compiling node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:00:37.578604 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:00:37.599761 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"
[0m14:00:37.602716 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:00:37.617326 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:00:37.627336 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:00:37.637372 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:00:37.639419 [debug] [Thread-1 (]: Began executing node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:00:37.641410 [debug] [Thread-2 (]: Began executing node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:00:37.643405 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:00:37.677593 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"
[0m14:00:37.679606 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:00:37.690500 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:00:37.679606 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:00:37.699385 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:00:37.700384 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:00:37.701379 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"
[0m14:00:37.703377 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:00:37.704376 [debug] [Thread-2 (]: On test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:00:37.705375 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:00:37.706367 [debug] [Thread-1 (]: On test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820: BEGIN
[0m14:00:37.707365 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m14:00:37.708360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:00:37.709387 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:00:37.710590 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:37.711757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:00:37.713512 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:00:37.714507 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m14:00:37.716619 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:00:37.717615 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:00:37.719582 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:00:37.720559 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:00:37.721011 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"
[0m14:00:37.722008 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:00:37.723092 [debug] [Thread-2 (]: On test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_dbt"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.723920 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:00:37.725047 [debug] [Thread-1 (]: On test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from "jaffle_dbt"."main"."stg_orders"
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','returned','return_pending'
)



  
  
      
    ) dbt_internal_test
[0m14:00:37.725889 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "jaffle_dbt"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.727889 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_dbt"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.735383 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m14:00:37.737377 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m14:00:37.738388 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m14:00:37.746042 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:00:37.747041 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m14:00:37.749994 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m14:00:37.754022 [debug] [Thread-2 (]: On test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:00:37.754982 [debug] [Thread-4 (]: Failed to rollback 'test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64'
[0m14:00:37.758153 [debug] [Thread-1 (]: On test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820: ROLLBACK
[0m14:00:37.759620 [debug] [Thread-3 (]: Failed to rollback 'test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5'
[0m14:00:37.760623 [debug] [Thread-2 (]: Failed to rollback 'test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:00:37.761611 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:00:37.762607 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820'
[0m14:00:37.763606 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m14:00:37.764639 [debug] [Thread-2 (]: On test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:00:37.767921 [debug] [Thread-1 (]: On test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820: Close
[0m14:00:37.766924 [info ] [Thread-4 (]: 4 of 11 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.19s]
[0m14:00:37.770247 [info ] [Thread-3 (]: 3 of 11 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.20s]
[0m14:00:37.771245 [info ] [Thread-2 (]: 2 of 11 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.20s]
[0m14:00:37.775234 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:00:37.773240 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending  [[32mPASS[0m in 0.21s]
[0m14:00:37.777181 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:00:37.779478 [debug] [Thread-2 (]: Finished running node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:00:37.780476 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:00:37.782472 [debug] [Thread-1 (]: Finished running node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:00:37.787458 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:00:37.788456 [debug] [Thread-2 (]: Began running node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:00:37.791447 [debug] [Thread-1 (]: Began running node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:00:37.790450 [info ] [Thread-4 (]: 5 of 11 START test not_null_stg_payments_order_id .............................. [RUN]
[0m14:00:37.794881 [info ] [Thread-3 (]: 6 of 11 START test not_null_stg_payments_payment_id ............................ [RUN]
[0m14:00:37.800125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649)
[0m14:00:37.796878 [info ] [Thread-2 (]: 7 of 11 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:00:37.803119 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075)
[0m14:00:37.799134 [info ] [Thread-1 (]: 8 of 11 START test relationships_stg_payments_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:00:37.805113 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:00:37.807115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:00:37.808107 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:00:37.811097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820, now test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3)
[0m14:00:37.823066 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"
[0m14:00:37.824063 [debug] [Thread-2 (]: Began compiling node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:00:37.832885 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"
[0m14:00:37.833940 [debug] [Thread-1 (]: Began compiling node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:00:37.845199 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:00:37.846160 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:00:37.855137 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"
[0m14:00:37.857133 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:00:37.862117 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"
[0m14:00:37.863116 [debug] [Thread-2 (]: Began executing node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:00:37.872092 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"
[0m14:00:37.879560 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:00:37.879560 [debug] [Thread-1 (]: Began executing node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:00:37.880551 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"
[0m14:00:37.889528 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"
[0m14:00:37.888530 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"
[0m14:00:37.890627 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:00:37.891626 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649: BEGIN
[0m14:00:37.892622 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075: BEGIN
[0m14:00:37.894724 [debug] [Thread-2 (]: On test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m14:00:37.895722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:00:37.896719 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"
[0m14:00:37.897717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:00:37.899565 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:00:37.900718 [debug] [Thread-1 (]: On test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3: BEGIN
[0m14:00:37.901715 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m14:00:37.903710 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:00:37.904706 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m14:00:37.904706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:37.905704 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"
[0m14:00:37.906702 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"
[0m14:00:37.907698 [debug] [Thread-2 (]: Using duckdb connection "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:00:37.909584 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "jaffle_dbt"."main"."stg_payments"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.910578 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:00:37.910578 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select payment_id
from "jaffle_dbt"."main"."stg_payments"
where payment_id is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.911575 [debug] [Thread-2 (]: On test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "jaffle_dbt"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "jaffle_dbt"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.913570 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"
[0m14:00:37.914568 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m14:00:37.916682 [debug] [Thread-1 (]: On test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "jaffle_dbt"."main"."stg_payments"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "jaffle_dbt"."main"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:00:37.917678 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m14:00:37.921789 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649: ROLLBACK
[0m14:00:37.925768 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075: ROLLBACK
[0m14:00:37.927777 [debug] [Thread-4 (]: Failed to rollback 'test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649'
[0m14:00:37.929413 [debug] [Thread-3 (]: Failed to rollback 'test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075'
[0m14:00:37.930410 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m14:00:37.931406 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m14:00:37.931406 [debug] [Thread-4 (]: On test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649: Close
[0m14:00:37.932403 [debug] [Thread-3 (]: On test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075: Close
[0m14:00:37.935395 [debug] [Thread-1 (]: On test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3: ROLLBACK
[0m14:00:37.937391 [debug] [Thread-2 (]: On test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m14:00:37.939354 [info ] [Thread-4 (]: 5 of 11 PASS not_null_stg_payments_order_id .................................... [[32mPASS[0m in 0.14s]
[0m14:00:37.942344 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3'
[0m14:00:37.940348 [info ] [Thread-3 (]: 6 of 11 PASS not_null_stg_payments_payment_id .................................. [[32mPASS[0m in 0.14s]
[0m14:00:37.943342 [debug] [Thread-2 (]: Failed to rollback 'test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m14:00:37.944338 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:00:37.945335 [debug] [Thread-1 (]: On test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3: Close
[0m14:00:37.946333 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:00:37.947330 [debug] [Thread-2 (]: On test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m14:00:37.948328 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:00:37.951319 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:00:37.950322 [info ] [Thread-1 (]: 8 of 11 PASS relationships_stg_payments_order_id__order_id__ref_stg_orders_ .... [[32mPASS[0m in 0.14s]
[0m14:00:37.954312 [info ] [Thread-2 (]: 7 of 11 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.15s]
[0m14:00:37.955310 [info ] [Thread-4 (]: 9 of 11 START test unique_stg_customers_customer_id ............................ [RUN]
[0m14:00:37.959874 [debug] [Thread-1 (]: Finished running node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:00:37.957304 [info ] [Thread-3 (]: 10 of 11 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:00:37.961870 [debug] [Thread-2 (]: Finished running node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:00:37.963864 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649, now test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada)
[0m14:00:37.964860 [debug] [Thread-1 (]: Began running node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:00:37.964860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075, now test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m14:00:37.966854 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:00:37.970562 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:00:37.967851 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_payments_payment_id ............................. [RUN]
[0m14:00:37.982602 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:00:37.995849 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:00:37.996847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3, now test.jaffle_dbt.unique_stg_payments_payment_id.3744510712)
[0m14:00:37.998496 [debug] [Thread-1 (]: Began compiling node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:00:38.000487 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:00:38.010459 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"
[0m14:00:38.010459 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:00:38.014448 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:00:38.022676 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:00:38.026664 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:00:38.028659 [debug] [Thread-1 (]: Began executing node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:00:38.030653 [debug] [Thread-4 (]: On test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:00:38.032648 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:00:38.039452 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"
[0m14:00:38.040593 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:00:38.041592 [debug] [Thread-3 (]: On test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:00:38.043737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:00:38.044736 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m14:00:38.045733 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"
[0m14:00:38.046730 [debug] [Thread-4 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:00:38.047728 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m14:00:38.048504 [debug] [Thread-1 (]: On test.jaffle_dbt.unique_stg_payments_payment_id.3744510712: BEGIN
[0m14:00:38.049498 [debug] [Thread-4 (]: On test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "jaffle_dbt"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:38.050496 [debug] [Thread-3 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:00:38.051492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:38.054485 [debug] [Thread-3 (]: On test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "jaffle_dbt"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:38.056479 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:00:38.057477 [debug] [Thread-1 (]: Using duckdb connection "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"
[0m14:00:38.058474 [debug] [Thread-1 (]: On test.jaffle_dbt.unique_stg_payments_payment_id.3744510712: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from "jaffle_dbt"."main"."stg_payments"
where payment_id is not null
group by payment_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:00:38.059471 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m14:00:38.060468 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m14:00:38.064458 [debug] [Thread-4 (]: On test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:00:38.064458 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:00:38.067449 [debug] [Thread-3 (]: On test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:00:38.069477 [debug] [Thread-4 (]: Failed to rollback 'test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada'
[0m14:00:38.072462 [debug] [Thread-1 (]: On test.jaffle_dbt.unique_stg_payments_payment_id.3744510712: ROLLBACK
[0m14:00:38.074459 [debug] [Thread-3 (]: Failed to rollback 'test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a'
[0m14:00:38.076454 [debug] [Thread-4 (]: On test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada: Close
[0m14:00:38.077449 [debug] [Thread-1 (]: Failed to rollback 'test.jaffle_dbt.unique_stg_payments_payment_id.3744510712'
[0m14:00:38.078447 [debug] [Thread-3 (]: On test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:00:38.081438 [debug] [Thread-1 (]: On test.jaffle_dbt.unique_stg_payments_payment_id.3744510712: Close
[0m14:00:38.080441 [info ] [Thread-4 (]: 9 of 11 PASS unique_stg_customers_customer_id .................................. [[32mPASS[0m in 0.12s]
[0m14:00:38.083433 [info ] [Thread-3 (]: 10 of 11 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.12s]
[0m14:00:38.086425 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:00:38.084431 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_payments_payment_id ................................... [[32mPASS[0m in 0.09s]
[0m14:00:38.088421 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:00:38.090539 [debug] [Thread-1 (]: Finished running node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:00:38.093623 [debug] [MainThread]: Using duckdb connection "master"
[0m14:00:38.094622 [debug] [MainThread]: On master: BEGIN
[0m14:00:38.095619 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:38.097614 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m14:00:38.098611 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.099608 [debug] [MainThread]: Using duckdb connection "master"
[0m14:00:38.100605 [debug] [MainThread]: On master: COMMIT
[0m14:00:38.102600 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:00:38.103598 [debug] [MainThread]: On master: Close
[0m14:00:38.105594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:38.108585 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m14:00:38.109584 [debug] [MainThread]: Connection 'test.jaffle_dbt.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m14:00:38.110578 [debug] [MainThread]: Connection 'test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m14:00:38.111576 [debug] [MainThread]: Connection 'test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:00:38.112577 [debug] [MainThread]: Connection 'test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m14:00:38.113571 [info ] [MainThread]: 
[0m14:00:38.114568 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m14:00:38.121197 [debug] [MainThread]: Command end result
[0m14:00:38.190787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m14:00:38.194773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m14:00:38.209733 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m14:00:38.210732 [info ] [MainThread]: 
[0m14:00:38.212727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:00:38.213735 [info ] [MainThread]: 
[0m14:00:38.214721 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m14:00:38.216716 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:00:38.222972 [debug] [MainThread]: Command `dbt test` succeeded at 14:00:38.222972 after 10.40 seconds
[0m14:00:38.224966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D4296D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CD89A310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217CD89AF10>]}
[0m14:00:38.225963 [debug] [MainThread]: Flushing usage events
[0m14:00:39.302327 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:50.009574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F60FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F60FDB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F60FDB10>]}


============================== 14:02:50.015854 | c4d66f57-69b0-4c95-b045-2f1b0cd003e9 ==============================
[0m14:02:50.015854 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:02:50.017851 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m14:02:50.393249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F7387CD0>]}
[0m14:02:50.510067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F50F00D0>]}
[0m14:02:50.514828 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m14:02:50.998646 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m14:02:51.293652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:02:51.293652 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m14:02:51.297666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:02:51.460479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F76D0650>]}
[0m14:02:51.525082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F77B6310>]}
[0m14:02:51.527083 [info ] [MainThread]: Found 12 models, 3 seeds, 11 data tests, 472 macros
[0m14:02:51.528074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F758EE50>]}
[0m14:02:51.536053 [info ] [MainThread]: 
[0m14:02:51.537050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:51.540043 [info ] [MainThread]: 
[0m14:02:51.542038 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:02:51.559989 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m14:02:51.719849 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m14:02:51.728377 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m14:02:51.729356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:51.757733 [debug] [ThreadPool]: SQL status: OK in 0.029 seconds
[0m14:02:51.758770 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m14:02:51.759763 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m14:02:51.792336 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m14:02:51.797856 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m14:02:51.799364 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m14:02:51.799364 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m14:02:51.799364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4d66f57-69b0-4c95-b045-2f1b0cd003e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F7854B50>]}
[0m14:02:51.812578 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m14:02:51.813567 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m14:02:51.814566 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m14:02:51.815668 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m14:02:51.817664 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m14:02:51.818775 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m14:02:51.819595 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m14:02:51.821586 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m14:02:51.822586 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m14:02:51.837212 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m14:02:51.842314 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m14:02:51.848401 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m14:02:51.851402 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m14:02:51.853395 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m14:02:51.854392 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m14:02:51.856386 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.stg_customers
[0m14:02:51.857383 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.stg_orders
[0m14:02:51.859377 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.stg_payments
[0m14:02:51.860377 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_customers'
[0m14:02:51.861373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.jaffle_dbt.raw_customers, now model.jaffle_dbt.stg_orders)
[0m14:02:51.862372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_dbt.raw_orders, now model.jaffle_dbt.stg_payments)
[0m14:02:51.864365 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.stg_customers
[0m14:02:51.865467 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.stg_orders
[0m14:02:51.866465 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.stg_payments
[0m14:02:51.874646 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.stg_customers"
[0m14:02:51.883621 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.stg_orders"
[0m14:02:51.940853 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.stg_payments"
[0m14:02:51.943881 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.stg_customers
[0m14:02:51.943881 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.stg_customers
[0m14:02:51.943881 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.stg_orders
[0m14:02:51.947893 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.stg_payments
[0m14:02:51.949701 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:02:51.950698 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:02:51.951694 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.stg_orders
[0m14:02:51.953690 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.stg_payments
[0m14:02:51.954686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_dbt.raw_payments, now test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m14:02:51.955688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_customers, now test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada)
[0m14:02:51.957679 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.monthly_order_growth
[0m14:02:51.957679 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.new_customers
[0m14:02:51.959695 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:02:51.960694 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:02:51.961690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_orders, now model.jaffle_dbt.monthly_order_growth)
[0m14:02:51.962688 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_payments, now model.jaffle_dbt.new_customers)
[0m14:02:51.981680 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:02:51.990694 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada"
[0m14:02:51.991691 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.monthly_order_growth
[0m14:02:51.992689 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.new_customers
[0m14:02:51.993960 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:02:52.001734 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_order_growth"
[0m14:02:52.002692 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:02:52.008676 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.new_customers"
[0m14:02:52.010672 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:02:52.013696 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada
[0m14:02:52.014660 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.monthly_order_growth
[0m14:02:52.015762 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.repeat_purchase_rate
[0m14:02:52.017760 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.new_customers
[0m14:02:52.019359 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:02:52.020337 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.monthly_order_growth
[0m14:02:52.021333 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_customers_customer_id.e2cfb1f9aa, now model.jaffle_dbt.repeat_purchase_rate)
[0m14:02:52.023328 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.new_customers
[0m14:02:52.023328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.unique_stg_customers_customer_id.c7614daada, now test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820)
[0m14:02:52.024362 [debug] [Thread-1 (]: Began running node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:02:52.025325 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.repeat_purchase_rate
[0m14:02:52.027317 [debug] [Thread-2 (]: Began running node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:02:52.028316 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:02:52.029311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_order_growth, now test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:02:52.033300 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.repeat_purchase_rate"
[0m14:02:52.034298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.new_customers, now test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:02:52.049620 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820"
[0m14:02:52.050645 [debug] [Thread-1 (]: Began compiling node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:02:52.051517 [debug] [Thread-2 (]: Began compiling node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:02:52.053514 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.repeat_purchase_rate
[0m14:02:52.061494 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:02:52.068619 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:02:52.069839 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:02:52.070421 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.repeat_purchase_rate
[0m14:02:52.073670 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820
[0m14:02:52.074669 [debug] [Thread-1 (]: Began executing node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:02:52.075682 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:02:52.076667 [debug] [Thread-2 (]: Began executing node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:02:52.077693 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:02:52.079096 [debug] [Thread-1 (]: Finished running node test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:02:52.080088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.repeat_purchase_rate, now test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:02:52.082167 [debug] [Thread-2 (]: Finished running node test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64
[0m14:02:52.082839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.accepted_values_stg_orders_status__placed__shipped__completed__returned__return_pending.922d62c820, now test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a)
[0m14:02:52.083693 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.customer_ltv
[0m14:02:52.084847 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:02:52.085697 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.customer_segment
[0m14:02:52.086698 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:02:52.087731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_orders_customer_id.af79d5e4b5, now model.jaffle_dbt.customer_ltv)
[0m14:02:52.101657 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:02:52.102655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.not_null_stg_orders_order_id.81cfe2fe64, now model.jaffle_dbt.customer_segment)
[0m14:02:52.109605 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a"
[0m14:02:52.111062 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.customer_ltv
[0m14:02:52.113267 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.customer_segment
[0m14:02:52.114265 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:02:52.121402 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.customer_ltv"
[0m14:02:52.123362 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:02:52.127350 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.customer_segment"
[0m14:02:52.129366 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:02:52.132373 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a
[0m14:02:52.133335 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.customer_ltv
[0m14:02:52.134288 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.monthly_revenue
[0m14:02:52.136287 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.payments_summary
[0m14:02:52.137283 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.customer_segment
[0m14:02:52.139811 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.customer_ltv
[0m14:02:52.140810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now model.jaffle_dbt.monthly_revenue)
[0m14:02:52.141808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_dbt.unique_stg_orders_order_id.e3b841c71a, now model.jaffle_dbt.payments_summary)
[0m14:02:52.143930 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.customer_segment
[0m14:02:52.144670 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.refunds_discounts
[0m14:02:52.145506 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.monthly_revenue
[0m14:02:52.146508 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.payments_summary
[0m14:02:52.147540 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.top_customers
[0m14:02:52.149528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_ltv, now model.jaffle_dbt.refunds_discounts)
[0m14:02:52.155156 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_revenue"
[0m14:02:52.160144 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.payments_summary"
[0m14:02:52.160965 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_segment, now model.jaffle_dbt.top_customers)
[0m14:02:52.162172 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.refunds_discounts
[0m14:02:52.163953 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.monthly_revenue
[0m14:02:52.165076 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.top_customers
[0m14:02:52.170783 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.refunds_discounts"
[0m14:02:52.172023 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.payments_summary
[0m14:02:52.173586 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.monthly_revenue
[0m14:02:52.177610 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.top_customers"
[0m14:02:52.180610 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.payments_summary
[0m14:02:52.181228 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.refunds_discounts
[0m14:02:52.182230 [debug] [Thread-3 (]: Began running node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:02:52.184224 [debug] [Thread-4 (]: Began running node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:02:52.185376 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.top_customers
[0m14:02:52.187410 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.refunds_discounts
[0m14:02:52.188373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_revenue, now test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649)
[0m14:02:52.189408 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.payments_summary, now test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075)
[0m14:02:52.190512 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.top_customers
[0m14:02:52.191512 [debug] [Thread-1 (]: Began running node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:02:52.192592 [debug] [Thread-3 (]: Began compiling node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:02:52.192592 [debug] [Thread-4 (]: Began compiling node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:02:52.192592 [debug] [Thread-2 (]: Began running node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:02:52.192592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.refunds_discounts, now test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3)
[0m14:02:52.203642 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649"
[0m14:02:52.209601 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075"
[0m14:02:52.210157 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.top_customers, now test.jaffle_dbt.unique_stg_payments_payment_id.3744510712)
[0m14:02:52.211395 [debug] [Thread-1 (]: Began compiling node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:02:52.213394 [debug] [Thread-2 (]: Began compiling node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:02:52.214394 [debug] [Thread-4 (]: Began executing node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:02:52.223750 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3"
[0m14:02:52.224173 [debug] [Thread-3 (]: Began executing node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:02:52.232744 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_dbt.unique_stg_payments_payment_id.3744510712"
[0m14:02:52.234704 [debug] [Thread-4 (]: Finished running node test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075
[0m14:02:52.236350 [debug] [Thread-3 (]: Finished running node test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649
[0m14:02:52.238343 [debug] [Thread-1 (]: Began executing node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:02:52.239338 [debug] [Thread-2 (]: Began executing node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:02:52.241471 [debug] [Thread-1 (]: Finished running node test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3
[0m14:02:52.242523 [debug] [Thread-2 (]: Finished running node test.jaffle_dbt.unique_stg_payments_payment_id.3744510712
[0m14:02:52.242523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:52.242523 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m14:02:52.242523 [debug] [MainThread]: Connection 'test.jaffle_dbt.relationships_stg_payments_order_id__order_id__ref_stg_orders_.8426a3f3d3' was properly closed.
[0m14:02:52.247711 [debug] [MainThread]: Connection 'test.jaffle_dbt.unique_stg_payments_payment_id.3744510712' was properly closed.
[0m14:02:52.248749 [debug] [MainThread]: Connection 'test.jaffle_dbt.not_null_stg_payments_order_id.601cf57649' was properly closed.
[0m14:02:52.249710 [debug] [MainThread]: Connection 'test.jaffle_dbt.not_null_stg_payments_payment_id.c19cc50075' was properly closed.
[0m14:02:52.257723 [debug] [MainThread]: Command end result
[0m14:02:52.413533 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m14:02:52.417488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m14:02:52.431460 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m14:02:53.145309 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m14:02:53.146307 [info ] [MainThread]: Building catalog
[0m14:02:53.164267 [debug] [ThreadPool]: Acquiring new duckdb connection 'jaffle_dbt.information_schema'
[0m14:02:53.180269 [debug] [ThreadPool]: Using duckdb connection "jaffle_dbt.information_schema"
[0m14:02:53.181266 [debug] [ThreadPool]: On jaffle_dbt.information_schema: BEGIN
[0m14:02:53.181266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:53.183262 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m14:02:53.184258 [debug] [ThreadPool]: Using duckdb connection "jaffle_dbt.information_schema"
[0m14:02:53.185256 [debug] [ThreadPool]: On jaffle_dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "jaffle_dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'jaffle_dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'jaffle_dbt'
    )
    select
        'jaffle_dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m14:02:53.211291 [debug] [ThreadPool]: SQL status: OK in 0.025 seconds
[0m14:02:53.216818 [debug] [ThreadPool]: On jaffle_dbt.information_schema: ROLLBACK
[0m14:02:53.217816 [debug] [ThreadPool]: Failed to rollback 'jaffle_dbt.information_schema'
[0m14:02:53.218815 [debug] [ThreadPool]: On jaffle_dbt.information_schema: Close
[0m14:02:53.238760 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\kev\jaffle_shop\jaffle_dbt\target\catalog.json
[0m14:02:53.288589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m14:02:53.292566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m14:02:53.294561 [info ] [MainThread]: Catalog written to C:\kev\jaffle_shop\jaffle_dbt\target\catalog.json
[0m14:02:53.296593 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:02:53.296593 after 3.43 seconds
[0m14:02:53.297551 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:02:53.297551 [debug] [MainThread]: Connection 'jaffle_dbt.information_schema' was properly closed.
[0m14:02:53.299549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4D2BF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168EF41A3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F2A64C50>]}
[0m14:02:53.300575 [debug] [MainThread]: Flushing usage events
[0m14:02:54.234265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:33.514237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742412CD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742412F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742412D310>]}


============================== 14:03:33.520604 | d4bde686-cdd4-4468-87af-52b6670d67ec ==============================
[0m14:03:33.520604 [info ] [MainThread]: Running with dbt=1.11.2
[0m14:03:33.522519 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m14:03:33.912286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4bde686-cdd4-4468-87af-52b6670d67ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742411F750>]}
[0m14:03:34.007094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4bde686-cdd4-4468-87af-52b6670d67ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001742097D7D0>]}
[0m14:05:58.840070 [error] [MainThread]: Encountered an error:

[0m14:05:59.429151 [error] [MainThread]: Traceback (most recent call last):
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\kev\jaffle_shop\jaffle_dbt\venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Evans Moseti\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m14:05:59.436205 [debug] [MainThread]: Command `dbt docs serve` failed at 14:05:59.436205 after 146.05 seconds
[0m14:05:59.437786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174241DC1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174241D3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017424129510>]}
[0m14:05:59.438774 [debug] [MainThread]: Flushing usage events
[0m14:06:00.454866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:27.708646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C03419D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C0342A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C02DCB50>]}


============================== 15:19:27.717671 | 1a7fe60f-86ad-4f55-a1f7-ea593e51078e ==============================
[0m15:19:27.717671 [info ] [MainThread]: Running with dbt=1.11.2
[0m15:19:27.719665 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m15:19:28.463652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C14AA710>]}
[0m15:19:28.562460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BCB3D890>]}
[0m15:19:28.566441 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m15:19:29.055695 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m15:19:29.454736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:29.455734 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m15:19:29.456732 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:29.584967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C18CC050>]}
[0m15:19:29.931027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m15:19:29.937015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m15:19:30.017235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1726A10>]}
[0m15:19:30.019230 [info ] [MainThread]: Found 12 models, 3 seeds, 11 data tests, 472 macros
[0m15:19:30.023882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C175A750>]}
[0m15:19:30.030876 [info ] [MainThread]: 
[0m15:19:30.032866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:30.034862 [info ] [MainThread]: 
[0m15:19:30.036856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:19:30.064781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m15:19:30.647868 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m15:19:30.649862 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m15:19:30.650858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:30.726955 [debug] [ThreadPool]: SQL status: OK in 0.076 seconds
[0m15:19:30.731941 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m15:19:30.733938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m15:19:30.735932 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m15:19:30.750811 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m15:19:30.751804 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m15:19:30.753789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:30.755783 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:19:30.758776 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m15:19:30.759774 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m15:19:30.761768 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:19:30.763762 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m15:19:30.764760 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m15:19:30.766755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:19:30.769747 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m15:19:30.771846 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m15:19:30.774840 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m15:19:30.776834 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:19:30.779828 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m15:19:30.786815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m15:19:30.800769 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m15:19:30.801767 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m15:19:30.802764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:30.803762 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:19:30.805757 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m15:19:30.806757 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m15:19:30.919454 [debug] [ThreadPool]: SQL status: OK in 0.111 seconds
[0m15:19:30.928432 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m15:19:30.935412 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m15:19:30.937406 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m15:19:30.954360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1D69B50>]}
[0m15:19:30.956357 [debug] [MainThread]: Using duckdb connection "master"
[0m15:19:30.958350 [debug] [MainThread]: On master: BEGIN
[0m15:19:30.959346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:30.963337 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m15:19:30.965331 [debug] [MainThread]: On master: COMMIT
[0m15:19:30.967326 [debug] [MainThread]: Using duckdb connection "master"
[0m15:19:30.969320 [debug] [MainThread]: On master: COMMIT
[0m15:19:30.972329 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:19:30.974307 [debug] [MainThread]: On master: Close
[0m15:19:31.084014 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.stg_customers
[0m15:19:31.086008 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.stg_orders
[0m15:19:31.087005 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.stg_payments
[0m15:19:31.089001 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_customers ................................ [RUN]
[0m15:19:31.097975 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_customers'
[0m15:19:31.099970 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.stg_customers
[0m15:19:31.092048 [info ] [Thread-2 (]: 2 of 12 START sql view model main.stg_orders ................................... [RUN]
[0m15:19:31.150834 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_orders'
[0m15:19:31.152828 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.stg_orders
[0m15:19:31.171779 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.stg_orders"
[0m15:19:31.175767 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.stg_orders
[0m15:19:31.204689 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.stg_customers"
[0m15:19:31.094006 [info ] [Thread-3 (]: 3 of 12 START sql view model main.stg_payments ................................. [RUN]
[0m15:19:31.282482 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.stg_customers
[0m15:19:31.285474 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_payments'
[0m15:19:31.423105 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.stg_payments
[0m15:19:31.466988 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.stg_payments"
[0m15:19:31.470991 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.stg_payments
[0m15:19:31.635538 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.stg_orders"
[0m15:19:31.638529 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.640525 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: BEGIN
[0m15:19:31.642518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:19:31.645510 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:19:31.646508 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.648502 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

  
  create view "jaffle_dbt"."main"."stg_orders__dbt_tmp" as (
    with source as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from "jaffle_dbt"."main"."raw_orders"

)

select * from source
  );

[0m15:19:31.695377 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.stg_customers"
[0m15:19:31.702358 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.stg_payments"
[0m15:19:31.703357 [debug] [Thread-2 (]: SQL status: OK in 0.054 seconds
[0m15:19:31.713330 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:31.726296 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.728289 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:31.729287 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: BEGIN
[0m15:19:31.730283 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */
alter view "jaffle_dbt"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:19:31.733276 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: BEGIN
[0m15:19:31.734273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:31.736267 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:19:31.738262 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:31.740257 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m15:19:31.779152 [debug] [Thread-3 (]: SQL status: OK in 0.043 seconds
[0m15:19:31.783144 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.784139 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:31.786135 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:31.787132 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */
alter view "jaffle_dbt"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:19:31.789127 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

  
  create view "jaffle_dbt"."main"."stg_customers__dbt_tmp" as (
    with source as (

    select
        id as customer_id,
        first_name,
        last_name
    from "jaffle_dbt"."main"."raw_customers"

)

select * from source
  );

[0m15:19:31.791121 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

  
  create view "jaffle_dbt"."main"."stg_payments__dbt_tmp" as (
    with source as (

    select
        id as payment_id,
        order_id,
        payment_method,
        amount
    from "jaffle_dbt"."main"."raw_payments"

)

select * from source
  );

[0m15:19:31.794113 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:19:31.795133 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:19:31.805086 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:19:31.819046 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:31.864924 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m15:19:31.884870 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:31.889856 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */
alter view "jaffle_dbt"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:19:31.892850 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.893847 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */
alter view "jaffle_dbt"."main"."stg_payments" rename to "stg_payments__dbt_backup"
[0m15:19:31.895842 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m15:19:31.897835 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:19:31.901824 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:19:31.913804 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:31.930748 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:31.933740 [debug] [Thread-2 (]: SQL status: OK in 0.032 seconds
[0m15:19:31.936733 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */
alter view "jaffle_dbt"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:19:31.938726 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */
alter view "jaffle_dbt"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m15:19:31.959671 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m15:19:31.962661 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:19:31.963659 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:19:31.966652 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

      drop view if exists "jaffle_dbt"."main"."stg_orders__dbt_backup" cascade
    
[0m15:19:31.972637 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m15:19:31.977623 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m15:19:31.979617 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:31.981612 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:31.985601 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m15:19:31.987596 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m15:19:31.998566 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:19:32.009537 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m15:19:32.011532 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

      drop view if exists "jaffle_dbt"."main"."stg_payments__dbt_backup" cascade
    
[0m15:19:32.013526 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m15:19:32.021504 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: Close
[0m15:19:32.022503 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m15:19:32.024509 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m15:19:32.042448 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m15:19:32.047435 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: Close
[0m15:19:32.048433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C18CC690>]}
[0m15:19:32.051424 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

      drop view if exists "jaffle_dbt"."main"."stg_customers__dbt_backup" cascade
    
[0m15:19:32.053420 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1E0FE90>]}
[0m15:19:32.063393 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:19:32.070374 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: Close
[0m15:19:32.072368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1D76090>]}
[0m15:19:32.056412 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.87s]
[0m15:19:32.079350 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.stg_orders
[0m15:19:32.090320 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.monthly_order_growth
[0m15:19:32.095311 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.new_customers
[0m15:19:32.059403 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main.stg_payments ............................ [[32mOK[0m in 0.77s]
[0m15:19:32.102330 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.stg_payments
[0m15:19:32.104284 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.repeat_purchase_rate
[0m15:19:32.075361 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.98s]
[0m15:19:32.094311 [info ] [Thread-4 (]: 4 of 12 START sql table model main.monthly_order_growth ........................ [RUN]
[0m15:19:32.154150 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_order_growth'
[0m15:19:32.156145 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.monthly_order_growth
[0m15:19:32.169110 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.171106 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.monthly_order_growth
[0m15:19:32.149164 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.stg_customers
[0m15:19:32.097303 [info ] [Thread-2 (]: 5 of 12 START sql table model main.new_customers ............................... [RUN]
[0m15:19:32.106278 [info ] [Thread-3 (]: 6 of 12 START sql table model main.repeat_purchase_rate ........................ [RUN]
[0m15:19:32.237926 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.customer_ltv
[0m15:19:32.278816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_orders, now model.jaffle_dbt.new_customers)
[0m15:19:32.280811 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.282807 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_payments, now model.jaffle_dbt.repeat_purchase_rate)
[0m15:19:32.286795 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.new_customers
[0m15:19:32.288789 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.repeat_purchase_rate
[0m15:19:32.290785 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.300758 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.new_customers"
[0m15:19:32.284801 [info ] [Thread-1 (]: 7 of 12 START sql table model main.customer_ltv ................................ [RUN]
[0m15:19:32.315717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_customers, now model.jaffle_dbt.customer_ltv)
[0m15:19:32.312728 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: BEGIN
[0m15:19:32.311728 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.318710 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.customer_ltv
[0m15:19:32.320704 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.new_customers
[0m15:19:32.322700 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:19:32.340651 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.customer_ltv"
[0m15:19:32.342645 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.repeat_purchase_rate
[0m15:19:32.355611 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.new_customers"
[0m15:19:32.361595 [debug] [Thread-4 (]: SQL status: OK in 0.035 seconds
[0m15:19:32.373563 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.376554 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.377552 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.customer_ltv
[0m15:19:32.382538 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp"
  
    as (
      --Orders per month



select
    date_trunc('month', order_date) as month,
    count(*) as total_orders
from "jaffle_dbt"."main"."stg_orders"
group by 1
order by 1
    );
  
  
[0m15:19:32.379548 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.397500 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.customer_ltv"
[0m15:19:32.400490 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.403482 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: BEGIN
[0m15:19:32.407471 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: BEGIN
[0m15:19:32.415450 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:19:32.417444 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.419439 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:19:32.422431 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: BEGIN
[0m15:19:32.423429 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m15:19:32.425423 [debug] [Thread-4 (]: SQL status: OK in 0.023 seconds
[0m15:19:32.427419 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:19:32.429412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:32.430410 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.451354 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.453348 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.456341 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m15:19:32.457338 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."new_customers__dbt_tmp"
  
    as (
      --New customer acquisition



with first_orders as (
    select
        customer_id,
        min(order_date) as first_order_date
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    date_trunc('month', first_order_date) as month,
    count(customer_id) as new_customers
from first_orders
group by 1
order by 1
    );
  
  
[0m15:19:32.459333 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_order_growth'
  
[0m15:19:32.462326 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp"
  
    as (
      --% of returning customers



with customer_orders as (
    select
        customer_id,
        count(*) as order_count
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    count(case when order_count > 1 then 1 end) * 1.0
        / count(*) as repeat_purchase_rate
from customer_orders
    );
  
  
[0m15:19:32.464319 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.469307 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.471301 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_ltv__dbt_tmp"
  
    as (
      --Lifetime value per customer



select
    o.customer_id,
    sum(p.amount) as lifetime_value
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by lifetime_value desc
    );
  
  
[0m15:19:32.475290 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.479279 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_order_growth'
  
[0m15:19:32.481274 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m15:19:32.485265 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.486260 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:19:32.488256 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m15:19:32.490250 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'repeat_purchase_rate'
  
[0m15:19:32.502218 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.504212 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m15:19:32.508201 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.510197 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth" rename to "monthly_order_growth__dbt_backup"
[0m15:19:32.512191 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.516180 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.518175 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'new_customers'
  
[0m15:19:32.523164 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.524159 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:19:32.525156 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_ltv'
  
[0m15:19:32.528149 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'repeat_purchase_rate'
  
[0m15:19:32.530144 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.542111 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.547098 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.552087 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.553082 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:19:32.558068 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.559066 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp" rename to "monthly_order_growth"
[0m15:19:32.561060 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'new_customers'
  
[0m15:19:32.578015 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.579012 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_ltv'
  
[0m15:19:32.583003 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:19:32.584000 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate" rename to "repeat_purchase_rate__dbt_backup"
[0m15:19:32.585994 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:19:32.603946 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m15:19:32.604943 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:19:32.618910 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.619903 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:19:32.621899 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.636858 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers" rename to "new_customers__dbt_backup"
[0m15:19:32.643839 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.655807 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.657802 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m15:19:32.661791 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m15:19:32.662789 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.664784 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp" rename to "repeat_purchase_rate"
[0m15:19:32.680742 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.682735 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m15:19:32.683732 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m15:19:32.685728 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.686725 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers__dbt_tmp" rename to "new_customers"
[0m15:19:32.698694 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.709663 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m15:19:32.735594 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m15:19:32.739585 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m15:19:32.741577 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:32.743574 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

      drop table if exists "jaffle_dbt"."main"."monthly_order_growth__dbt_backup" cascade
    
[0m15:19:32.745569 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.755541 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m15:19:32.751552 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m15:19:32.758533 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.753548 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:19:32.768507 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m15:19:32.760528 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m15:19:32.770501 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.772495 [debug] [Thread-4 (]: SQL status: OK in 0.018 seconds
[0m15:19:32.775488 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m15:19:32.779478 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: Close
[0m15:19:32.782470 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1799990>]}
[0m15:19:32.784463 [info ] [Thread-4 (]: 4 of 12 OK created sql table model main.monthly_order_growth ................... [[32mOK[0m in 0.63s]
[0m15:19:32.793439 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.monthly_order_growth
[0m15:19:32.795434 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.customer_segment
[0m15:19:32.807402 [debug] [Thread-2 (]: SQL status: OK in 0.033 seconds
[0m15:19:32.797429 [debug] [Thread-3 (]: SQL status: OK in 0.040 seconds
[0m15:19:32.817376 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m15:19:32.818373 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m15:19:32.829343 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m15:19:32.830342 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

      drop table if exists "jaffle_dbt"."main"."new_customers__dbt_backup" cascade
    
[0m15:19:32.840315 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

      drop table if exists "jaffle_dbt"."main"."repeat_purchase_rate__dbt_backup" cascade
    
[0m15:19:32.848293 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m15:19:32.804431 [info ] [Thread-4 (]: 8 of 12 START sql table model main.customer_segment ............................ [RUN]
[0m15:19:32.851285 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

      drop table if exists "jaffle_dbt"."main"."customer_ltv__dbt_backup" cascade
    
[0m15:19:32.854278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_order_growth, now model.jaffle_dbt.customer_segment)
[0m15:19:32.856274 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:19:32.858265 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.customer_segment
[0m15:19:32.859264 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:19:32.863253 [debug] [Thread-2 (]: On model.jaffle_dbt.new_customers: Close
[0m15:19:32.865248 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:19:32.878212 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.customer_segment"
[0m15:19:32.882202 [debug] [Thread-3 (]: On model.jaffle_dbt.repeat_purchase_rate: Close
[0m15:19:32.885194 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1D2AC90>]}
[0m15:19:32.890180 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_ltv: Close
[0m15:19:32.893173 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1F78450>]}
[0m15:19:32.894169 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.customer_segment
[0m15:19:32.898159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1E27B50>]}
[0m15:19:32.896166 [info ] [Thread-2 (]: 5 of 12 OK created sql table model main.new_customers .......................... [[32mOK[0m in 0.61s]
[0m15:19:32.916110 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.customer_segment"
[0m15:19:32.921097 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.new_customers
[0m15:19:32.901151 [info ] [Thread-3 (]: 6 of 12 OK created sql table model main.repeat_purchase_rate ................... [[32mOK[0m in 0.61s]
[0m15:19:32.924089 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.monthly_revenue
[0m15:19:32.926093 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.repeat_purchase_rate
[0m15:19:32.931072 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.payments_summary
[0m15:19:32.918106 [info ] [Thread-1 (]: 7 of 12 OK created sql table model main.customer_ltv ........................... [[32mOK[0m in 0.58s]
[0m15:19:32.939049 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.customer_ltv
[0m15:19:32.929077 [info ] [Thread-2 (]: 9 of 12 START sql table model main.monthly_revenue ............................. [RUN]
[0m15:19:32.944037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.new_customers, now model.jaffle_dbt.monthly_revenue)
[0m15:19:32.941045 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.refunds_discounts
[0m15:19:32.947029 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.monthly_revenue
[0m15:19:32.933068 [info ] [Thread-3 (]: 10 of 12 START sql table model main.payments_summary ........................... [RUN]
[0m15:19:32.965978 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:32.968970 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_revenue"
[0m15:19:32.971962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.repeat_purchase_rate, now model.jaffle_dbt.payments_summary)
[0m15:19:32.973956 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: BEGIN
[0m15:19:32.994901 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.payments_summary
[0m15:19:32.997892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:19:32.950021 [info ] [Thread-1 (]: 11 of 12 START sql table model main.refunds_discounts .......................... [RUN]
[0m15:19:33.011856 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.payments_summary"
[0m15:19:33.014847 [debug] [Thread-4 (]: SQL status: OK in 0.017 seconds
[0m15:19:33.015844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_ltv, now model.jaffle_dbt.refunds_discounts)
[0m15:19:33.017839 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.monthly_revenue
[0m15:19:33.042772 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.066709 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_segment__dbt_tmp"
  
    as (
      --Segmentation (e.g., high/medium/low)



with customer_spend as (
    select
        o.customer_id,
        sum(p.amount) as total_spent
    from "jaffle_dbt"."main"."stg_orders" o
    join "jaffle_dbt"."main"."stg_payments" p
        on o.order_id = p.order_id
    group by 1
)

select
    customer_id,
    total_spent,
    case
        when total_spent >= 5000 then 'high_value'
        when total_spent >= 2000 then 'medium_value'
        else 'low_value'
    end as customer_segment
from customer_spend
    );
  
  
[0m15:19:33.043769 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.payments_summary
[0m15:19:33.044770 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.refunds_discounts
[0m15:19:33.063715 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.080671 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.payments_summary"
[0m15:19:33.082665 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m15:19:33.090643 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.093636 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.096628 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.099622 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: BEGIN
[0m15:19:33.101615 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_segment'
  
[0m15:19:33.102613 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.104606 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.refunds_discounts
[0m15:19:33.105604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:19:33.107599 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: BEGIN
[0m15:19:33.108597 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.121562 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.123557 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:19:33.124553 [debug] [Thread-2 (]: SQL status: OK in 0.019 seconds
[0m15:19:33.128543 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.131535 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.133530 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:19:33.134527 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.136524 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'customer_segment'
  
[0m15:19:33.138516 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: BEGIN
[0m15:19:33.140512 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.141508 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_revenue__dbt_tmp"
  
    as (
      --Total revenue per month



select
    date_trunc('month', o.order_date) as month,
    sum(p.amount) as revenue
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by 1
    );
  
  
[0m15:19:33.144502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:33.145498 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.146495 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."payments_summary__dbt_tmp"
  
    as (
      

select
    payment_method,
    count(*) as payment_count,
    sum(amount) as total_amount
from "jaffle_dbt"."main"."stg_payments"
group by payment_method
order by total_amount desc
    );
  
  
[0m15:19:33.163449 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m15:19:33.162452 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.173423 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.174420 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:19:33.176415 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment" rename to "customer_segment__dbt_backup"
[0m15:19:33.178411 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_revenue'
  
[0m15:19:33.180404 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.181401 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:19:33.184395 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:19:33.185392 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."refunds_discounts__dbt_tmp"
  
    as (
      --Refunds, discounts per month


select
    payment_method,
    sum(case when amount = 0 then 1 else 0 end) as zero_amount_payments
from "jaffle_dbt"."main"."stg_payments"
group by 1
    );
  
  
[0m15:19:33.187385 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:19:33.190377 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.200351 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.206334 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.207331 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.209326 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'payments_summary'
  
[0m15:19:33.211321 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment__dbt_tmp" rename to "customer_segment"
[0m15:19:33.213315 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'monthly_revenue'
  
[0m15:19:33.216309 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.220298 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.221296 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.223288 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'refunds_discounts'
  
[0m15:19:33.224287 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.228275 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.233265 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m15:19:33.245229 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.247224 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'payments_summary'
  
[0m15:19:33.248222 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m15:19:33.250217 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.251214 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue" rename to "monthly_revenue__dbt_backup"
[0m15:19:33.256202 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.257198 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:19:33.259192 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m15:19:33.261187 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'refunds_discounts'
  
[0m15:19:33.262184 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.274156 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.284126 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.286122 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:19:33.287118 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:19:33.289113 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */
alter table "jaffle_dbt"."main"."payments_summary" rename to "payments_summary__dbt_backup"
[0m15:19:33.290110 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue__dbt_tmp" rename to "monthly_revenue"
[0m15:19:33.300225 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.312191 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m15:19:33.314186 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts" rename to "refunds_discounts__dbt_backup"
[0m15:19:33.316182 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.317181 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:19:33.318176 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

      drop table if exists "jaffle_dbt"."main"."customer_segment__dbt_backup" cascade
    
[0m15:19:33.325157 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m15:19:33.326155 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m15:19:33.337126 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.339121 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.353082 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m15:19:33.352086 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.355079 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */
alter table "jaffle_dbt"."main"."payments_summary__dbt_tmp" rename to "payments_summary"
[0m15:19:33.356075 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m15:19:33.360064 [debug] [Thread-4 (]: On model.jaffle_dbt.customer_segment: Close
[0m15:19:33.362059 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts__dbt_tmp" rename to "refunds_discounts"
[0m15:19:33.365053 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C18CC850>]}
[0m15:19:33.366049 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:19:33.369043 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.371035 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:19:33.375024 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m15:19:33.368042 [info ] [Thread-4 (]: 8 of 12 OK created sql table model main.customer_segment ....................... [[32mOK[0m in 0.51s]
[0m15:19:33.389985 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m15:19:33.391979 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m15:19:33.393974 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.395969 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.customer_segment
[0m15:19:33.396966 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.398960 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

      drop table if exists "jaffle_dbt"."main"."monthly_revenue__dbt_backup" cascade
    
[0m15:19:33.399957 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m15:19:33.401952 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.top_customers
[0m15:19:33.402949 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m15:19:33.409931 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:19:33.413921 [debug] [Thread-2 (]: On model.jaffle_dbt.monthly_revenue: Close
[0m15:19:33.406938 [info ] [Thread-4 (]: 12 of 12 START sql table model main.top_customers .............................. [RUN]
[0m15:19:33.414920 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:19:33.416912 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1D664D0>]}
[0m15:19:33.417911 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:19:33.419905 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_segment, now model.jaffle_dbt.top_customers)
[0m15:19:33.445834 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.top_customers
[0m15:19:33.444837 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m15:19:33.428879 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m15:19:33.457803 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.top_customers"
[0m15:19:33.459797 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

      drop table if exists "jaffle_dbt"."main"."refunds_discounts__dbt_backup" cascade
    
[0m15:19:33.431872 [info ] [Thread-2 (]: 9 of 12 OK created sql table model main.monthly_revenue ........................ [[32mOK[0m in 0.47s]
[0m15:19:33.461793 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

      drop table if exists "jaffle_dbt"."main"."payments_summary__dbt_backup" cascade
    
[0m15:19:33.474757 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m15:19:33.465781 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.top_customers
[0m15:19:33.477749 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.monthly_revenue
[0m15:19:33.482736 [debug] [Thread-1 (]: On model.jaffle_dbt.refunds_discounts: Close
[0m15:19:33.498807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1FE7CD0>]}
[0m15:19:33.496810 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m15:19:33.495813 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.top_customers"
[0m15:19:33.506785 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: Close
[0m15:19:33.508779 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C2001910>]}
[0m15:19:33.501797 [info ] [Thread-1 (]: 11 of 12 OK created sql table model main.refunds_discounts ..................... [[32mOK[0m in 0.48s]
[0m15:19:33.513765 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.517756 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: BEGIN
[0m15:19:33.515760 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.refunds_discounts
[0m15:19:33.518753 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:19:33.524737 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.510773 [info ] [Thread-3 (]: 10 of 12 OK created sql table model main.payments_summary ...................... [[32mOK[0m in 0.54s]
[0m15:19:33.526732 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.528725 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.payments_summary
[0m15:19:33.531239 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."top_customers__dbt_tmp"
  
    as (
      --Top spenders



select
    customer_id,
    sum(amount) as total_spent
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by total_spent desc
limit 10
    );
  
  
[0m15:19:33.539728 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:19:33.566684 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.568679 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'top_customers'
  
[0m15:19:33.574663 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:19:33.580648 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.582642 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'top_customers'
  
[0m15:19:33.585634 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:19:33.600669 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.602663 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers" rename to "top_customers__dbt_backup"
[0m15:19:33.608648 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.620615 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.625602 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers__dbt_tmp" rename to "top_customers"
[0m15:19:33.628595 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:19:33.633612 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m15:19:33.634608 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.636604 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m15:19:33.643585 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.653559 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m15:19:33.656561 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

      drop table if exists "jaffle_dbt"."main"."top_customers__dbt_backup" cascade
    
[0m15:19:33.663575 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:19:33.668550 [debug] [Thread-4 (]: On model.jaffle_dbt.top_customers: Close
[0m15:19:33.671542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7fe60f-86ad-4f55-a1f7-ea593e51078e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200C1E52B10>]}
[0m15:19:33.675553 [info ] [Thread-4 (]: 12 of 12 OK created sql table model main.top_customers ......................... [[32mOK[0m in 0.25s]
[0m15:19:33.679520 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.top_customers
[0m15:19:33.682543 [debug] [MainThread]: Using duckdb connection "master"
[0m15:19:33.684538 [debug] [MainThread]: On master: BEGIN
[0m15:19:33.685535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:33.688527 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:19:33.693555 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.695543 [debug] [MainThread]: Using duckdb connection "master"
[0m15:19:33.696540 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.698534 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:19:33.700529 [debug] [MainThread]: On master: Close
[0m15:19:33.701579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:33.703557 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m15:19:33.706549 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m15:19:33.708545 [debug] [MainThread]: Connection 'model.jaffle_dbt.refunds_discounts' was properly closed.
[0m15:19:33.710922 [debug] [MainThread]: Connection 'model.jaffle_dbt.monthly_revenue' was properly closed.
[0m15:19:33.712432 [debug] [MainThread]: Connection 'model.jaffle_dbt.payments_summary' was properly closed.
[0m15:19:33.713428 [debug] [MainThread]: Connection 'model.jaffle_dbt.top_customers' was properly closed.
[0m15:19:33.715423 [info ] [MainThread]: 
[0m15:19:33.717417 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 3.68 seconds (3.68s).
[0m15:19:33.727621 [debug] [MainThread]: Command end result
[0m15:19:33.852446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m15:19:33.863564 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m15:19:33.894139 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m15:19:33.896273 [info ] [MainThread]: 
[0m15:19:33.898270 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:33.900263 [info ] [MainThread]: 
[0m15:19:33.903256 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m15:19:33.917220 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:33.916224 after 6.33 seconds
[0m15:19:33.919221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B968CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200B9639690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200BFF8B690>]}
[0m15:19:33.921208 [debug] [MainThread]: Flushing usage events
[0m15:19:35.499275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:13:52.172994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D148ECE310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D148EBF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D148EBFED0>]}


============================== 20:13:52.188617 | 9d933679-4969-428b-a91d-8ce5e26fa484 ==============================
[0m20:13:52.188617 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:13:52.188617 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m20:13:53.087347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D148F73D90>]}
[0m20:13:53.217499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14572D410>]}
[0m20:13:53.242432 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:13:53.898648 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:13:56.381475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:56.382471 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:13:56.383471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:56.459896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D148EFBC10>]}
[0m20:13:56.620316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m20:13:56.641986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m20:13:56.732129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A3872D0>]}
[0m20:13:56.733130 [info ] [MainThread]: Found 12 models, 3 seeds, 11 data tests, 472 macros
[0m20:13:56.735124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A09CE50>]}
[0m20:13:56.740112 [info ] [MainThread]: 
[0m20:13:56.743105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:13:56.745168 [info ] [MainThread]: 
[0m20:13:56.747164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:13:56.760253 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m20:14:02.746324 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m20:14:02.751850 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m20:14:02.752867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:02.863997 [debug] [ThreadPool]: SQL status: OK in 0.119 seconds
[0m20:14:02.876691 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m20:14:02.878796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m20:14:02.882797 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m20:14:02.895179 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:02.899156 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m20:14:02.900671 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:02.903621 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:14:02.906610 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:02.907607 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m20:14:02.911595 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:14:02.914587 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:02.916583 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m20:14:02.923276 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:14:02.926266 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m20:14:02.927259 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:02.928254 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m20:14:02.933259 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:14:02.934336 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m20:14:02.934336 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m20:14:02.956933 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m20:14:02.957939 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m20:14:02.957939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:02.959926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:14:02.960923 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m20:14:02.961920 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m20:14:03.072860 [debug] [ThreadPool]: SQL status: OK in 0.094 seconds
[0m20:14:03.084076 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m20:14:03.133101 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m20:14:03.133101 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m20:14:03.142139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D145955750>]}
[0m20:14:03.143169 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:03.144139 [debug] [MainThread]: On master: BEGIN
[0m20:14:03.147720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:03.151443 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m20:14:03.152472 [debug] [MainThread]: On master: COMMIT
[0m20:14:03.153498 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:03.153498 [debug] [MainThread]: On master: COMMIT
[0m20:14:03.153498 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:14:03.153498 [debug] [MainThread]: On master: Close
[0m20:14:03.173887 [debug] [Thread-1 (]: Began running node seed.jaffle_dbt.raw_customers
[0m20:14:03.173887 [debug] [Thread-2 (]: Began running node seed.jaffle_dbt.raw_orders
[0m20:14:03.173887 [debug] [Thread-3 (]: Began running node seed.jaffle_dbt.raw_payments
[0m20:14:03.178879 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m20:14:03.183866 [info ] [Thread-2 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m20:14:03.185860 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_customers'
[0m20:14:03.184864 [info ] [Thread-3 (]: 3 of 3 START seed file main.raw_payments ....................................... [RUN]
[0m20:14:03.185860 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_orders'
[0m20:14:03.185860 [debug] [Thread-1 (]: Began compiling node seed.jaffle_dbt.raw_customers
[0m20:14:03.192898 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.jaffle_dbt.raw_payments'
[0m20:14:03.202497 [debug] [Thread-3 (]: Began compiling node seed.jaffle_dbt.raw_payments
[0m20:14:03.205699 [debug] [Thread-3 (]: Began executing node seed.jaffle_dbt.raw_payments
[0m20:14:03.194887 [debug] [Thread-2 (]: Began compiling node seed.jaffle_dbt.raw_orders
[0m20:14:03.199729 [debug] [Thread-1 (]: Began executing node seed.jaffle_dbt.raw_customers
[0m20:14:03.296893 [debug] [Thread-2 (]: Began executing node seed.jaffle_dbt.raw_orders
[0m20:14:03.424085 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m20:14:03.426080 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: BEGIN
[0m20:14:03.436055 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m20:14:03.441040 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m20:14:03.444031 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:03.451015 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:14:03.455999 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m20:14:03.445030 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: BEGIN
[0m20:14:03.457997 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_payments"} */

    create table "jaffle_dbt"."main"."raw_payments" ("id" integer,"order_id" integer,"payment_method" text,"amount" integer)
  
[0m20:14:03.447026 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: BEGIN
[0m20:14:03.461997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:03.465982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:03.468967 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:14:03.470962 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:14:03.472955 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m20:14:03.474950 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m20:14:03.486919 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_orders"} */

    create table "jaffle_dbt"."main"."raw_orders" ("id" integer,"user_id" integer,"order_date" date,"status" text)
  
[0m20:14:03.476945 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "seed.jaffle_dbt.raw_customers"} */

    create table "jaffle_dbt"."main"."raw_customers" ("id" integer,"first_name" text,"last_name" text)
  
[0m20:14:03.493899 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:03.488911 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:14:03.490909 [debug] [Thread-3 (]: SQL status: OK in 0.027 seconds
[0m20:14:03.726278 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m20:14:03.776145 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: 
          COPY "jaffle_dbt"."main"."raw_customers" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:14:03.761183 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m20:14:03.788112 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: 
          COPY "jaffle_dbt"."main"."raw_orders" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:14:03.770161 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m20:14:03.790107 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: 
          COPY "jaffle_dbt"."main"."raw_payments" FROM 'C:\kev\jaffle_shop\jaffle_dbt\seeds\raw_payments.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:14:03.861914 [debug] [Thread-3 (]: SQL status: OK in 0.071 seconds
[0m20:14:03.863908 [debug] [Thread-1 (]: SQL status: OK in 0.086 seconds
[0m20:14:03.890837 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_customers"
[0m20:14:03.907790 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_payments"
[0m20:14:03.964650 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: COMMIT
[0m20:14:03.970626 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: COMMIT
[0m20:14:03.973619 [debug] [Thread-3 (]: Using duckdb connection "seed.jaffle_dbt.raw_payments"
[0m20:14:03.975610 [debug] [Thread-2 (]: SQL status: OK in 0.186 seconds
[0m20:14:03.983589 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_dbt.raw_orders"
[0m20:14:03.977604 [debug] [Thread-1 (]: Using duckdb connection "seed.jaffle_dbt.raw_customers"
[0m20:14:03.980607 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: COMMIT
[0m20:14:03.991569 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: COMMIT
[0m20:14:03.994559 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: COMMIT
[0m20:14:03.997552 [debug] [Thread-2 (]: Using duckdb connection "seed.jaffle_dbt.raw_orders"
[0m20:14:04.001541 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: COMMIT
[0m20:14:04.013602 [debug] [Thread-3 (]: SQL status: OK in 0.016 seconds
[0m20:14:04.022484 [debug] [Thread-3 (]: On seed.jaffle_dbt.raw_payments: Close
[0m20:14:04.024479 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m20:14:04.031468 [debug] [Thread-2 (]: SQL status: OK in 0.027 seconds
[0m20:14:04.036447 [debug] [Thread-1 (]: On seed.jaffle_dbt.raw_customers: Close
[0m20:14:04.054752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A9F1090>]}
[0m20:14:04.043428 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A9F02D0>]}
[0m20:14:04.045423 [debug] [Thread-2 (]: On seed.jaffle_dbt.raw_orders: Close
[0m20:14:04.059385 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d933679-4969-428b-a91d-8ce5e26fa484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A386810>]}
[0m20:14:04.056395 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 100[0m in 0.87s]
[0m20:14:04.066367 [debug] [Thread-1 (]: Finished running node seed.jaffle_dbt.raw_customers
[0m20:14:04.058388 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file main.raw_payments ................................... [[32mINSERT 113[0m in 0.83s]
[0m20:14:04.071355 [debug] [Thread-3 (]: Finished running node seed.jaffle_dbt.raw_payments
[0m20:14:04.061381 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 99[0m in 0.87s]
[0m20:14:04.078335 [debug] [Thread-2 (]: Finished running node seed.jaffle_dbt.raw_orders
[0m20:14:04.081326 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:04.085316 [debug] [MainThread]: On master: BEGIN
[0m20:14:04.087312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:04.089308 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:14:04.091302 [debug] [MainThread]: On master: COMMIT
[0m20:14:04.094447 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:04.096288 [debug] [MainThread]: On master: COMMIT
[0m20:14:04.098282 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:14:04.099280 [debug] [MainThread]: On master: Close
[0m20:14:04.104265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:04.106280 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m20:14:04.107258 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m20:14:04.108256 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_customers' was properly closed.
[0m20:14:04.109254 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_orders' was properly closed.
[0m20:14:04.111247 [debug] [MainThread]: Connection 'seed.jaffle_dbt.raw_payments' was properly closed.
[0m20:14:04.129200 [info ] [MainThread]: 
[0m20:14:04.146154 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m20:14:04.163109 [debug] [MainThread]: Command end result
[0m20:14:04.421724 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m20:14:04.430700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m20:14:04.457628 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m20:14:04.460633 [info ] [MainThread]: 
[0m20:14:04.462616 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:04.464660 [info ] [MainThread]: 
[0m20:14:04.466669 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:14:04.471596 [debug] [MainThread]: Command `dbt seed` succeeded at 20:14:04.470594 after 12.48 seconds
[0m20:14:04.472590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1422BAED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1422BA210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14A0F2390>]}
[0m20:14:04.474583 [debug] [MainThread]: Flushing usage events
[0m20:14:07.088388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:14:54.066851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E9FED3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E9FDFE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E9FDE990>]}


============================== 20:14:54.073628 | 52b982e6-d95a-4478-833c-6201b30ace96 ==============================
[0m20:14:54.073628 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:14:54.075617 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Evans Moseti\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\kev\\jaffle_shop\\jaffle_dbt\\logs'}
[0m20:14:54.513670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E975AF10>]}
[0m20:14:54.644887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E683D8D0>]}
[0m20:14:54.653365 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:14:55.266382 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:14:55.557952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:14:55.558953 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:14:55.558953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:14:55.673945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EB4B4710>]}
[0m20:14:55.860560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m20:14:55.865559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m20:14:55.924318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EB724210>]}
[0m20:14:55.927058 [info ] [MainThread]: Found 12 models, 3 seeds, 11 data tests, 472 macros
[0m20:14:55.929055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EB5C7510>]}
[0m20:14:55.935299 [info ] [MainThread]: 
[0m20:14:55.940249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:14:55.942245 [info ] [MainThread]: 
[0m20:14:55.944240 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:14:55.957203 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt'
[0m20:14:56.171515 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt"
[0m20:14:56.172512 [debug] [ThreadPool]: On list_jaffle_dbt: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"jaffle_dbt"'
    
  
  
[0m20:14:56.173511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:56.223518 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m20:14:56.225509 [debug] [ThreadPool]: On list_jaffle_dbt: Close
[0m20:14:56.227509 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_jaffle_dbt, now create_jaffle_dbt_main)
[0m20:14:56.228611 [debug] [ThreadPool]: Creating schema "database: "jaffle_dbt"
schema: "main"
"
[0m20:14:56.244513 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:56.245508 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='jaffle_dbt'
        and type='sqlite'
    
  
[0m20:14:56.246510 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:14:56.250490 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:14:56.253362 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:56.254348 [debug] [ThreadPool]: On create_jaffle_dbt_main: BEGIN
[0m20:14:56.255346 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:56.256343 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:56.257340 [debug] [ThreadPool]: On create_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "create_jaffle_dbt_main"} */

    
    
        create schema if not exists "jaffle_dbt"."main"
    
[0m20:14:56.258338 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:14:56.260332 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m20:14:56.261330 [debug] [ThreadPool]: Using duckdb connection "create_jaffle_dbt_main"
[0m20:14:56.262327 [debug] [ThreadPool]: On create_jaffle_dbt_main: COMMIT
[0m20:14:56.263710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:14:56.264703 [debug] [ThreadPool]: On create_jaffle_dbt_main: Close
[0m20:14:56.268842 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_jaffle_dbt_main'
[0m20:14:56.280924 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m20:14:56.280924 [debug] [ThreadPool]: On list_jaffle_dbt_main: BEGIN
[0m20:14:56.282574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:14:56.285557 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:14:56.286555 [debug] [ThreadPool]: Using duckdb connection "list_jaffle_dbt_main"
[0m20:14:56.287552 [debug] [ThreadPool]: On list_jaffle_dbt_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "connection_name": "list_jaffle_dbt_main"} */
select
      'jaffle_dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'jaffle_dbt'
  
[0m20:14:56.324738 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m20:14:56.327644 [debug] [ThreadPool]: On list_jaffle_dbt_main: ROLLBACK
[0m20:14:56.329146 [debug] [ThreadPool]: Failed to rollback 'list_jaffle_dbt_main'
[0m20:14:56.330143 [debug] [ThreadPool]: On list_jaffle_dbt_main: Close
[0m20:14:56.332137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBAA0C90>]}
[0m20:14:56.335096 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:56.336093 [debug] [MainThread]: On master: BEGIN
[0m20:14:56.336093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:14:56.338086 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:14:56.339087 [debug] [MainThread]: On master: COMMIT
[0m20:14:56.339087 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:56.340083 [debug] [MainThread]: On master: COMMIT
[0m20:14:56.341079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:56.342759 [debug] [MainThread]: On master: Close
[0m20:14:56.348764 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.stg_customers
[0m20:14:56.349764 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.stg_orders
[0m20:14:56.351769 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.stg_payments
[0m20:14:56.352764 [info ] [Thread-1 (]: 1 of 12 START sql view model main.stg_customers ................................ [RUN]
[0m20:14:56.353752 [info ] [Thread-2 (]: 2 of 12 START sql view model main.stg_orders ................................... [RUN]
[0m20:14:56.355747 [info ] [Thread-3 (]: 3 of 12 START sql view model main.stg_payments ................................. [RUN]
[0m20:14:56.356754 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_customers'
[0m20:14:56.358740 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_orders'
[0m20:14:56.362730 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.stg_orders
[0m20:14:56.360733 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.stg_customers
[0m20:14:56.359735 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.jaffle_dbt.stg_payments'
[0m20:14:56.386665 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.stg_orders"
[0m20:14:56.392650 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.stg_customers"
[0m20:14:56.394644 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.stg_payments
[0m20:14:56.403618 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.stg_payments"
[0m20:14:56.404616 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.stg_orders
[0m20:14:56.406613 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.stg_customers
[0m20:14:56.465744 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.stg_orders"
[0m20:14:56.474719 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.stg_customers"
[0m20:14:56.475717 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.stg_payments
[0m20:14:56.485874 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m20:14:56.486871 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.stg_payments"
[0m20:14:56.487868 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: BEGIN
[0m20:14:56.488866 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m20:14:56.489863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:14:56.491859 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: BEGIN
[0m20:14:56.492656 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m20:14:56.494874 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:14:56.495873 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m20:14:56.495873 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: BEGIN
[0m20:14:56.497867 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m20:14:56.498863 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:14:56.499863 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:14:56.501856 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

  
  create view "jaffle_dbt"."main"."stg_orders__dbt_tmp" as (
    with source as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status
    from "jaffle_dbt"."main"."raw_orders"

)

select * from source
  );

[0m20:14:56.503005 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m20:14:56.512799 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m20:14:56.513795 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

  
  create view "jaffle_dbt"."main"."stg_customers__dbt_tmp" as (
    with source as (

    select
        id as customer_id,
        first_name,
        last_name
    from "jaffle_dbt"."main"."raw_customers"

)

select * from source
  );

[0m20:14:56.514829 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:14:56.515825 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m20:14:56.528366 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m20:14:56.528366 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m20:14:56.530363 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

  
  create view "jaffle_dbt"."main"."stg_payments__dbt_tmp" as (
    with source as (

    select
        id as payment_id,
        order_id,
        payment_method,
        amount
    from "jaffle_dbt"."main"."raw_payments"

)

select * from source
  );

[0m20:14:56.531367 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */
alter view "jaffle_dbt"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:14:56.537383 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m20:14:56.540336 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:14:56.541333 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */
alter view "jaffle_dbt"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m20:14:56.542331 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:14:56.548884 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m20:14:56.573931 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m20:14:56.574933 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m20:14:56.575929 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */
alter view "jaffle_dbt"."main"."stg_payments__dbt_tmp" rename to "stg_payments"
[0m20:14:56.577922 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m20:14:56.581914 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m20:14:56.584572 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: COMMIT
[0m20:14:56.586565 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:14:56.588560 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m20:14:56.593546 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m20:14:56.594894 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:14:56.596216 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: COMMIT
[0m20:14:56.597215 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m20:14:56.609238 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.stg_orders"
[0m20:14:56.611235 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: COMMIT
[0m20:14:56.613228 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:14:56.614226 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_orders"} */

      drop view if exists "jaffle_dbt"."main"."stg_orders__dbt_backup" cascade
    
[0m20:14:56.627191 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.stg_customers"
[0m20:14:56.637074 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_customers"} */

      drop view if exists "jaffle_dbt"."main"."stg_customers__dbt_backup" cascade
    
[0m20:14:56.639069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:56.645053 [debug] [Thread-1 (]: On model.jaffle_dbt.stg_customers: Close
[0m20:14:56.630184 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m20:14:56.647271 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m20:14:56.659286 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.stg_payments"
[0m20:14:56.660285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB5B6D0>]}
[0m20:14:56.663277 [debug] [Thread-2 (]: On model.jaffle_dbt.stg_orders: Close
[0m20:14:56.665272 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.stg_payments"} */

      drop view if exists "jaffle_dbt"."main"."stg_payments__dbt_backup" cascade
    
[0m20:14:56.670258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB79C50>]}
[0m20:14:56.672252 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:14:56.678237 [debug] [Thread-3 (]: On model.jaffle_dbt.stg_payments: Close
[0m20:14:56.679235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB574D0>]}
[0m20:14:56.667266 [info ] [Thread-1 (]: 1 of 12 OK created sql view model main.stg_customers ........................... [[32mOK[0m in 0.29s]
[0m20:14:56.684221 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.stg_customers
[0m20:14:56.674247 [info ] [Thread-2 (]: 2 of 12 OK created sql view model main.stg_orders .............................. [[32mOK[0m in 0.31s]
[0m20:14:56.688210 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.stg_orders
[0m20:14:56.689207 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.monthly_order_growth
[0m20:14:56.681229 [info ] [Thread-3 (]: 3 of 12 OK created sql view model main.stg_payments ............................ [[32mOK[0m in 0.32s]
[0m20:14:56.697298 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.stg_payments
[0m20:14:56.698297 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.new_customers
[0m20:14:56.691204 [info ] [Thread-4 (]: 4 of 12 START sql table model main.monthly_order_growth ........................ [RUN]
[0m20:14:56.708281 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.jaffle_dbt.monthly_order_growth'
[0m20:14:56.709267 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.monthly_order_growth
[0m20:14:56.720244 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_order_growth"
[0m20:14:56.722231 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.monthly_order_growth
[0m20:14:56.700289 [info ] [Thread-3 (]: 5 of 12 START sql table model main.new_customers ............................... [RUN]
[0m20:14:56.779901 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_payments, now model.jaffle_dbt.new_customers)
[0m20:14:56.780897 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.new_customers
[0m20:14:56.796263 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.new_customers"
[0m20:14:56.816849 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.repeat_purchase_rate
[0m20:14:56.819841 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.customer_ltv
[0m20:14:56.820840 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.new_customers
[0m20:14:56.822834 [info ] [Thread-1 (]: 6 of 12 START sql table model main.repeat_purchase_rate ........................ [RUN]
[0m20:14:56.848764 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_order_growth"
[0m20:14:56.851755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_customers, now model.jaffle_dbt.repeat_purchase_rate)
[0m20:14:56.858738 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.new_customers"
[0m20:14:56.860732 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.repeat_purchase_rate
[0m20:14:56.870711 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:56.873893 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.repeat_purchase_rate
[0m20:14:56.883635 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m20:14:56.888592 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: BEGIN
[0m20:14:56.894568 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:56.898559 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:56.895566 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:14:56.887601 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m20:14:56.824828 [info ] [Thread-2 (]: 7 of 12 START sql table model main.customer_ltv ................................ [RUN]
[0m20:14:56.920132 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: BEGIN
[0m20:14:56.922127 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: BEGIN
[0m20:14:56.923123 [debug] [Thread-4 (]: SQL status: OK in 0.027 seconds
[0m20:14:56.925118 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.stg_orders, now model.jaffle_dbt.customer_ltv)
[0m20:14:56.927114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:56.929109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:56.930106 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m20:14:56.932100 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.customer_ltv
[0m20:14:56.935093 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m20:14:56.936089 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:14:56.938085 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp"
  
    as (
      --Orders per month



select
    date_trunc('month', order_date) as month,
    count(*) as total_orders
from "jaffle_dbt"."main"."stg_orders"
group by 1
order by 1
    );
  
  
[0m20:14:56.947059 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.customer_ltv"
[0m20:14:56.948057 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:56.949055 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m20:14:56.958030 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp"
  
    as (
      --% of returning customers



with customer_orders as (
    select
        customer_id,
        count(*) as order_count
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    count(case when order_count > 1 then 1 end) * 1.0
        / count(*) as repeat_purchase_rate
from customer_orders
    );
  
  
[0m20:14:56.960025 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.customer_ltv
[0m20:14:56.961022 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."new_customers__dbt_tmp"
  
    as (
      --New customer acquisition



with first_orders as (
    select
        customer_id,
        min(order_date) as first_order_date
    from "jaffle_dbt"."main"."stg_orders"
    group by 1
)

select
    date_trunc('month', first_order_date) as month,
    count(customer_id) as new_customers
from first_orders
group by 1
order by 1
    );
  
  
[0m20:14:56.976979 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.customer_ltv"
[0m20:14:56.980972 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m20:14:56.982963 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: BEGIN
[0m20:14:56.998920 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m20:14:57.000915 [debug] [Thread-4 (]: SQL status: OK in 0.050 seconds
[0m20:14:57.002552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:57.003544 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m20:14:57.009527 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:57.017504 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m20:14:57.026481 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m20:14:57.027479 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m20:14:57.028475 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */
alter table "jaffle_dbt"."main"."repeat_purchase_rate__dbt_tmp" rename to "repeat_purchase_rate"
[0m20:14:57.029473 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */
alter table "jaffle_dbt"."main"."monthly_order_growth__dbt_tmp" rename to "monthly_order_growth"
[0m20:14:57.031467 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */
alter table "jaffle_dbt"."main"."new_customers__dbt_tmp" rename to "new_customers"
[0m20:14:57.032464 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m20:14:57.034460 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.036456 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.038449 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.039446 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_ltv__dbt_tmp"
  
    as (
      --Lifetime value per customer



select
    o.customer_id,
    sum(p.amount) as lifetime_value
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by lifetime_value desc
    );
  
  
[0m20:14:57.049421 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m20:14:57.051414 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m20:14:57.056402 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m20:14:57.058397 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:57.059393 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m20:14:57.060390 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m20:14:57.062386 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: COMMIT
[0m20:14:57.064003 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: COMMIT
[0m20:14:57.064994 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: COMMIT
[0m20:14:57.070966 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:14:57.079301 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.repeat_purchase_rate"
[0m20:14:57.081296 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.repeat_purchase_rate"} */

      drop table if exists "jaffle_dbt"."main"."repeat_purchase_rate__dbt_backup" cascade
    
[0m20:14:57.083289 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m20:14:57.085283 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m20:14:57.086280 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.092263 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_order_growth"
[0m20:14:57.093460 [debug] [Thread-2 (]: SQL status: OK in 0.036 seconds
[0m20:14:57.097444 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.new_customers"
[0m20:14:57.100438 [debug] [Thread-1 (]: On model.jaffle_dbt.repeat_purchase_rate: Close
[0m20:14:57.102433 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_order_growth"} */

      drop table if exists "jaffle_dbt"."main"."monthly_order_growth__dbt_backup" cascade
    
[0m20:14:57.108416 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m20:14:57.109413 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.new_customers"} */

      drop table if exists "jaffle_dbt"."main"."new_customers__dbt_backup" cascade
    
[0m20:14:57.110411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB45810>]}
[0m20:14:57.111409 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */
alter table "jaffle_dbt"."main"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m20:14:57.113092 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.116078 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.119072 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.115080 [info ] [Thread-1 (]: 6 of 12 OK created sql table model main.repeat_purchase_rate ................... [[32mOK[0m in 0.26s]
[0m20:14:57.123068 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_order_growth: Close
[0m20:14:57.126057 [debug] [Thread-3 (]: On model.jaffle_dbt.new_customers: Close
[0m20:14:57.131971 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m20:14:57.132980 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.repeat_purchase_rate
[0m20:14:57.134969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB62E10>]}
[0m20:14:57.135968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB7DF10>]}
[0m20:14:57.137961 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m20:14:57.139956 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.customer_segment
[0m20:14:57.141952 [info ] [Thread-4 (]: 4 of 12 OK created sql table model main.monthly_order_growth ................... [[32mOK[0m in 0.43s]
[0m20:14:57.146078 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: COMMIT
[0m20:14:57.143944 [info ] [Thread-3 (]: 5 of 12 OK created sql table model main.new_customers .......................... [[32mOK[0m in 0.36s]
[0m20:14:57.147075 [info ] [Thread-1 (]: 8 of 12 START sql table model main.customer_segment ............................ [RUN]
[0m20:14:57.149070 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.monthly_order_growth
[0m20:14:57.151064 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.new_customers
[0m20:14:57.152061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.repeat_purchase_rate, now model.jaffle_dbt.customer_segment)
[0m20:14:57.154353 [debug] [Thread-4 (]: Began running node model.jaffle_dbt.monthly_revenue
[0m20:14:57.156342 [debug] [Thread-3 (]: Began running node model.jaffle_dbt.payments_summary
[0m20:14:57.158334 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.customer_segment
[0m20:14:57.160329 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m20:14:57.159332 [info ] [Thread-4 (]: 9 of 12 START sql table model main.monthly_revenue ............................. [RUN]
[0m20:14:57.162903 [info ] [Thread-3 (]: 10 of 12 START sql table model main.payments_summary ........................... [RUN]
[0m20:14:57.170970 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.customer_segment"
[0m20:14:57.175958 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.customer_ltv"
[0m20:14:57.176956 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.monthly_order_growth, now model.jaffle_dbt.monthly_revenue)
[0m20:14:57.178949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.new_customers, now model.jaffle_dbt.payments_summary)
[0m20:14:57.180946 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_ltv"} */

      drop table if exists "jaffle_dbt"."main"."customer_ltv__dbt_backup" cascade
    
[0m20:14:57.183974 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.customer_segment
[0m20:14:57.184951 [debug] [Thread-4 (]: Began compiling node model.jaffle_dbt.monthly_revenue
[0m20:14:57.185930 [debug] [Thread-3 (]: Began compiling node model.jaffle_dbt.payments_summary
[0m20:14:57.198902 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.customer_segment"
[0m20:14:57.200009 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m20:14:57.212268 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.221618 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_dbt.payments_summary"
[0m20:14:57.224603 [debug] [Thread-2 (]: On model.jaffle_dbt.customer_ltv: Close
[0m20:14:57.226598 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m20:14:57.228593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBC94BD0>]}
[0m20:14:57.230588 [debug] [Thread-4 (]: Began executing node model.jaffle_dbt.monthly_revenue
[0m20:14:57.231586 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: BEGIN
[0m20:14:57.234575 [debug] [Thread-3 (]: Began executing node model.jaffle_dbt.payments_summary
[0m20:14:57.233583 [info ] [Thread-2 (]: 7 of 12 OK created sql table model main.customer_ltv ........................... [[32mOK[0m in 0.30s]
[0m20:14:57.241557 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.243506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:57.250456 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_dbt.payments_summary"
[0m20:14:57.251458 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.customer_ltv
[0m20:14:57.254447 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.257441 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:14:57.259434 [debug] [Thread-2 (]: Began running node model.jaffle_dbt.refunds_discounts
[0m20:14:57.260433 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: BEGIN
[0m20:14:57.263422 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m20:14:57.264418 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m20:14:57.267420 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:14:57.266414 [info ] [Thread-2 (]: 11 of 12 START sql table model main.refunds_discounts .......................... [RUN]
[0m20:14:57.268409 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: BEGIN
[0m20:14:57.269407 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."customer_segment__dbt_tmp"
  
    as (
      --Segmentation (e.g., high/medium/low)



with customer_spend as (
    select
        o.customer_id,
        sum(p.amount) as total_spent
    from "jaffle_dbt"."main"."stg_orders" o
    join "jaffle_dbt"."main"."stg_payments" p
        on o.order_id = p.order_id
    group by 1
)

select
    customer_id,
    total_spent,
    case
        when total_spent >= 5000 then 'high_value'
        when total_spent >= 2000 then 'medium_value'
        else 'low_value'
    end as customer_segment
from customer_spend
    );
  
  
[0m20:14:57.272399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_ltv, now model.jaffle_dbt.refunds_discounts)
[0m20:14:57.273396 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m20:14:57.275391 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:14:57.277386 [debug] [Thread-2 (]: Began compiling node model.jaffle_dbt.refunds_discounts
[0m20:14:57.278535 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.280531 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m20:14:57.288509 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.290508 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m20:14:57.291501 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."monthly_revenue__dbt_tmp"
  
    as (
      --Total revenue per month



select
    date_trunc('month', o.order_date) as month,
    sum(p.amount) as revenue
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by 1
    );
  
  
[0m20:14:57.291501 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m20:14:57.298612 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m20:14:57.300608 [debug] [Thread-2 (]: Began executing node model.jaffle_dbt.refunds_discounts
[0m20:14:57.301606 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."payments_summary__dbt_tmp"
  
    as (
      

select
    payment_method,
    count(*) as payment_count,
    sum(amount) as total_amount
from "jaffle_dbt"."main"."stg_payments"
group by payment_method
order by total_amount desc
    );
  
  
[0m20:14:57.303602 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */
alter table "jaffle_dbt"."main"."customer_segment__dbt_tmp" rename to "customer_segment"
[0m20:14:57.312355 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.313800 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m20:14:57.315790 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.324094 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.326090 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m20:14:57.326090 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.328718 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m20:14:57.329683 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */
alter table "jaffle_dbt"."main"."monthly_revenue__dbt_tmp" rename to "monthly_revenue"
[0m20:14:57.334669 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m20:14:57.335667 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: BEGIN
[0m20:14:57.337728 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m20:14:57.339658 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */
alter table "jaffle_dbt"."main"."payments_summary__dbt_tmp" rename to "payments_summary"
[0m20:14:57.340661 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.340661 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:14:57.341652 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: COMMIT
[0m20:14:57.345560 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m20:14:57.346557 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:14:57.347555 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m20:14:57.349549 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.352540 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m20:14:57.353538 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m20:14:57.354536 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.355533 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: COMMIT
[0m20:14:57.356531 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m20:14:57.363512 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.customer_segment"
[0m20:14:57.364508 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."refunds_discounts__dbt_tmp"
  
    as (
      --Refunds, discounts per month


select
    payment_method,
    sum(case when amount = 0 then 1 else 0 end) as zero_amount_payments
from "jaffle_dbt"."main"."stg_payments"
group by 1
    );
  
  
[0m20:14:57.366504 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: COMMIT
[0m20:14:57.367503 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.customer_segment"} */

      drop table if exists "jaffle_dbt"."main"."customer_segment__dbt_backup" cascade
    
[0m20:14:57.370493 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m20:14:57.376893 [debug] [Thread-4 (]: Using duckdb connection "model.jaffle_dbt.monthly_revenue"
[0m20:14:57.376893 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m20:14:57.377891 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:14:57.378889 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m20:14:57.379885 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.monthly_revenue"} */

      drop table if exists "jaffle_dbt"."main"."monthly_revenue__dbt_backup" cascade
    
[0m20:14:57.385875 [debug] [Thread-3 (]: Using duckdb connection "model.jaffle_dbt.payments_summary"
[0m20:14:57.394848 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.398835 [debug] [Thread-1 (]: On model.jaffle_dbt.customer_segment: Close
[0m20:14:57.400830 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.payments_summary"} */

      drop table if exists "jaffle_dbt"."main"."payments_summary__dbt_backup" cascade
    
[0m20:14:57.401829 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.403821 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */
alter table "jaffle_dbt"."main"."refunds_discounts__dbt_tmp" rename to "refunds_discounts"
[0m20:14:57.405820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBC47AD0>]}
[0m20:14:57.408810 [debug] [Thread-4 (]: On model.jaffle_dbt.monthly_revenue: Close
[0m20:14:57.408810 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:14:57.411800 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:14:57.410804 [info ] [Thread-1 (]: 8 of 12 OK created sql table model main.customer_segment ....................... [[32mOK[0m in 0.25s]
[0m20:14:57.413795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBA70450>]}
[0m20:14:57.415789 [debug] [Thread-3 (]: On model.jaffle_dbt.payments_summary: Close
[0m20:14:57.418781 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m20:14:57.419778 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.customer_segment
[0m20:14:57.421775 [info ] [Thread-4 (]: 9 of 12 OK created sql table model main.monthly_revenue ........................ [[32mOK[0m in 0.24s]
[0m20:14:57.423770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB614D0>]}
[0m20:14:57.424768 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.425766 [debug] [Thread-1 (]: Began running node model.jaffle_dbt.top_customers
[0m20:14:57.426759 [debug] [Thread-4 (]: Finished running node model.jaffle_dbt.monthly_revenue
[0m20:14:57.428755 [info ] [Thread-3 (]: 10 of 12 OK created sql table model main.payments_summary ...................... [[32mOK[0m in 0.24s]
[0m20:14:57.429755 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: COMMIT
[0m20:14:57.431748 [info ] [Thread-1 (]: 12 of 12 START sql table model main.top_customers .............................. [RUN]
[0m20:14:57.434740 [debug] [Thread-3 (]: Finished running node model.jaffle_dbt.payments_summary
[0m20:14:57.435739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_dbt.customer_segment, now model.jaffle_dbt.top_customers)
[0m20:14:57.437734 [debug] [Thread-1 (]: Began compiling node model.jaffle_dbt.top_customers
[0m20:14:57.447705 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_dbt.top_customers"
[0m20:14:57.449700 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m20:14:57.462664 [debug] [Thread-2 (]: Using duckdb connection "model.jaffle_dbt.refunds_discounts"
[0m20:14:57.463662 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.refunds_discounts"} */

      drop table if exists "jaffle_dbt"."main"."refunds_discounts__dbt_backup" cascade
    
[0m20:14:57.465659 [debug] [Thread-1 (]: Began executing node model.jaffle_dbt.top_customers
[0m20:14:57.468650 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.477625 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_dbt.top_customers"
[0m20:14:57.481614 [debug] [Thread-2 (]: On model.jaffle_dbt.refunds_discounts: Close
[0m20:14:57.485612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EB705E50>]}
[0m20:14:57.487597 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m20:14:57.491587 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: BEGIN
[0m20:14:57.489607 [info ] [Thread-2 (]: 11 of 12 OK created sql table model main.refunds_discounts ..................... [[32mOK[0m in 0.21s]
[0m20:14:57.492585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:14:57.494582 [debug] [Thread-2 (]: Finished running node model.jaffle_dbt.refunds_discounts
[0m20:14:57.496574 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:14:57.497570 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m20:14:57.498567 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

  
    
    

    create  table
      "jaffle_dbt"."main"."top_customers__dbt_tmp"
  
    as (
      --Top spenders



select
    customer_id,
    sum(amount) as total_spent
from "jaffle_dbt"."main"."stg_orders" o
join "jaffle_dbt"."main"."stg_payments" p
    on o.order_id = p.order_id
group by 1
order by total_spent desc
limit 10
    );
  
  
[0m20:14:57.505030 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:14:57.514365 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m20:14:57.516353 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */
alter table "jaffle_dbt"."main"."top_customers__dbt_tmp" rename to "top_customers"
[0m20:14:57.518348 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.523335 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m20:14:57.525331 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m20:14:57.526327 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: COMMIT
[0m20:14:57.532312 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:14:57.539304 [debug] [Thread-1 (]: Using duckdb connection "model.jaffle_dbt.top_customers"
[0m20:14:57.540300 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "jaffle_dbt", "target_name": "dev", "node_id": "model.jaffle_dbt.top_customers"} */

      drop table if exists "jaffle_dbt"."main"."top_customers__dbt_backup" cascade
    
[0m20:14:57.543069 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:14:57.546057 [debug] [Thread-1 (]: On model.jaffle_dbt.top_customers: Close
[0m20:14:57.547056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52b982e6-d95a-4478-833c-6201b30ace96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBB94710>]}
[0m20:14:57.549050 [info ] [Thread-1 (]: 12 of 12 OK created sql table model main.top_customers ......................... [[32mOK[0m in 0.11s]
[0m20:14:57.551043 [debug] [Thread-1 (]: Finished running node model.jaffle_dbt.top_customers
[0m20:14:57.553357 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:57.554354 [debug] [MainThread]: On master: BEGIN
[0m20:14:57.555354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:14:57.557347 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m20:14:57.558344 [debug] [MainThread]: On master: COMMIT
[0m20:14:57.558344 [debug] [MainThread]: Using duckdb connection "master"
[0m20:14:57.559343 [debug] [MainThread]: On master: COMMIT
[0m20:14:57.560339 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:14:57.561337 [debug] [MainThread]: On master: Close
[0m20:14:57.562934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:14:57.563925 [debug] [MainThread]: Connection 'create_jaffle_dbt_main' was properly closed.
[0m20:14:57.563925 [debug] [MainThread]: Connection 'list_jaffle_dbt_main' was properly closed.
[0m20:14:57.564923 [debug] [MainThread]: Connection 'model.jaffle_dbt.top_customers' was properly closed.
[0m20:14:57.566919 [debug] [MainThread]: Connection 'model.jaffle_dbt.refunds_discounts' was properly closed.
[0m20:14:57.567917 [debug] [MainThread]: Connection 'model.jaffle_dbt.payments_summary' was properly closed.
[0m20:14:57.568915 [debug] [MainThread]: Connection 'model.jaffle_dbt.monthly_revenue' was properly closed.
[0m20:14:57.569911 [info ] [MainThread]: 
[0m20:14:57.571906 [info ] [MainThread]: Finished running 9 table models, 3 view models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m20:14:57.578804 [debug] [MainThread]: Command end result
[0m20:14:57.662111 [debug] [MainThread]: Wrote artifact WritableManifest to C:\kev\jaffle_shop\jaffle_dbt\target\manifest.json
[0m20:14:57.668142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\kev\jaffle_shop\jaffle_dbt\target\semantic_manifest.json
[0m20:14:57.685137 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\kev\jaffle_shop\jaffle_dbt\target\run_results.json
[0m20:14:57.686136 [info ] [MainThread]: 
[0m20:14:57.688129 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:14:57.690123 [info ] [MainThread]: 
[0m20:14:57.691121 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m20:14:57.695132 [debug] [MainThread]: Command `dbt run` succeeded at 20:14:57.695132 after 3.79 seconds
[0m20:14:57.696129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E345AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E345A210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E345A350>]}
[0m20:14:57.697127 [debug] [MainThread]: Flushing usage events
[0m20:14:58.813824 [debug] [MainThread]: An error was encountered while trying to flush usage events
